<!DOCTYPE html>
<html lang="ja">
<head>
<!-- Matomo -->
<script>
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//hankache.com/matomo/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '2']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->

<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<meta name="description" content="Raku 入門">
<meta name="keywords" content="perl6, perl 6, introduction, イントロダクション, perl6intro, perl 6 introduction, perl 6 tutorial, perl 6 intro, perl 6 入門, perl 6 イントロダクション, perl 6 イントロ, raku イントロダクション, raku ガイド, raku チュートリアル, raku 入門">
<meta name="author" content="Naoum Hankache, Itsuki Toyota">
<title>Raku 入門</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre.pygments .hll { background-color: #ffffcc }
pre.pygments { background: #f8f8f8; }
pre.pygments .tok-c { color: #3D7B7B; font-style: italic } /* Comment */
pre.pygments .tok-err { border: 1px solid #FF0000 } /* Error */
pre.pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
pre.pygments .tok-o { color: #666666 } /* Operator */
pre.pygments .tok-ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
pre.pygments .tok-cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
pre.pygments .tok-cp { color: #9C6500 } /* Comment.Preproc */
pre.pygments .tok-cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
pre.pygments .tok-c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
pre.pygments .tok-cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
pre.pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
pre.pygments .tok-ge { font-style: italic } /* Generic.Emph */
pre.pygments .tok-gr { color: #E40000 } /* Generic.Error */
pre.pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
pre.pygments .tok-gi { color: #008400 } /* Generic.Inserted */
pre.pygments .tok-go { color: #717171 } /* Generic.Output */
pre.pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
pre.pygments .tok-gs { font-weight: bold } /* Generic.Strong */
pre.pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
pre.pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
pre.pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
pre.pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
pre.pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
pre.pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
pre.pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
pre.pygments .tok-kt { color: #B00040 } /* Keyword.Type */
pre.pygments .tok-m { color: #666666 } /* Literal.Number */
pre.pygments .tok-s { color: #BA2121 } /* Literal.String */
pre.pygments .tok-na { color: #687822 } /* Name.Attribute */
pre.pygments .tok-nb { color: #008000 } /* Name.Builtin */
pre.pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
pre.pygments .tok-no { color: #880000 } /* Name.Constant */
pre.pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
pre.pygments .tok-ni { color: #717171; font-weight: bold } /* Name.Entity */
pre.pygments .tok-ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
pre.pygments .tok-nf { color: #0000FF } /* Name.Function */
pre.pygments .tok-nl { color: #767600 } /* Name.Label */
pre.pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
pre.pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
pre.pygments .tok-nv { color: #19177C } /* Name.Variable */
pre.pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
pre.pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
pre.pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
pre.pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
pre.pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
pre.pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
pre.pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
pre.pygments .tok-sa { color: #BA2121 } /* Literal.String.Affix */
pre.pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
pre.pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
pre.pygments .tok-dl { color: #BA2121 } /* Literal.String.Delimiter */
pre.pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
pre.pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
pre.pygments .tok-se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
pre.pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
pre.pygments .tok-si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
pre.pygments .tok-sx { color: #008000 } /* Literal.String.Other */
pre.pygments .tok-sr { color: #A45A77 } /* Literal.String.Regex */
pre.pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
pre.pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
pre.pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
pre.pygments .tok-fm { color: #0000FF } /* Name.Function.Magic */
pre.pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
pre.pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
pre.pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
pre.pygments .tok-vm { color: #19177C } /* Name.Variable.Magic */
pre.pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Raku 入門</h1>
<div class="details">
<span id="author" class="author">Naoum Hankache</span><br>
<span id="email" class="email"><a href="mailto:naoum@hankache.com">naoum@hankache.com</a></span><br>
<span id="author2" class="author">Itsuki Toyota</span><br>
<span id="email2" class="email"><a href="mailto:titsuki@cpan.org">titsuki@cpan.org</a></span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">目次</div>
<ul class="sectlevel1">
<li><a href="#_イントロダクション">1. イントロダクション</a>
<ul class="sectlevel2">
<li><a href="#_raku_とは">1.1. Raku とは</a></li>
<li><a href="#_専門用語">1.2. 専門用語</a></li>
<li><a href="#_rakuのインストール">1.3. Rakuのインストール</a></li>
<li><a href="#_rakuのコードを実行する">1.4. Rakuのコードを実行する</a></li>
<li><a href="#_エディタ">1.5. エディタ</a></li>
<li><a href="#_こんにちは世界">1.6. こんにちは世界!</a></li>
<li><a href="#_文法の概要">1.7. 文法の概要</a></li>
</ul>
</li>
<li><a href="#_演算子">2. 演算子</a>
<ul class="sectlevel2">
<li><a href="#_一般的な演算子">2.1. 一般的な演算子</a></li>
<li><a href="#_逆転演算子">2.2. 逆転演算子</a></li>
<li><a href="#_簡約演算子">2.3. 簡約演算子</a></li>
</ul>
</li>
<li><a href="#_変数">3. 変数</a>
<ul class="sectlevel2">
<li><a href="#_スカラ">3.1. スカラ</a></li>
<li><a href="#_配列">3.2. 配列</a></li>
<li><a href="#_ハッシュ">3.3. ハッシュ</a></li>
<li><a href="#_型">3.4. 型</a></li>
<li><a href="#_イントロスペクション">3.5. イントロスペクション</a></li>
<li><a href="#_スコーピング">3.6. スコーピング</a></li>
<li><a href="#_代入と束縛">3.7. 代入と束縛</a></li>
</ul>
</li>
<li><a href="#_関数とミューテータ">4. 関数とミューテータ</a></li>
<li><a href="#_ループと条件文">5. ループと条件文</a>
<ul class="sectlevel2">
<li><a href="#_if">5.1. if</a></li>
<li><a href="#_unless">5.2. unless</a></li>
<li><a href="#_with">5.3. with</a></li>
<li><a href="#_for">5.4. for</a></li>
<li><a href="#_given">5.5. given</a></li>
<li><a href="#_loop">5.6. loop</a></li>
</ul>
</li>
<li><a href="#_io">6. I/O</a>
<ul class="sectlevel2">
<li><a href="#_ターミナルを用いた基本的なio">6.1. ターミナルを用いた基本的なI/O</a></li>
<li><a href="#_シェルコマンドの実行">6.2. シェルコマンドの実行</a></li>
<li><a href="#_ファイル_io">6.3. ファイル I/O</a></li>
<li><a href="#_ファイルとディレクトリの操作">6.4. ファイルとディレクトリの操作</a></li>
</ul>
</li>
<li><a href="#_サブルーチン">7. サブルーチン</a>
<ul class="sectlevel2">
<li><a href="#_定義">7.1. 定義</a></li>
<li><a href="#_シグネチャ">7.2. シグネチャ</a></li>
<li><a href="#_多重ディスパッチ">7.3. 多重ディスパッチ</a></li>
<li><a href="#_デフォルトパラメータとオプションパラメータ">7.4. デフォルトパラメータとオプションパラメータ</a></li>
<li><a href="#_値の返却">7.5. 値の返却</a></li>
</ul>
</li>
<li><a href="#_関数型プログラミング">8. 関数型プログラミング</a>
<ul class="sectlevel2">
<li><a href="#_関数は第一級オブジェクト">8.1. 関数は第一級オブジェクト</a></li>
<li><a href="#_無名関数">8.2. 無名関数</a></li>
<li><a href="#_チェイン">8.3. チェイン</a></li>
<li><a href="#_フィード演算子">8.4. フィード演算子</a></li>
<li><a href="#_ハイパー演算子">8.5. ハイパー演算子</a></li>
<li><a href="#_ジャンクション">8.6. ジャンクション</a></li>
<li><a href="#_遅延リスト">8.7. 遅延リスト</a></li>
<li><a href="#_クロージャ">8.8. クロージャ</a></li>
</ul>
</li>
<li><a href="#_クラスとオブジェクト">9. クラスとオブジェクト</a>
<ul class="sectlevel2">
<li><a href="#_イントロダクション_2">9.1. イントロダクション</a></li>
<li><a href="#_カプセル化">9.2. カプセル化</a></li>
<li><a href="#_名前付き引数と固定パラメータ">9.3. 名前付き引数と固定パラメータ</a></li>
<li><a href="#_メソッド">9.4. メソッド</a></li>
<li><a href="#_クラス属性">9.5. クラス属性</a></li>
<li><a href="#_アクセスタイプ">9.6. アクセスタイプ</a></li>
<li><a href="#_継承">9.7. 継承</a></li>
<li><a href="#_多重継承">9.8. 多重継承</a></li>
<li><a href="#_ロール">9.9. ロール</a></li>
<li><a href="#_イントロスペクション_2">9.10. イントロスペクション</a></li>
</ul>
</li>
<li><a href="#_例外処理">10. 例外処理</a>
<ul class="sectlevel2">
<li><a href="#_例外のキャッチ">10.1. 例外のキャッチ</a></li>
<li><a href="#_例外を投げる">10.2. 例外を投げる</a></li>
</ul>
</li>
<li><a href="#_正規表現">11. 正規表現</a>
<ul class="sectlevel2">
<li><a href="#_正規表現の定義">11.1. 正規表現の定義</a></li>
<li><a href="#_文字のマッチング">11.2. 文字のマッチング</a></li>
<li><a href="#_文字種へのマッチング">11.3. 文字種へのマッチング</a></li>
<li><a href="#_ユニコードのプロパティ">11.4. ユニコードのプロパティ</a></li>
<li><a href="#_ワイルドカード">11.5. ワイルドカード</a></li>
<li><a href="#_量指定子">11.6. 量指定子</a></li>
<li><a href="#_マッチ結果">11.7. マッチ結果</a></li>
<li><a href="#_例">11.8. 例</a></li>
</ul>
</li>
<li><a href="#_rakuのモジュール">12. Rakuのモジュール</a>
<ul class="sectlevel2">
<li><a href="#_モジュールの使用">12.1. モジュールの使用</a></li>
</ul>
</li>
<li><a href="#_ユニコード">13. ユニコード</a>
<ul class="sectlevel2">
<li><a href="#_ユニコードの使用">13.1. ユニコードの使用</a></li>
<li><a href="#_ユニコードを考慮した操作">13.2. ユニコードを考慮した操作</a></li>
</ul>
</li>
<li><a href="#_並列処理並行性非同期性">14. 並列処理、並行性、非同期性</a>
<ul class="sectlevel2">
<li><a href="#_並列処理">14.1. 並列処理</a></li>
<li><a href="#_並行性と非同期性">14.2. 並行性と非同期性</a></li>
</ul>
</li>
<li><a href="#_ネイティブコールインタフェース">15. ネイティブコールインタフェース</a>
<ul class="sectlevel2">
<li><a href="#_関数の呼び出し">15.1. 関数の呼び出し</a></li>
<li><a href="#_関数の名前の変更">15.2. 関数の名前の変更</a></li>
<li><a href="#_引数渡し">15.3. 引数渡し</a></li>
<li><a href="#_値の返却_2">15.4. 値の返却</a></li>
<li><a href="#_型_2">15.5. 型</a></li>
</ul>
</li>
<li><a href="#_コミュニティ">16. コミュニティ</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>この文書はプログラミング言語Rakuの全体像を素早くつかんでもらうことを目的として書かれたものです。<br>
まだRakuを触ったことのない読者の方々が、ここからRakuをはじめてもらうことを狙いとしています。</p>
</div>
<div class="paragraph">
<p>この文書のいくつかの節では <a href="https://docs.raku.org">Rakuの公式文書</a> における(もっと完成されていて正確な)箇所を参照しています。</p>
</div>
<div class="paragraph">
<p>特定の事項に関してもっと情報がほしいのであればそれらの箇所を読んでみることをおすすめします。</p>
</div>
<div class="paragraph">
<p>この文書の中では、ほとんどのトピックにおいて例がふんだんに用いられています。
理解を深めるために、自分でもすべての例を再現してみることをおすすめします。</p>
</div>
<div class="paragraph">
<div class="title">ライセンス</div>
<p>This work is licensed under the Creative Commons Attribution-ShareAlike 4.0 International License.
To view a copy of this license, visit</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="bare">https://creativecommons.org/licenses/by-sa/4.0/</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">貢献</div>
<p>もしこの文書に貢献したいのなら次のURLへ向かってください:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/hankache/rakuguide" class="bare">https://github.com/hankache/rakuguide</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">フィードバック</div>
<p>フィードバックは大歓迎です！:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="mailto:naoum@hankache.com">naoum@hankache.com</a></p>
</li>
<li>
<p><a href="mailto:titsuki@cpan.org">titsuki@cpan.org</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>もし、このRaku入門を気に入ったのなら、 <em>Star</em> を押していただければ幸いです。
<a href="https://github.com/hankache/rakuguide">Github</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_イントロダクション">1. イントロダクション</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_raku_とは">1.1. Raku とは</h3>
<div class="paragraph">
<p>Rakuは高水準、汎用、漸進的型付けの言語です。
Rakuはマルチパラダイム言語です。手続き型、オブジェクト指向、関数型プログラミングをサポートしています。</p>
</div>
<div class="ulist">
<div class="title">Raku のモットー:</div>
<ul>
<li>
<p>TMTOWTDI (ティムトゥディ と発音します): やり方はひとつじゃない</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_専門用語">1.2. 専門用語</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Raku</strong> : はテストスイートもあわせての言語の仕様です。
仕様に基づいたテストスイートを通るような実装はRakuと考えられます。</p>
</li>
<li>
<p><strong>Rakudo</strong> : はRakuのためのコンパイラです。</p>
</li>
<li>
<p><strong>Zef</strong> : はRakuのモジュールのインストーラーです。</p>
</li>
<li>
<p><strong>Rakudo Star</strong>: はRakudo, Zef, Rakuのモジュールのコレクション, 文書を含んだバンドルソフトです。</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_rakuのインストール">1.3. Rakuのインストール</h3>
<div class="paragraph">
<div class="title">Linux</div>
<p>Rakudo Starをインストールするには、次のコマンドをターミナルで実行してください:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-nb">mkdir</span> ~/<span class="tok-n">rakudo</span> &amp;&amp; <span class="tok-n">cd</span> <span class="tok-nv">$_</span>
<span class="tok-n">curl</span> -<span class="tok-n">LJO</span> <span class="tok-n">https:</span>//<span class="tok-n">rakudo</span>.<span class="tok-n">org</span><span class="tok-o">/</span><span class="tok-n">latest</span><span class="tok-o">/</span><span class="tok-n">star</span><span class="tok-o">/</span><span class="tok-n">src</span>
<span class="tok-n">tar</span> -<span class="tok-n">xzf</span> <span class="tok-n">rakudo-star-</span>*.<span class="tok-n">tar</span>.<span class="tok-n">gz</span>
<span class="tok-n">mv</span> <span class="tok-n">rakudo-star-</span>*/* .
<span class="tok-n">rm</span> -<span class="tok-n">fr</span> <span class="tok-n">rakudo-star-</span>*

./<span class="tok-n">bin</span><span class="tok-o">/</span><span class="tok-n">rstar</span> <span class="tok-n">install</span>

<span class="tok-n">echo</span> <span class="tok-s">&quot;export PATH=$(pwd)/bin/:$(pwd)/share/perl6/site/bin:$(pwd)/share/perl6/vendor/bin:$(pwd)/share/perl6/core/bin:\$PATH&quot;</span> &gt;&gt; ~/.<span class="tok-n">bashrc</span>
<span class="tok-nb">source</span> ~/.<span class="tok-n">bashrc</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>他のインストール方法を知りたければ次のリンクを参照してください。 <a href="https://rakudo.org/star/source" class="bare">https://rakudo.org/star/source</a></p>
</div>
<div class="paragraph">
<div class="title">macOS</div>
<p>四つの選択肢から選んでください:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Linuxにおけるインストール手順と同じステップを踏む</p>
</li>
<li>
<p>homebrewによるインストール: <code>brew install rakudo-star</code></p>
</li>
<li>
<p>MacPortsによるインストール: <code>sudo port install rakudo</code></p>
</li>
<li>
<p>次のURLから最新のインストーラー(.dmg拡張子のついたファイル)をダウンロードする <a href="https://rakudo.perl6.org/downloads/star/" class="bare">https://rakudo.perl6.org/downloads/star/</a></p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Windows</div>
<ol class="arabic">
<li>
<p>64bit版の場合: 最新のインストーラー(.msi拡張子のついたファイル)を次からダウンロードする <a href="https://rakudo.org/latest/star/win" class="bare">https://rakudo.org/latest/star/win</a></p>
</li>
<li>
<p>インストール後 <code>C:\rakudo\bin</code> がPATH変数に含まれていることを確認してください。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Docker</div>
<ol class="arabic">
<li>
<p>次のコマンドで公式のDockerイメージを入手してください <code>docker pull rakudo-star</code></p>
</li>
<li>
<p>イメージを含んだコンテナを実行するために次のコマンドを打ってください <code>docker run -it rakudo-star</code></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_rakuのコードを実行する">1.4. Rakuのコードを実行する</h3>
<div class="paragraph">
<p>Rakuのコードの実行はREPL (Read-Eval-Print Loop)を用いることによって行うことができます。
この実行を行うために、ターミナルを開き、ターミナルの窓に向かって <code>perl6</code> と打ち、[Enter]ボタンを押してください。
そうすると、コマンドプロンプトから <code>&gt;</code> が表示されるはずです。
次に、コードの行を打って[Enter]を押してください。
REPL はこの行の値を出力するでしょう。
そうしたら、次のコードの行を打つか、 <code>exit</code> と打った後[Enter]を押すことでREPLを去るか、どちらでも選ぶことができます。</p>
</div>
<div class="paragraph">
<p>あるいは、ファイルの中にコードを書いて、保存して実行してください。
Rakuのスクリプトは <code>.raku</code> 拡張子を持つことが推奨されています。
ターミナルの窓に対して <code>perl6 filename.raku</code> と打ち、[Enter]を押してください。
REPLとは違って、それぞれの行の結果が自動的に出力されるでしょう。: 出力を行うには、 <code>say</code> のような命令が含まれている必要があります。</p>
</div>
<div class="paragraph">
<p>REPLは多くの場合、特定のコードを実行するために用いられ、そのコードは一般的には一行です。
一行以上のプログラムに対しては、ファイルに保存してから実行することをおすすめします。</p>
</div>
<div class="paragraph">
<p>一行のコードはコマンドラインで非対話的に実行することもできます。
<code>perl6 -e 'あなたの書いたコード'</code> と打ち [Enter]を押してください.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Rakudo StarはREPLを使い倒すためのラインエディタをバンドルしています。</p>
</div>
<div class="paragraph">
<p>もしRakudo Starではなく無印のRakudoをインストールしたのなら、行編集機能を有効化(履歴閲覧のための上矢印キーと下矢印キーの使用、入力編集のための左矢印キーと右矢印キーの使用、タブによる補完機能)していないはずです。
次のコマンドを実行してこれらの機能を有効化することを考えてみてください。:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>zef install Linenoise</code> Windows/Linux/macOSで動きます</p>
</li>
<li>
<p><code>zef install Readline</code> もしLinux環境で <em>Readline</em> ライブラリを使いたいのであれば</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_エディタ">1.5. エディタ</h3>
<div class="paragraph">
<p>ほとんどの場合、Rakuのプログラムを書いて保存することになります。
そのため、Rakuの文法を認識できるまともなテキストエディタを持っているべきです。</p>
</div>
<div class="paragraph">
<p>私が個人的に使っていておすすめのエディタは <a href="https://atom.io/">Atom</a> です。
モダンなテキストエディタであり、革新的なRakuのシンタックスハイライティング機能を持っています。
別の選択肢として、 <a href="https://atom.io/packages/language-perl6">Perl 6 FE</a> というAtomのためのシンタックスハイライターがあります。
オリジナルのパッケージから派生したものですが、多くのバグフィックスと追加機能を含んでいます。</p>
</div>
<div class="paragraph">
<p><a href="http://www.vim.org/">Vim</a>, <a href="https://www.gnu.org/software/emacs/">Emacs</a>, <a href="http://padre.perlide.org/">Padre</a> もまた、Rakuコミュニティの他の人々によって使われています。</p>
</div>
<div class="paragraph">
<p>最近のバージョンのVimは、はじめから革新的なシンタックスハイライティング機能を持っています。
EmacsとPadreは追加のパッケージのインストールが必要になるでしょう。</p>
</div>
</div>
<div class="sect2">
<h3 id="_こんにちは世界">1.6. こんにちは世界!</h3>
<div class="paragraph">
<p>おなじみの <code>こんにちは世界</code> の儀式をはじめましょう。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-nb">say</span> <span class="tok-s">&#39;こんにちは世界&#39;</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>これはこういう風に書くこともできます:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-s">&#39;こんにちは世界&#39;</span>.<span class="tok-nb">say</span>;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_文法の概要">1.7. 文法の概要</h3>
<div class="paragraph">
<p>Raku は <strong>自由形式</strong>: ほとんどの場合、空白文字をどれだけの量つかっても良いです。ただし、空白文字が意味を持つ場合もあります。</p>
</div>
<div class="paragraph">
<p><strong>命令文</strong> は一般的にはコードの論理的な行です。最後にセミコロンがついている必要があります:
<code>say "Hello" if True;</code></p>
</div>
<div class="paragraph">
<p><strong>式</strong> は値を返すような特殊なタイプの命令文です:
<code>1+2</code> は <code>3</code> を返すでしょう。
式は <strong>項</strong> と <strong>演算子</strong> でできています。</p>
</div>
<div class="paragraph">
<p><strong>項</strong> は:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>変数</strong>: 操作したり変更したりできる値です。</p>
</li>
<li>
<p><strong>リテラル</strong>: 数や文字列のような定数です。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>演算子</strong> は次のような種類に分類されます。:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>種類</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>説明</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>例</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">接頭辞</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">項の前</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>++1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">接中辞</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">項の間</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1+2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">接尾辞</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">項の後ろ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1++</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">接周辞</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">項の周り</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(1)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">後置接周辞</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">項の後ろの、また別の項の周り</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Array[1]</code></p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_識別子">1.7.1. 識別子</h4>
<div class="paragraph">
<p>識別子とは項を定義したときに与えられる名前のことです。</p>
</div>
<div class="ulist">
<div class="title">ルール:</div>
<ul>
<li>
<p>アルファベットかアンダースコアで始まっていなければならない。</p>
</li>
<li>
<p>数字をふくむことができる。(ただし先頭文字は除く)</p>
</li>
<li>
<p>アルファベットがダッシュやアポストロフィ(ただし最初と最後の文字は除く)の右側にあるなら、ダッシュやアポストロフィをふくむことができる。</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>正しい例</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>間違った例</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>var1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1var</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>var-one</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>var-1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>var&#8217;one</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>var'1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>var1_</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>var1'</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_var</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-var</code></p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<div class="title">命名規則:</div>
<ul>
<li>
<p>キャメルケース: <code>variableNo1</code></p>
</li>
<li>
<p>ケバブケース: <code>variable-no1</code></p>
</li>
<li>
<p>スネークケース: <code>variable_no1</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>識別子には好きなように名前をつけることができます。しかし、一貫して一つの命名規則を適用していくのがグッドプラクティスです。</p>
</div>
<div class="paragraph">
<p>ちゃんと意味のある名前をつければプログラミング人生を楽なものにしてくれるかもしれません。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>var1 = var2 * var3</code> は文法的には正しいですが目的が明白ではありません。</p>
</li>
<li>
<p><code>monthly-salary = daily-rate * working-days</code> のほうが変数名としてふさわしいでしょう。</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_コメント">1.7.2. コメント</h4>
<div class="paragraph">
<p>コメントはコンパイラーに無視され注釈として使われるテキストです。</p>
</div>
<div class="paragraph">
<p>コメントは三つのタイプに分けられます:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>一行:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-c1"># これは一行のコメントです</span></code></pre>
</div>
</div>
</li>
<li>
<p>埋め込み:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-nb">say</span> <span class="tok-cm">#`(これは埋めこまれたコメントです)</span> <span class="tok-s">&quot;Hello World.&quot;</span></code></pre>
</div>
</div>
</li>
<li>
<p>複数行:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-cm">=begin comment</span>
<span class="tok-cm">これは複数行のコメントです。</span>
<span class="tok-cm">コメント1</span>
<span class="tok-cm">コメント2</span>
<span class="tok-cm">=end comment</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_クォート">1.7.3. クォート</h4>
<div class="paragraph">
<p>文字列はダブルクォートかシングルクォートのどちらかで囲まれていなければなりません。</p>
</div>
<div class="paragraph">
<p>下記に該当する場合は常にダブルクォートを使うべきです:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>文字列がアポストロフィを含んでいる</p>
</li>
<li>
<p>文字列が展開される必要のある変数を含んでいる</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-nb">say</span> <span class="tok-s">&#39;Hello World&#39;</span>;   <span class="tok-c1"># Hello World</span>
<span class="tok-nb">say</span> <span class="tok-s">&quot;Hello World&quot;</span>;   <span class="tok-c1"># Hello World</span>
<span class="tok-nb">say</span> <span class="tok-s">&quot;Don&#39;t&quot;</span>;         <span class="tok-c1"># Don&#39;t</span>
<span class="tok-k">my</span> <span class="tok-nv">$name</span> = <span class="tok-s">&#39;John Doe&#39;</span>;
<span class="tok-nb">say</span> <span class="tok-s">&#39;Hello $name&#39;</span>;   <span class="tok-c1"># Hello $name</span>
<span class="tok-nb">say</span> <span class="tok-s">&quot;Hello $name&quot;</span>;   <span class="tok-c1"># Hello John Doe</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_演算子">2. 演算子</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_一般的な演算子">2.1. 一般的な演算子</h3>
<div class="paragraph">
<p>下記の表は最も一般的に使われている演算子を掲載しています。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 7.1428%;">
<col style="width: 7.1428%;">
<col style="width: 28.5714%;">
<col style="width: 28.5714%;">
<col style="width: 28.5716%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle">演算子</th>
<th class="tableblock halign-center valign-middle">種類</th>
<th class="tableblock halign-left valign-middle">説明</th>
<th class="tableblock halign-left valign-middle">例</th>
<th class="tableblock halign-left valign-middle">結果</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>+</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">加算</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>1 + 2</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>-</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">減算</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>3 - 1</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>*</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">乗算</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>3 * 2</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>6</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>**</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">冪乗</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>3 ** 2</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>9</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>/</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">除算</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>3 / 2</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>1.5</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>div</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">整数除算 (切り捨て)</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>3 div 2</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>%</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">法</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>7 % 4</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock"><code>%%</code></p></td>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle" rowspan="2"><p class="tableblock">割り切れるか否か</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>6 %% 4</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>False</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>6 %% 3</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>gcd</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">最大公約数</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>6 gcd 9</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>lcm</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">最小公倍数</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>6 lcm 9</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>18</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>==</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">数値が等しい</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>9 == 7</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>False</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>!=</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">数値が等しくない</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>9 != 7</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>&lt;</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">数値が小さい</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>9 &lt; 7</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>False</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>&gt;</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">数値が大きい</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>9 &gt; 7</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>&lt;=</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">数値が等しいか小さい</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>7 &lt;= 7</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>&gt;=</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">数値が等しいか大きい</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>9 &gt;= 7</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="3"><p class="tableblock"><code>&lt;=&gt;</code></p></td>
<td class="tableblock halign-center valign-middle" rowspan="3"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle" rowspan="3"><p class="tableblock">数値の三元演算子</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>1 &lt;=&gt; 1.0</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>Same</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>1 &lt;=&gt; 2</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>Less</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>3 &lt;=&gt; 2</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>More</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>eq</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">文字列が等しい</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>"John" eq "John"</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>ne</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">文字列が等しくない</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>"John" ne "Jane"</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>lt</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">辞書順で小さい</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>"a" lt "b"</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>gt</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">辞書順で大きい</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>"a" gt "b"</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>False</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>le</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">辞書順で小さいか等しい</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>"a" le "a"</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>ge</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">辞書順で大きいか等しい</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>"a" ge "b"</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>False</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="3"><p class="tableblock"><code>leg</code></p></td>
<td class="tableblock halign-center valign-middle" rowspan="3"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle" rowspan="3"><p class="tableblock">文字列の三元演算子</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>"a" leg "a"</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>Same</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>"a" leg "b"</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>Less</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>"c" leg "b"</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>More</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock"><code>cmp</code></p></td>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock"><code>Infix</code></p></td>
<td class="tableblock halign-left valign-middle" rowspan="2"><p class="tableblock">スマート三元演算子</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>"a" cmp "b"</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>Less</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>3.5 cmp 2.6</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>More</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>=</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">代入</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>my $var = 7</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>変数 <code>$var</code> に値 <code>7</code> を代入する</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock"><code>~</code></p></td>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle" rowspan="2"><p class="tableblock">文字列の結合</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>9 ~ 7</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>97</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>"Hi " ~ "there"</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>Hi there</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock"><code>x</code></p></td>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle" rowspan="2"><p class="tableblock">文字列の複製</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>13 x 3</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>131313</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>"Hello " x 3</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>Hello Hello Hello</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="5"><p class="tableblock"><code>~~</code></p></td>
<td class="tableblock halign-center valign-middle" rowspan="5"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle" rowspan="5"><p class="tableblock">スマートマッチ</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>2 ~~ 2</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>2 ~~ Int</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>"Raku" ~~ "Raku"</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>"Raku" ~~ Str</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>"enlightenment" ~~ /light/</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>｢light｣</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock"><code>++</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接頭辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">インクリメント</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>my $var = 2; ++$var;</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>1だけ値をインクリメントし、結果の <code>3</code> を返す</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接尾辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">インクリメント</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>my $var = 2; $var++;</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code><code>2</code> を返して、それから値をインクリメントする</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock"><code>--</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接頭辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">デクリメント</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>my $var = 2; --$var;</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>1だけ値をデクリメントし、結果の <code>1</code> を返す</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接尾辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">デクリメント</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>my $var = 2; $var--;</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code><code>2</code> を返して、それから値をデクリメントする</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="3"><p class="tableblock"><code>+</code></p></td>
<td class="tableblock halign-center valign-middle" rowspan="3"><p class="tableblock"><code>接頭辞</code></p></td>
<td class="tableblock halign-left valign-middle" rowspan="3"><p class="tableblock">被演算子を数値にする</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>+"3"</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>+True</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>+False</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>0</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="3"><p class="tableblock"><code>-</code></p></td>
<td class="tableblock halign-center valign-middle" rowspan="3"><p class="tableblock"><code>接頭辞</code></p></td>
<td class="tableblock halign-left valign-middle" rowspan="3"><p class="tableblock">被演算子を数値にし、その負の値を返す</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>-"3"</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>-3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>-True</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>-1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>-False</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>0</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="6"><p class="tableblock"><code>?</code></p></td>
<td class="tableblock halign-center valign-middle" rowspan="6"><p class="tableblock"><code>接頭辞</code></p></td>
<td class="tableblock halign-left valign-middle" rowspan="6"><p class="tableblock">被演算子をブーリアンにする</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>?0</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>False</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>?9.8</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>?"Hello"</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>?""</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>False</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>my $var; ?$var;</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>False</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>my $var = 7; ?$var;</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>!</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接頭辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">被演算子をブーリアンにし、その否定を返す</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>!4</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>False</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>..</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Rangeクラスのコンストラクタ</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>0..5</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>区間 [0, 5] のインスタンスをつくる <sup class="footnote" id="_footnote_intervals">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>..^</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Rangeクラスのコンストラクタ</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>0..^5</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>区間 [0, 5) のインスタンスをつくる <sup class="footnoteref">[<a class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>^..</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Rangeクラスのコンストラクタ</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>0^..5</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>区間 (0, 5] のインスタンスをつくる <sup class="footnoteref">[<a class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>^..^</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Rangeクラスのコンストラクタ</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>0^..^5</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>区間 (0, 5) のインスタンスをつくる <sup class="footnoteref">[<a class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>^</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接頭辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Rangeクラスのコンストラクタ</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>^5</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>0..^5 と同じく 区間 [0, 5) のインスタンスをつくる <sup class="footnoteref">[<a class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>&#8230;&#8203;</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>接中辞</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">遅延リストのコンストラクタ</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>0&#8230;&#8203;9999</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>リクエストのある場合のみ要素を返す</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock"><code>|</code></p></td>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock"><code>接頭辞</code></p></td>
<td class="tableblock halign-left valign-middle" rowspan="2"><p class="tableblock">平坦化</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>|(0..5)</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>(0 1 2 3 4 5)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>|(0^..^5)</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>(1 2 3 4)</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_逆転演算子">2.2. 逆転演算子</h3>
<div class="paragraph">
<p>演算子の前に <code>R</code> を追加することで被演算子を逆転させる効果を持たせることができるでしょう。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">通常の演算</th>
<th class="tableblock halign-left valign-middle">結果</th>
<th class="tableblock halign-left valign-middle">逆転演算子</th>
<th class="tableblock halign-left valign-middle">結果</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>2 / 3</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>0.666667</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>2 R/ 3</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>1.5</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>2 - 1</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>2 R- 1</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>-1</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_簡約演算子">2.3. 簡約演算子</h3>
<div class="paragraph">
<p>簡約演算子は値のリストに対して作用します。
簡約演算子は演算子を角括弧 <code>[]</code> で囲むことで構成されます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">通常の演算</th>
<th class="tableblock halign-left valign-middle">結果</th>
<th class="tableblock halign-left valign-middle">簡約演算子</th>
<th class="tableblock halign-left valign-middle">結果</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>1 + 2 + 3 + 4 + 5</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>15</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>[+] 1,2,3,4,5</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>15</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>1 * 2 * 3 * 4 * 5</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>120</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>[*] 1,2,3,4,5</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>120</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
もしその演算の優先順位を含んだ、演算子のすべてのリストを知りたいのであれば、次のURLを参照することをすすめます <a href="https://docs.raku.org/language/operators" class="bare">https://docs.raku.org/language/operators</a>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_変数">3. 変数</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Rakuの変数は三つのカテゴリに分類されます: スカラ、配列、ハッシュです。</p>
</div>
<div class="paragraph">
<p><strong>シジル</strong> (ラテン語で印という意味) は変数を分類するときに使われる接頭辞です。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>$</code> はスカラのために使われます</p>
</li>
<li>
<p><code>@</code> は配列のために使われます</p>
</li>
<li>
<p><code>%</code> はハッシュのために使われます</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_スカラ">3.1. スカラ</h3>
<div class="paragraph">
<p>スカラはある値や参照を持っています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-c1"># 文字列</span>
<span class="tok-k">my</span> <span class="tok-nv">$name</span> = <span class="tok-s">&#39;John Doe&#39;</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$name</span>;

<span class="tok-c1"># 整数</span>
<span class="tok-k">my</span> <span class="tok-nv">$age</span> = <span class="tok-mi">99</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$age</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>あるスカラに対して行うことのできる演算の種類は、そのスカラが保持している値に依存しています。</p>
</div>
<div class="listingblock">
<div class="title">文字列</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$name</span> = <span class="tok-s">&#39;John Doe&#39;</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$name</span>.<span class="tok-nb">uc</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$name</span>.<span class="tok-nb">chars</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$name</span>.<span class="tok-nb">flip</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-n">JOHN</span> <span class="tok-n">DOE</span>
<span class="tok-mi">8</span>
<span class="tok-n">eoD</span> <span class="tok-n">nhoJ</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
もし文字列に対して適用できるすべてのメソッドのリストを知りたいのであれば、次のURLを参照することをすすめます <a href="https://docs.raku.org/type/Str" class="bare">https://docs.raku.org/type/Str</a>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">整数</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$age</span> = <span class="tok-mi">17</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$age</span>.<span class="tok-nb">is-prime</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-nb">True</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
もし整数に対して適用できるすべてのメソッドのリストを知りたいのであれば、次のURLを参照することをすすめます <a href="https://docs.raku.org/type/Int" class="bare">https://docs.raku.org/type/Int</a>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">有理数</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$age</span> = <span class="tok-mf">2.3</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$age</span>.<span class="tok-nb">numerator</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$age</span>.<span class="tok-nb">denominator</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$age</span>.<span class="tok-nb">nude</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-mi">23</span>
<span class="tok-mi">10</span>
(<span class="tok-mi">23</span> <span class="tok-mi">10</span>)</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
もし有理数に対して適用できるすべてのメソッドのリストを知りたいのであれば、次のURLを参照することをすすめます <a href="https://docs.raku.org/type/Rat" class="bare">https://docs.raku.org/type/Rat</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_配列">3.2. 配列</h3>
<div class="paragraph">
<p>配列は複数の値を含んだリストです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@animals</span> = <span class="tok-s">&#39;camel&#39;</span>,<span class="tok-s">&#39;llama&#39;</span>,<span class="tok-s">&#39;owl&#39;</span>;
<span class="tok-nb">say</span> <span class="tok-nv">@animals</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>下記の例のように、配列に対してたくさんの演算をおこなうことが可能です:</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
チルダ <code>~</code> は文字列の結合のために使われています。
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title"><code>スクリプト</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@animals</span> = <span class="tok-s">&#39;camel&#39;</span>,<span class="tok-s">&#39;vicuña&#39;</span>,<span class="tok-s">&#39;llama&#39;</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;The zoo contains &quot;</span> ~ <span class="tok-nv">@animals</span>.<span class="tok-nb">elems</span> ~ <span class="tok-s">&quot; animals&quot;</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;The animals are: &quot;</span> ~ <span class="tok-nv">@animals</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;I will adopt an owl for the zoo&quot;</span>;
<span class="tok-nv">@animals</span>.<span class="tok-nb">push</span>(<span class="tok-s">&quot;owl&quot;</span>);
<span class="tok-nb">say</span> <span class="tok-s">&quot;Now my zoo has: &quot;</span> ~ <span class="tok-nv">@animals</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;The first animal we adopted was the &quot;</span> ~ <span class="tok-nv">@animals</span>[<span class="tok-mi">0</span>];
<span class="tok-nv">@animals</span>.<span class="tok-nb">pop</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;Unfortunately the owl got away and we&#39;re left with: &quot;</span> ~ <span class="tok-nv">@animals</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;We&#39;re closing the zoo and keeping one animal only&quot;</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;We&#39;re going to let go: &quot;</span> ~ <span class="tok-nv">@animals</span>.<span class="tok-nb">splice</span>(<span class="tok-mi">1</span>,<span class="tok-mi">2</span>) ~ <span class="tok-s">&quot; and keep the &quot;</span> ~ <span class="tok-nv">@animals</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><code>出力</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-n">The</span> <span class="tok-n">zoo</span> <span class="tok-nb">contains</span> <span class="tok-mi">3</span> <span class="tok-n">animals</span>
<span class="tok-n">The</span> <span class="tok-n">animals</span> <span class="tok-n">are:</span> <span class="tok-n">camel</span> <span class="tok-n">vicuña</span> <span class="tok-n">llama</span>
<span class="tok-n">I</span> <span class="tok-n">will</span> <span class="tok-n">adopt</span> <span class="tok-n">an</span> <span class="tok-n">owl</span> <span class="tok-k">for</span> <span class="tok-n">the</span> <span class="tok-n">zoo</span>
<span class="tok-n">Now</span> <span class="tok-k">my</span> <span class="tok-n">zoo</span> <span class="tok-n">has:</span> <span class="tok-n">camel</span> <span class="tok-n">vicuña</span> <span class="tok-n">llama</span> <span class="tok-n">owl</span>
<span class="tok-n">The</span> <span class="tok-nb">first</span> <span class="tok-n">animal</span> <span class="tok-n">we</span> <span class="tok-n">adopted</span> <span class="tok-n">was</span> <span class="tok-n">the</span> <span class="tok-n">camel</span>
<span class="tok-n">Unfortunately</span> <span class="tok-n">the</span> <span class="tok-n">owl</span> <span class="tok-nb">got</span> <span class="tok-n">away</span> <span class="tok-o">and</span> <span class="tok-n">we&#39;re</span> <span class="tok-n">left</span> <span class="tok-n">with:</span> <span class="tok-n">camel</span> <span class="tok-n">vicuña</span> <span class="tok-n">llama</span>
<span class="tok-n">We&#39;re</span> <span class="tok-n">closing</span> <span class="tok-n">the</span> <span class="tok-n">zoo</span> <span class="tok-o">and</span> <span class="tok-n">keeping</span> <span class="tok-nb">one</span> <span class="tok-n">animal</span> <span class="tok-n">only</span>
<span class="tok-n">We&#39;re</span> <span class="tok-n">going</span> <span class="tok-nb">to</span> <span class="tok-k">let</span> <span class="tok-n">go:</span> <span class="tok-n">vicuña</span> <span class="tok-n">llama</span> <span class="tok-o">and</span> <span class="tok-nb">keep</span> <span class="tok-n">the</span> <span class="tok-n">camel</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">説明</div>
<p><code>.elems</code> は配列の中の要素数を返します。<br>
<code>.push()</code> は配列に一つかそれ以上の要素を追加します。<br>
配列の中の特定の要素の位置を指定することで、その要素にアクセスすることができます。 <code>@animals[0]</code><br>
<code>.pop</code> は配列から最後の要素を削除し、そしてそれを返します。<br>
<code>.splice(a,b)</code> は位置 <code>a</code> から始まる <code>b</code> 個の要素を削除します。</p>
</div>
<div class="sect3">
<h4 id="_固定サイズの配列">3.2.1. 固定サイズの配列</h4>
<div class="paragraph">
<p>基本的な配列は次のように宣言されます:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@array</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>基本的な配列は不定の長さを持つことができ、それゆえにこの機能は自動拡張とよばれています。<br>
この配列は要素数に制限がありません。</p>
</div>
<div class="paragraph">
<p>対照的に、固定サイズの配列をつくることもできます。<br>
あらかじめ定義されたサイズを超えたところにアクセスすることはできません。</p>
</div>
<div class="paragraph">
<p>固定サイズの配列を宣言するためには、名前のすぐ後の角括弧の中にその最大要素数を指定してください。:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@array</span>[<span class="tok-mi">3</span>];</code></pre>
</div>
</div>
<div class="paragraph">
<p>この配列は三つの値を保持することができ、その添え字は0から2までの値をとります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@array</span>[<span class="tok-mi">3</span>];
<span class="tok-nv">@array</span>[<span class="tok-mi">0</span>] = <span class="tok-s">&quot;first value&quot;</span>;
<span class="tok-nv">@array</span>[<span class="tok-mi">1</span>] = <span class="tok-s">&quot;second value&quot;</span>;
<span class="tok-nv">@array</span>[<span class="tok-mi">2</span>] = <span class="tok-s">&quot;third value&quot;</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>四つ目の値をこの配列に対して追加することはできません。:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@array</span>[<span class="tok-mi">3</span>];
<span class="tok-nv">@array</span>[<span class="tok-mi">0</span>] = <span class="tok-s">&quot;first value&quot;</span>;
<span class="tok-nv">@array</span>[<span class="tok-mi">1</span>] = <span class="tok-s">&quot;second value&quot;</span>;
<span class="tok-nv">@array</span>[<span class="tok-mi">2</span>] = <span class="tok-s">&quot;third value&quot;</span>;
<span class="tok-nv">@array</span>[<span class="tok-mi">3</span>] = <span class="tok-s">&quot;fourth value&quot;</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-n">Index</span> <span class="tok-mi">3</span> <span class="tok-k">for</span> <span class="tok-n">dimension</span> <span class="tok-mi">1</span> <span class="tok-n">out</span> <span class="tok-nb">of</span> <span class="tok-nb">range</span> (<span class="tok-n">must</span> <span class="tok-n">be</span> <span class="tok-mi">0</span><span class="tok-o">..</span><span class="tok-mi">2</span>)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_多次元配列">3.2.2. 多次元配列</h4>
<div class="paragraph">
<p>今まで見てきた配列は一次元配列でした。<br>
幸運なことに、Rakuでは多次元配列を定義することができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@tbl</span>[<span class="tok-mi">3</span>;<span class="tok-mi">2</span>];</code></pre>
</div>
</div>
<div class="paragraph">
<p>この配列は二次元です。
一つ目の次元は最大で三つの値をもつことができ、二つ目の次元は最大で二つの値を持つことができます。</p>
</div>
<div class="paragraph">
<p>3x2の格子だと考えてください。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@tbl</span>[<span class="tok-mi">3</span>;<span class="tok-mi">2</span>];
<span class="tok-nv">@tbl</span>[<span class="tok-mi">0</span>;<span class="tok-mi">0</span>] = <span class="tok-mi">1</span>;
<span class="tok-nv">@tbl</span>[<span class="tok-mi">0</span>;<span class="tok-mi">1</span>] = <span class="tok-s">&quot;x&quot;</span>;
<span class="tok-nv">@tbl</span>[<span class="tok-mi">1</span>;<span class="tok-mi">0</span>] = <span class="tok-mi">2</span>;
<span class="tok-nv">@tbl</span>[<span class="tok-mi">1</span>;<span class="tok-mi">1</span>] = <span class="tok-s">&quot;y&quot;</span>;
<span class="tok-nv">@tbl</span>[<span class="tok-mi">2</span>;<span class="tok-mi">0</span>] = <span class="tok-mi">3</span>;
<span class="tok-nv">@tbl</span>[<span class="tok-mi">2</span>;<span class="tok-mi">1</span>] = <span class="tok-s">&quot;z&quot;</span>;
<span class="tok-nb">say</span> <span class="tok-nv">@tbl</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span>[[<span class="tok-mi">1</span> <span class="tok-nb">x</span>] [<span class="tok-mi">2</span> <span class="tok-n">y</span>] [<span class="tok-mi">3</span> <span class="tok-nb">z</span>]]</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">配列の視覚的表現:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span>[<span class="tok-mi">1</span> <span class="tok-nb">x</span>]
[<span class="tok-mi">2</span> <span class="tok-n">y</span>]
[<span class="tok-mi">3</span> <span class="tok-nb">z</span>]</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
もし配列に関するすべての情報を知りたいのであれば、次のURLを参照することをすすめます <a href="https://docs.raku.org/type/Array" class="bare">https://docs.raku.org/type/Array</a>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ハッシュ">3.3. ハッシュ</h3>
<div class="listingblock">
<div class="title">ハッシュはキー/値のペアの集合です。</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">%capitals</span> = <span class="tok-s">&#39;UK&#39;</span>,<span class="tok-s">&#39;London&#39;</span>,<span class="tok-s">&#39;Germany&#39;</span>,<span class="tok-s">&#39;Berlin&#39;</span>;
<span class="tok-nb">say</span> <span class="tok-nv">%capitals</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">ハッシュに対して要素を入れるための別の簡潔な方法:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">%capitals</span> = <span class="tok-n">UK</span> =&gt; <span class="tok-s">&#39;London&#39;</span>, <span class="tok-n">Germany</span> =&gt; <span class="tok-s">&#39;Berlin&#39;</span>;
<span class="tok-nb">say</span> <span class="tok-nv">%capitals</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>ハッシュに対して呼び出すことのできるいくつかのメソッド:</p>
</div>
<div class="listingblock">
<div class="title"><code>スクリプト</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">%capitals</span> = <span class="tok-n">UK</span> =&gt; <span class="tok-s">&#39;London&#39;</span>, <span class="tok-n">Germany</span> =&gt; <span class="tok-s">&#39;Berlin&#39;</span>;
<span class="tok-nv">%capitals</span>.<span class="tok-n">push:</span> (<span class="tok-n">France</span> =&gt; <span class="tok-s">&#39;Paris&#39;</span>);
<span class="tok-nb">say</span> <span class="tok-nv">%capitals</span>.<span class="tok-nb">kv</span>;
<span class="tok-nb">say</span> <span class="tok-nv">%capitals</span>.<span class="tok-nb">keys</span>;
<span class="tok-nb">say</span> <span class="tok-nv">%capitals</span>.<span class="tok-nb">values</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;The capital of France is: &quot;</span> ~ <span class="tok-nv">%capitals&lt;France&gt;</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><code>出力</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span>(<span class="tok-n">France</span> <span class="tok-n">Paris</span> <span class="tok-n">Germany</span> <span class="tok-n">Berlin</span> <span class="tok-n">UK</span> <span class="tok-n">London</span>)
(<span class="tok-n">France</span> <span class="tok-n">Germany</span> <span class="tok-n">UK</span>)
(<span class="tok-n">Paris</span> <span class="tok-n">Berlin</span> <span class="tok-n">London</span>)
<span class="tok-n">The</span> <span class="tok-n">capital</span> <span class="tok-nb">of</span> <span class="tok-n">France</span> <span class="tok-n">is:</span> <span class="tok-n">Paris</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">説明</div>
<p><code>.push: (key =&gt; 'Value')</code> は新たな キー/値のペアを追加します。<br>
<code>.kv</code> はすべてのキーと値を含んだリストを返します。<br>
<code>.keys</code> はすべてのキーを含んだリストを返します。<br>
<code>.values</code> はすべての値を含んだリストを返します。<br>
キーを指定することでハッシュの中の特定の値にアクセスすることができます。<code>%hash&lt;key&gt;</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
もしハッシュに関するすべての情報を知りたいのであれば、次のURLを参照することをすすめます <a href="https://docs.raku.org/type/Hash" class="bare">https://docs.raku.org/type/Hash</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_型">3.4. 型</h3>
<div class="paragraph">
<p>今までの例では、変数が保持しているべき値の型について指定してはいませんでした。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>.WHAT</code> は変数が保持している値の型を返します。
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$var</span> = <span class="tok-s">&#39;Text&#39;</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var</span>.<span class="tok-nb">WHAT</span>;

<span class="tok-nv">$var</span> = <span class="tok-mi">123</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var</span>.<span class="tok-nb">WHAT</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>上記の例からわかるように、 <code>$var</code> の中の値の型は一度 (Str) になり、それから (Int) になっています。</p>
</div>
<div class="paragraph">
<p>このプログラミングのスタイルは動的型付けと呼ばれています。
変数はAny型の値を持つことができるという意味で動的なのです。</p>
</div>
<div class="paragraph">
<p>では、下記の例を実行してみましょう:<br>
変数名の前の <code>Int</code> に注目してください。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nb">Int</span> <span class="tok-nv">$var</span> = <span class="tok-s">&#39;Text&#39;</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var</span>.<span class="tok-nb">WHAT</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>これは実行に失敗して次のようなメッセージを返すでしょう: <code>Type check failed in assignment to $var; expected Int but got Str</code></p>
</div>
<div class="paragraph">
<p>あらかじめ変数の型は(Int)でなければならないと指定したのが原因です。
この変数に対して(Str)型の値を代入しようとしたときに、失敗してしまいました。</p>
</div>
<div class="paragraph">
<p>このプログラミングのスタイルは静的型付けとよばれています。
変数の型は代入の前に定義され、変えることができないという意味で静的なのです。</p>
</div>
<div class="paragraph">
<p>Rakuは <strong>漸進的型付け</strong> に分類されます; <strong>静的</strong> 型付けと <strong>動的</strong> 型付けの両方を使うことができるのです。</p>
</div>
<div class="listingblock">
<div class="title">配列とハッシュもまた静的型付けを行うことができます:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nb">Int</span> <span class="tok-nv">@array</span> = <span class="tok-mi">1</span>,<span class="tok-mi">2</span>,<span class="tok-mi">3</span>;
<span class="tok-nb">say</span> <span class="tok-nv">@array</span>;
<span class="tok-nb">say</span> <span class="tok-nv">@array</span>.<span class="tok-nb">WHAT</span>;

<span class="tok-k">my</span> <span class="tok-nb">Str</span> <span class="tok-nv">@multilingual</span> = <span class="tok-s">&quot;Hello&quot;</span>,<span class="tok-s">&quot;Salut&quot;</span>,<span class="tok-s">&quot;Hallo&quot;</span>,<span class="tok-s">&quot;您好&quot;</span>,<span class="tok-s">&quot;안녕하세요&quot;</span>,<span class="tok-s">&quot;こんにちは&quot;</span>;
<span class="tok-nb">say</span> <span class="tok-nv">@multilingual</span>;
<span class="tok-nb">say</span> <span class="tok-nv">@multilingual</span>.<span class="tok-nb">WHAT</span>;

<span class="tok-k">my</span> <span class="tok-nb">Str</span> <span class="tok-nv">%capitals</span> = <span class="tok-n">UK</span> =&gt; <span class="tok-s">&#39;London&#39;</span>, <span class="tok-n">Germany</span> =&gt; <span class="tok-s">&#39;Berlin&#39;</span>;
<span class="tok-nb">say</span> <span class="tok-nv">%capitals</span>;
<span class="tok-nb">say</span> <span class="tok-nv">%capitals</span>.<span class="tok-nb">WHAT</span>;

<span class="tok-k">my</span> <span class="tok-nb">Int</span> <span class="tok-nv">%country-codes</span> = <span class="tok-n">UK</span> =&gt; <span class="tok-mi">44</span>, <span class="tok-n">Germany</span> =&gt; <span class="tok-mi">49</span>;
<span class="tok-nb">say</span> <span class="tok-nv">%country-codes</span>;
<span class="tok-nb">say</span> <span class="tok-nv">%country-codes</span>.<span class="tok-nb">WHAT</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">下記は最も一般的に使われている型のリストです:</div>
<p>最初の二つの型は使わないかもしれませんが情報提供のために掲載しておきます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 42.8571%;">
<col style="width: 28.5714%;">
<col style="width: 14.2858%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code><strong>型</strong></code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code><strong>説明</strong></code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code><strong>例</strong></code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code><strong>結果</strong></code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>Mu</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>Rakuの型階層のルート</code></p></td>
<td class="tableblock halign-left valign-middle"></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>Any</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>新しいクラスやほとんどの組み込みのクラスのためのデフォルトの基底クラス</code></p></td>
<td class="tableblock halign-left valign-middle"></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>Cool</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>文字列と数値を交互に扱うことのできる値</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>my Cool $var = 31; say $var.flip; say $var * 2;</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>13 62</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>Str</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>文字列</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>my Str $var = "NEON"; say $var.flip;</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>NOEN</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>Int</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>整数 (任意の精度)</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>7 + 7</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>14</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>Rat</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>有理数 (制限された精度)</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>0.1 + 0.2</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>0.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>Bool</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>ブーリアン</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>!True</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>False</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_イントロスペクション">3.5. イントロスペクション</h3>
<div class="paragraph">
<p>イントロスペクションはその型といったオブジェクトのプロパティについて情報を得るための処理です。<br>
前節の例の一つでは変数の型を返すために <code>.WHAT</code> を使いました。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nb">Int</span> <span class="tok-nv">$var</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var</span>.<span class="tok-nb">WHAT</span>;    <span class="tok-c1"># (Int)</span>
<span class="tok-k">my</span> <span class="tok-nv">$var2</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var2</span>.<span class="tok-nb">WHAT</span>;   <span class="tok-c1"># (Any)</span>
<span class="tok-nv">$var2</span> = <span class="tok-mi">1</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var2</span>.<span class="tok-nb">WHAT</span>;   <span class="tok-c1"># (Int)</span>
<span class="tok-nv">$var2</span> = <span class="tok-s">&quot;Hello&quot;</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var2</span>.<span class="tok-nb">WHAT</span>;   <span class="tok-c1"># (Str)</span>
<span class="tok-nv">$var2</span> = <span class="tok-nb">True</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var2</span>.<span class="tok-nb">WHAT</span>;   <span class="tok-c1"># (Bool)</span>
<span class="tok-nv">$var2</span> = <span class="tok-nb">Nil</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var2</span>.<span class="tok-nb">WHAT</span>;   <span class="tok-c1"># (Any)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>値を持っている変数の型はその値と相互に関連があります。<br>
型の指定された空の変数の型はその変数が宣言されたときの型です。<br>
型の指定されていない空の変数の型は <code>(Any)</code> です。<br>
変数の値をクリアするためには <code>Nil</code> を代入してください。</p>
</div>
</div>
<div class="sect2">
<h3 id="_スコーピング">3.6. スコーピング</h3>
<div class="paragraph">
<p>初めに変数を使う前に、宣言されている必要があります。</p>
</div>
<div class="paragraph">
<p>様々な宣言子がRakuでは使われています。今までのところ、使ってきたのは <code>my</code> です。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$var</span>=<span class="tok-mi">1</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>my</code> 宣言子は変数に対して <strong>レキシカル</strong> スコープを与えます。
つまり、その変数はそれが宣言されたのと同じブロックの中でしかアクセスできなくなります。</p>
</div>
<div class="paragraph">
<p>Rakuのブロックは <code>{ }</code> で囲まれます。
もしブロックがみつからないのなら、その変数はRakuのスクリプト全体で使える状態になっています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span>{
  <span class="tok-k">my</span> <span class="tok-nb">Str</span> <span class="tok-nv">$var</span> = <span class="tok-s">&#39;Text&#39;</span>;
  <span class="tok-nb">say</span> <span class="tok-nv">$var</span>; <span class="tok-c1"># はアクセス可能です</span>
}
<span class="tok-nb">say</span> <span class="tok-nv">$var</span>; <span class="tok-c1"># はアクセス可能ではありません。エラーを返します。</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>変数はその変数が定義されたブロックの中でのみアクセスが可能なので、別のブロックでは同じ変数名で使用できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span>{
  <span class="tok-k">my</span> <span class="tok-nb">Str</span> <span class="tok-nv">$var</span> = <span class="tok-s">&#39;Text&#39;</span>;
  <span class="tok-nb">say</span> <span class="tok-nv">$var</span>;
}
<span class="tok-k">my</span> <span class="tok-nb">Int</span> <span class="tok-nv">$var</span> = <span class="tok-mi">123</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var</span>;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_代入と束縛">3.7. 代入と束縛</h3>
<div class="paragraph">
<p>前節の例では、どうやって変数に値を <strong>代入</strong> するかをみてきました。<br>
<strong>代入</strong> は <code>=</code> 演算子を用いて行われます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nb">Int</span> <span class="tok-nv">$var</span> = <span class="tok-mi">123</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>変数に代入された値は変更することができます:</p>
</div>
<div class="listingblock">
<div class="title">代入</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nb">Int</span> <span class="tok-nv">$var</span> = <span class="tok-mi">123</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var</span>;
<span class="tok-nv">$var</span> = <span class="tok-mi">999</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><code>出力</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-mi">123</span>
<span class="tok-mi">999</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>一方、変数に <strong>束縛</strong> された値は変えることはできません。<br>
<strong>束縛</strong> は <code>:=</code> 演算子を用いて行われます。</p>
</div>
<div class="listingblock">
<div class="title">束縛</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nb">Int</span> <span class="tok-nv">$var</span> := <span class="tok-mi">123</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var</span>;
<span class="tok-nv">$var</span> = <span class="tok-mi">999</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><code>出力</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-mi">123</span>
<span class="tok-n">Cannot</span> <span class="tok-n">assign</span> <span class="tok-nb">to</span> <span class="tok-n">an</span> <span class="tok-n">immutable</span> <span class="tok-nb">value</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">変数はほかの変数により束縛することができます:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$a</span>;
<span class="tok-k">my</span> <span class="tok-nv">$b</span>;
<span class="tok-nv">$b</span> := <span class="tok-nv">$a</span>;
<span class="tok-nv">$a</span> = <span class="tok-mi">7</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$b</span>;
<span class="tok-nv">$b</span> = <span class="tok-mi">8</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$a</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><code>出力</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-mi">7</span>
<span class="tok-mi">8</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>束縛変数は双方向性をもっています。<br>
<code>$a := $b</code> と <code>$b := $a</code> は同じ効果を持っています。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
もし変数に関する情報をもっと知りたいのであれば、次のURLを参照することをすすめます <a href="https://docs.raku.org/type/variables" class="bare">https://docs.raku.org/type/variables</a>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_関数とミューテータ">4. 関数とミューテータ</h2>
<div class="sectionbody">
<div class="paragraph">
<p>関数とミューテータを区別することは重要です。<br>
関数はそれが呼ばれたときのオブジェクトの状態を変更しません。<br>
ミューテータはオブジェクトの状態を変更します。</p>
</div>
<div class="listingblock">
<div class="title"><code>スクリプト</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><div class="lineno"><table class="linenotable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><span class="tok-k">my</span> <span class="tok-nv">@numbers</span> = [<span class="tok-mi">7</span>,<span class="tok-mi">2</span>,<span class="tok-mi">4</span>,<span class="tok-mi">9</span>,<span class="tok-mi">11</span>,<span class="tok-mi">3</span>];

<span class="tok-nv">@numbers</span>.<span class="tok-nb">push</span>(<span class="tok-mi">99</span>);
<span class="tok-nb">say</span> <span class="tok-nv">@numbers</span>;      <span class="tok-c1">#1</span>

<span class="tok-nb">say</span> <span class="tok-nv">@numbers</span>.<span class="tok-nb">sort</span>; <span class="tok-c1">#2</span>
<span class="tok-nb">say</span> <span class="tok-nv">@numbers</span>;      <span class="tok-c1">#3</span>

<span class="tok-nv">@numbers</span>.=<span class="tok-nb">sort</span>;
<span class="tok-nb">say</span> <span class="tok-nv">@numbers</span>;      <span class="tok-c1">#4</span>
</pre></div></td></tr></table></div></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><code>出力</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span>[<span class="tok-mi">7</span> <span class="tok-mi">2</span> <span class="tok-mi">4</span> <span class="tok-mi">9</span> <span class="tok-mi">11</span> <span class="tok-mi">3</span> <span class="tok-mi">99</span>] <span class="tok-c1">#1</span>
(<span class="tok-mi">2</span> <span class="tok-mi">3</span> <span class="tok-mi">4</span> <span class="tok-mi">7</span> <span class="tok-mi">9</span> <span class="tok-mi">11</span> <span class="tok-mi">99</span>) <span class="tok-c1">#2</span>
[<span class="tok-mi">7</span> <span class="tok-mi">2</span> <span class="tok-mi">4</span> <span class="tok-mi">9</span> <span class="tok-mi">11</span> <span class="tok-mi">3</span> <span class="tok-mi">99</span>] <span class="tok-c1">#3</span>
[<span class="tok-mi">2</span> <span class="tok-mi">3</span> <span class="tok-mi">4</span> <span class="tok-mi">7</span> <span class="tok-mi">9</span> <span class="tok-mi">11</span> <span class="tok-mi">99</span>] <span class="tok-c1">#4</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Explanation</div>
<p><code>.push</code> はミューテータです。配列の状態を変更します。 (#1)</p>
</div>
<div class="paragraph">
<p><code>.sort</code> は関数です。ソートされた配列を返しますが、配列の初期状態を変更するわけではありません。:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>(#2) はソートされた配列が返されたことを示しています。</p>
</li>
<li>
<p>(#3) は元々の配列は変更されていないことを示しています。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>関数にミューテータとしてふるまうように強制するために <code>.</code> のかわりに <code>.=</code> を使っています。(#4) (スクリプトの9行目)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ループと条件文">5. ループと条件文</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Rakuは多数の条件文とループ構文を持っています。</p>
</div>
<div class="sect2">
<h3 id="_if">5.1. if</h3>
<div class="paragraph">
<p>条件が満たされた時、つまり式が <code>True</code> と評価された時だけコードが実行されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$age</span> = <span class="tok-mi">19</span>;

<span class="tok-k">if</span> <span class="tok-nv">$age</span> &gt; <span class="tok-mi">18</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&#39;Welcome&#39;</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Rakuでは、コードと条件は反転することができます。<br>
コードと条件が反転されていたとしても、いつも先に条件が評価されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$age</span> = <span class="tok-mi">19</span>;

<span class="tok-nb">say</span> <span class="tok-s">&#39;Welcome&#39;</span> <span class="tok-k">if</span> <span class="tok-nv">$age</span> &gt; <span class="tok-mi">18</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>もし条件が満たされないなら、下記を使って、別のブロックを実行するように指定することができます:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>else</code></p>
</li>
<li>
<p><code>elsif</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-c1"># 変数の値を変えて同じコードを実行</span>
<span class="tok-k">my</span> <span class="tok-nv">$number-of-seats</span> = <span class="tok-mi">9</span>;

<span class="tok-k">if</span> <span class="tok-nv">$number-of-seats</span> &lt;= <span class="tok-mi">5</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&#39;I am a sedan&#39;</span>
} <span class="tok-k">elsif</span> <span class="tok-nv">$number-of-seats</span> &lt;= <span class="tok-mi">7</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&#39;I am 7 seater&#39;</span>
} <span class="tok-k">else</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&#39;I am a van&#39;</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_unless">5.2. unless</h3>
<div class="paragraph">
<p><code>unless</code> を使えば、if命令の否定版を書くことができます。</p>
</div>
<div class="paragraph">
<p>次のコード:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$clean-shoes</span> = <span class="tok-nb">False</span>;

<span class="tok-k">if</span> <span class="tok-nb">not</span> <span class="tok-nv">$clean-shoes</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&#39;Clean your shoes&#39;</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>は次のように書くことができます:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$clean-shoes</span> = <span class="tok-nb">False</span>;

<span class="tok-k">unless</span> <span class="tok-nv">$clean-shoes</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&#39;Clean your shoes&#39;</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Rakuでの否定は <code>!</code> か <code>not</code> を使って行われます。</p>
</div>
<div class="paragraph">
<p><code>unless (condition)</code> は <code>if not (condition)</code> のかわりに用いられます。</p>
</div>
<div class="paragraph">
<p><code>unless</code> は <code>else</code> 節を持つことができません。</p>
</div>
</div>
<div class="sect2">
<h3 id="_with">5.3. with</h3>
<div class="paragraph">
<p><code>with</code> は <code>if</code> 命令のようにふるまいます。しかし変数が定義されているかどうかを調べます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nb">Int</span> <span class="tok-nv">$var</span>=<span class="tok-mi">1</span>;

<span class="tok-k">with</span> <span class="tok-nv">$var</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&#39;Hello&#39;</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>変数に対して値を代入しないでコードを実行した場合何も起こらないでしょう。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nb">Int</span> <span class="tok-nv">$var</span>;

<span class="tok-k">with</span> <span class="tok-nv">$var</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&#39;Hello&#39;</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>without</code> は <code>with</code> の否定版です。 <code>unless</code> と関連づけて覚えておくとよいでしょう。</p>
</div>
<div class="paragraph">
<p>もしはじめの <code>with</code> 条件が満たされないなら、 <code>orwith</code> を使って代替となるパスを指定することができます。<br>
<code>with</code> と <code>orwith</code> の関係性は <code>if</code> と <code>elsif</code> の関係性にたとえることができます。</p>
</div>
</div>
<div class="sect2">
<h3 id="_for">5.4. for</h3>
<div class="paragraph">
<p><code>for</code> ループは複数の値に対する反復処理を行うことができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@array</span> = <span class="tok-mi">1</span>,<span class="tok-mi">2</span>,<span class="tok-mi">3</span>;

<span class="tok-k">for</span> <span class="tok-nv">@array</span> -&gt; <span class="tok-nv">$array-item</span> {
  <span class="tok-nb">say</span> <span class="tok-nv">$array-item</span> * <span class="tok-mi">100</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>反復変数 <code>$array-item</code> を作り、配列のそれぞれの要素に対して <code>*100</code> の操作を行ったことに注目してください。</p>
</div>
</div>
<div class="sect2">
<h3 id="_given">5.5. given</h3>
<div class="paragraph">
<p><code>given</code> は他の言語においてswitch命令と呼ばれているものと等価なRakuの命令です。
しかし、他の言語よりも強力です。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$var</span> = <span class="tok-mi">42</span>;

<span class="tok-k">given</span> <span class="tok-nv">$var</span> {
    <span class="tok-k">when</span> <span class="tok-mi">0</span><span class="tok-o">..</span><span class="tok-mi">50</span> { <span class="tok-nb">say</span> <span class="tok-s">&#39;Less than or equal to 50&#39;</span>}
    <span class="tok-k">when</span> <span class="tok-nb">Int</span> { <span class="tok-nb">say</span> <span class="tok-s">&quot;is an Int&quot;</span> }
    <span class="tok-k">when</span> <span class="tok-mi">42</span>  { <span class="tok-nb">say</span> <span class="tok-mi">42</span> }
    <span class="tok-k">default</span>  { <span class="tok-nb">say</span> <span class="tok-s">&quot;huh?&quot;</span> }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>条件が満たされると、条件が満たされるかどうか調べる処理は止まります。</p>
</div>
<div class="paragraph">
<p>別の選択肢として、 <code>proceed</code> を使うと、Rakuは条件が満たされた後も、この調べる処理の実行を続けます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$var</span> = <span class="tok-mi">42</span>;

<span class="tok-k">given</span> <span class="tok-nv">$var</span> {
    <span class="tok-k">when</span> <span class="tok-mi">0</span><span class="tok-o">..</span><span class="tok-mi">50</span> { <span class="tok-nb">say</span> <span class="tok-s">&#39;Less than or equal to 50&#39;</span>;<span class="tok-k">proceed</span>}
    <span class="tok-k">when</span> <span class="tok-nb">Int</span> { <span class="tok-nb">say</span> <span class="tok-s">&quot;is an Int&quot;</span>;<span class="tok-k">proceed</span>}
    <span class="tok-k">when</span> <span class="tok-mi">42</span>  { <span class="tok-nb">say</span> <span class="tok-mi">42</span> }
    <span class="tok-k">default</span>  { <span class="tok-nb">say</span> <span class="tok-s">&quot;huh?&quot;</span> }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_loop">5.6. loop</h3>
<div class="paragraph">
<p><code>loop</code> は <code>for</code> を書くための別の選択肢です。</p>
</div>
<div class="paragraph">
<p>実際に、 <code>loop</code> はC言語族において書かれる <code>for</code> と同じです。</p>
</div>
<div class="paragraph">
<p>RakuはC言語族の一員なのです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">loop</span> (<span class="tok-k">my</span> <span class="tok-nv">$i</span> = <span class="tok-mi">0</span>; <span class="tok-nv">$i</span> &lt; <span class="tok-mi">5</span>; <span class="tok-nv">$i</span>++) {
  <span class="tok-nb">say</span> <span class="tok-s">&quot;The current number is $i&quot;</span>
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
もしループ構文と条件文に関する情報をもっと知りたいのであれば、次のURLを参照することをすすめます <a href="https://docs.raku.org/language/control" class="bare">https://docs.raku.org/language/control</a>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_io">6. I/O</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Rakuにおいて、二つの最も一般的な <em>入力/出力</em> のインタフェースは <em>ターミナル</em> と <em>ファイル</em> です。</p>
</div>
<div class="sect2">
<h3 id="_ターミナルを用いた基本的なio">6.1. ターミナルを用いた基本的なI/O</h3>
<div class="sect3">
<h4 id="_say">6.1.1. say</h4>
<div class="paragraph">
<p><code>say</code> は標準出力に対する書き込みを行います。その最後に改行を付加します。つまり、次のようなコードは:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-nb">say</span> <span class="tok-s">&#39;Hello Mam.&#39;</span>;
<span class="tok-nb">say</span> <span class="tok-s">&#39;Hello Sir.&#39;</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>二つの行に分かれて書き込まれることになります。</p>
</div>
</div>
<div class="sect3">
<h4 id="_print">6.1.2. print</h4>
<div class="paragraph">
<p>一方、 <code>print</code> は <code>say</code> のようにふるまいますが、改行を付加しないという違いがあります。</p>
</div>
<div class="paragraph">
<p><code>say</code> を <code>print</code> で置き換えてみて結果を比べてみましょう。</p>
</div>
</div>
<div class="sect3">
<h4 id="_get">6.1.3. get</h4>
<div class="paragraph">
<p><code>get</code> はターミナルからの入力を取得するために使われます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$name</span>;

<span class="tok-nb">say</span> <span class="tok-s">&quot;Hi, what&#39;s your name?&quot;</span>;
<span class="tok-nv">$name</span> = <span class="tok-nb">get</span>;

<span class="tok-nb">say</span> <span class="tok-s">&quot;Dear $name welcome to Raku&quot;</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>上記のコードが実行されると、ターミナルは、あなたが名前を入力するのを待つようになります。名前を打って [Enter] を押しましょう。
その後、あいさつをしてくれるでしょう。</p>
</div>
</div>
<div class="sect3">
<h4 id="_prompt">6.1.4. prompt</h4>
<div class="paragraph">
<p><code>prompt</code> は <code>print</code> と <code>get</code> の組み合わせです。</p>
</div>
<div class="paragraph">
<p>上の例は次のように書くことができます:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$name</span> = <span class="tok-nb">prompt</span> <span class="tok-s">&quot;Hi, what&#39;s your name? &quot;</span>;

<span class="tok-nb">say</span> <span class="tok-s">&quot;Dear $name welcome to Raku&quot;</span>;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_シェルコマンドの実行">6.2. シェルコマンドの実行</h3>
<div class="paragraph">
<p>二つのサブルーチンをシェルコマンドを実行するために使うことができます:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>run</code> シェルを介在せずに外部コマンドを実行します</p>
</li>
<li>
<p><code>shell</code> システムシェルを通じてコマンドを実行します。プラットフォームとシェル依存です。
すべてのシェルのメタ文字はシェルによって解釈されます。これには、パイプ、リダイレクト、ユーザー環境変数などが含まれます。</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">もし Linux/macOS 環境にいるなら、次のコードを実行してください。</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$name</span> = <span class="tok-s">&#39;Neo&#39;</span>;
<span class="tok-nb">run</span> <span class="tok-s">&#39;echo&#39;</span>, <span class="tok-s">&quot;hello $name&quot;</span>;
<span class="tok-nb">shell</span> <span class="tok-s">&quot;ls&quot;</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">もし Windows 環境にいるなら、次のコードを実行してください。</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-nb">shell</span> <span class="tok-s">&quot;dir&quot;</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>echo</code> と <code>ls</code> はLinuxにおける一般的なシェルのキーワードです。:<br>
<code>echo</code> はターミナルにテキストを出力します。 (Rakuにおける <code>say</code> と等価です。)<br>
<code>ls</code> はカレントディレクトリのすべてのファイルとフォルダを表示します。</p>
</div>
<div class="paragraph">
<p><code>dir</code> はWindowsにおける <code>ls</code> と等価なキーワードです。</p>
</div>
</div>
<div class="sect2">
<h3 id="_ファイル_io">6.3. ファイル I/O</h3>
<div class="sect3">
<h4 id="_slurp">6.3.1. slurp</h4>
<div class="paragraph">
<p><code>slurp</code> はファイルからデータを読み込むために使われます。</p>
</div>
<div class="paragraph">
<p>次のような内容のテキストファイルを作ってください:</p>
</div>
<div class="listingblock">
<div class="title">datafile.txt</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-n">John</span> <span class="tok-mi">9</span>
<span class="tok-n">Johnnie</span> <span class="tok-mi">7</span>
<span class="tok-n">Jane</span> <span class="tok-mi">8</span>
<span class="tok-n">Joanna</span> <span class="tok-mi">7</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$data</span> = <span class="tok-nb">slurp</span> <span class="tok-s">&quot;datafile.txt&quot;</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$data</span>;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_spurt">6.3.2. spurt</h4>
<div class="paragraph">
<p><code>spurt</code> はデータをファイルに書き込むために使われます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$newdata</span> = <span class="tok-s">&quot;New scores:</span>
<span class="tok-s">Paul 10</span>
<span class="tok-s">Paulie 9</span>
<span class="tok-s">Paulo 11&quot;</span>;

<span class="tok-nb">spurt</span> <span class="tok-s">&quot;newdatafile.txt&quot;</span>, <span class="tok-nv">$newdata</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>上記のコードの実行後、 <em>newdatafile.txt</em> という名前の新しいファイルが作られるはずです。
このファイルは新しいスコアを含んでいるでしょう。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ファイルとディレクトリの操作">6.4. ファイルとディレクトリの操作</h3>
<div class="paragraph">
<p>Rakuはシェルコマンドに頼らなくてもディレクトリの内容を表示することができます( シェルコマンドの例としては <code>ls</code> が挙げられます )。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-nb">say</span> <span class="tok-nb">dir</span>;              <span class="tok-c1"># カレントディレクトリのファイルとフォルダを表示する</span>
<span class="tok-nb">say</span> <span class="tok-nb">dir</span> <span class="tok-s">&quot;/Documents&quot;</span>; <span class="tok-c1"># 指定されたディレクトリのファイルとフォルダを表示する</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>加えて、新しいディレクトリを作ったり削除したりすることもできます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-nb">mkdir</span> <span class="tok-s">&quot;newfolder&quot;</span>;
<span class="tok-nb">rmdir</span> <span class="tok-s">&quot;newfolder&quot;</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>mkdir</code> は新しいディレクトリをつくります<br>
<code>rmdir</code> は空のディレクトリを削除し、もし空でないのならエラーを返します。</p>
</div>
<div class="paragraph">
<p>ファイルかディレクトリであれば、パスが存在するかどうか確かめることもできます。:</p>
</div>
<div class="paragraph">
<p>下記のスクリプトを実行するディレクトリで、 <code>folder123</code> という空のフォルダと <code>script123.raku</code> という空のrakuファイルを生成してください。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-nb">say</span> <span class="tok-s">&quot;script123.raku&quot;</span>.<span class="tok-nb">IO</span>.<span class="tok-nb">e</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;folder123&quot;</span>.<span class="tok-nb">IO</span>.<span class="tok-nb">e</span>;

<span class="tok-nb">say</span> <span class="tok-s">&quot;script123.raku&quot;</span>.<span class="tok-nb">IO</span>.<span class="tok-nb">d</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;folder123&quot;</span>.<span class="tok-nb">IO</span>.<span class="tok-nb">d</span>;

<span class="tok-nb">say</span> <span class="tok-s">&quot;script123.raku&quot;</span>.<span class="tok-nb">IO</span>.<span class="tok-nb">f</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;folder123&quot;</span>.<span class="tok-nb">IO</span>.<span class="tok-nb">f</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>IO.e</code> はディレクトリ/ファイルが存在するかどうか調べます。<br>
<code>IO.f</code> はパスがファイルかどうか調べます。<br>
<code>IO.d</code> はパスがディレクトリかどうか調べます。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Windowsのユーザーはディレクトリを定義するために <code>/</code> か <code>\\</code> を使うことができます<br>
<code>C:\\rakudo\\bin</code><br>
<code>C:/rakudo/bin</code><br>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
もしI/Oに関する情報をもっと知りたいのであれば、次のURLを参照することをすすめます <a href="https://docs.raku.org/type/IO" class="bare">https://docs.raku.org/type/IO</a>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_サブルーチン">7. サブルーチン</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_定義">7.1. 定義</h3>
<div class="paragraph">
<p><strong>サブルーチン</strong> (<strong>サブ</strong> や <strong>関数</strong> とも呼ばれます) は機能のパッケージングと再利用の手段です<br></p>
</div>
<div class="paragraph">
<p>サブルーチンの定義は <code>sub</code> というキーワードから始まります。定義の後、つけた名前を使って呼び出すことができます。<br>
下記の例をよく見てください:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">sub</span> <span class="tok-n">alien-greeting</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&quot;Hello earthlings&quot;</span>;
}

<span class="tok-n">alien-greeting</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>先ほどの例では、入力を必要としないサブルーチンを紹介しました。</p>
</div>
</div>
<div class="sect2">
<h3 id="_シグネチャ">7.2. シグネチャ</h3>
<div class="paragraph">
<p>サブルーチンは入力を必要とする場合があります。この時の入力は <strong>引数</strong> によって与えられます。
サブルーチンはゼロかそれ以上の <strong>パラメータ</strong> を定義します。
サブルーチンが定義するパラメータの数と型は <strong>シグネチャ</strong> と呼ばれています。</p>
</div>
<div class="paragraph">
<p>下記のサブルーチンは引数として文字列を受け取っています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">sub</span> <span class="tok-n">say-hello</span> (<span class="tok-nb">Str</span> <span class="tok-nv">$name</span>) {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;Hello &quot;</span> ~ <span class="tok-nv">$name</span> ~ <span class="tok-s">&quot;!!!!&quot;</span>
}
<span class="tok-n">say-hello</span> <span class="tok-s">&quot;Paul&quot;</span>;
<span class="tok-n">say-hello</span> <span class="tok-s">&quot;Paula&quot;</span>;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_多重ディスパッチ">7.3. 多重ディスパッチ</h3>
<div class="paragraph">
<p>同じ名前を持っているが異なったシグネチャを持つように複数のサブルーチンを定義することができます。
サブルーチンが呼ばれると、ランタイム環境は与えられた引数の数と型をもとにしてどれを使うべきであるか決定します。
このタイプのサブルーチンは普通のサブルーチンと同じように定義できます。ただし、このとき <code>sub</code> のかわりに <code>multi</code> というキーワードを用います。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">multi</span> <span class="tok-n">greet</span>(<span class="tok-nv">$name</span>) {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;Good morning $name&quot;</span>;
}
<span class="tok-k">multi</span> <span class="tok-n">greet</span>(<span class="tok-nv">$name</span>, <span class="tok-nv">$title</span>) {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;Good morning $title $name&quot;</span>;
}

<span class="tok-n">greet</span> <span class="tok-s">&quot;Johnnie&quot;</span>;
<span class="tok-n">greet</span> <span class="tok-s">&quot;Laura&quot;</span>,<span class="tok-s">&quot;Mrs.&quot;</span>;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_デフォルトパラメータとオプションパラメータ">7.4. デフォルトパラメータとオプションパラメータ</h3>
<div class="paragraph">
<p>もしサブルーチンが一つの引数を受け取るように定義されていて、必要となる引数が与えられずに呼び出されたのなら、このサブルーチンの実行は失敗します。</p>
</div>
<div class="paragraph">
<p>Rakuでは次のような引数をともなったサブルーチンを定義することができます:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>オプションパラメータ</p>
</li>
<li>
<p>デフォルトパラメータ</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>オプションパラメータはパラメータの名前に対して <code>?</code> を付加することで定義できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">sub</span> <span class="tok-n">say-hello</span>(<span class="tok-nv">$name</span>?) {
  <span class="tok-k">with</span> <span class="tok-nv">$name</span> { <span class="tok-nb">say</span> <span class="tok-s">&quot;Hello &quot;</span> ~ <span class="tok-nv">$name</span> }
  <span class="tok-k">else</span> { <span class="tok-nb">say</span> <span class="tok-s">&quot;Hello Human&quot;</span> }
}
<span class="tok-n">say-hello</span>;
<span class="tok-n">say-hello</span>(<span class="tok-s">&quot;Laura&quot;</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>もしユーザーが引数を与える必要がないのであれば、デフォルト値を定義することができます。<br>
これは、サブルーチンの定義内でパラメータに対して値を代入することで行うことができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">sub</span> <span class="tok-n">say-hello</span>(<span class="tok-nv">$name</span>=<span class="tok-s">&quot;Matt&quot;</span>) {
  <span class="tok-nb">say</span> <span class="tok-s">&quot;Hello &quot;</span> ~ <span class="tok-nv">$name</span>;
}
<span class="tok-n">say-hello</span>;
<span class="tok-n">say-hello</span>(<span class="tok-s">&quot;Laura&quot;</span>);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_値の返却">7.5. 値の返却</h3>
<div class="paragraph">
<p>今まで見てきたすべてのサブルーチンは、ターミナルにテキストを出力するといった具合に <strong>何かをするもの</strong> でした 。
でも時には、プログラムの後段の処理で利用できるような何らかの値を <strong>返して</strong> もらうためにサブルーチンを実行することもあるでしょう。</p>
</div>
<div class="paragraph">
<p>もし関数がそのブロックの最後まで実行されるなら、最後の文や式が返り値を決定するでしょう。</p>
</div>
<div class="listingblock">
<div class="title">暗黙的な返却</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">sub</span> <span class="tok-n">squared</span> (<span class="tok-nv">$x</span>) {
  <span class="tok-nv">$x</span> ** <span class="tok-mi">2</span>;
}
<span class="tok-nb">say</span> <span class="tok-s">&quot;7 squared is equal to &quot;</span> ~ <span class="tok-n">squared</span>(<span class="tok-mi">7</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>コードが大きくなってしまったなら <em>明示的に</em> 何を返そうとしているのかを指定することは良い対処法かもしれません。
<code>return</code> キーワードを用いることでこれを行うことができます。</p>
</div>
<div class="listingblock">
<div class="title">明示的な返却</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">sub</span> <span class="tok-n">squared</span> (<span class="tok-nv">$x</span>) {
  <span class="tok-k">return</span> <span class="tok-nv">$x</span> ** <span class="tok-mi">2</span>;
}
<span class="tok-nb">say</span> <span class="tok-s">&quot;7 squared is equal to &quot;</span> ~ <span class="tok-n">squared</span>(<span class="tok-mi">7</span>);</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_返り値の制限">7.5.1. 返り値の制限</h4>
<div class="paragraph">
<p>以前の例の一つでは、どうやって引数の受け取る型をある型に制限するかについて見ました。
同じことを返り値でも行うことができます。</p>
</div>
<div class="paragraph">
<p>返り値をある型に制限するには、矢印記号 <code>--&gt;</code> をシグネチャで使ってください。</p>
</div>
<div class="listingblock">
<div class="title">返り値の型を示す</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">sub</span> <span class="tok-n">squared</span> (<span class="tok-nv">$x</span> --&gt; <span class="tok-nb">Int</span>) {
  <span class="tok-k">return</span> <span class="tok-nv">$x</span> ** <span class="tok-mi">2</span>;
}
<span class="tok-nb">say</span> <span class="tok-s">&quot;1.2 squared is equal to &quot;</span> ~ <span class="tok-n">squared</span>(<span class="tok-mf">1.2</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>もし、型の制限にマッチする返り値を渡しそびれてしまったなら、エラーが投げられるでしょう。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-n">Type</span> <span class="tok-n">check</span> <span class="tok-n">failed</span> <span class="tok-k">for</span> <span class="tok-k">return</span> <span class="tok-nb">value</span>; <span class="tok-nb">expected</span> <span class="tok-nb">Int</span> <span class="tok-k">but</span> <span class="tok-nb">got</span> <span class="tok-nb">Rat</span> (<span class="tok-mf">1.44</span>)</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>型の制限は返り値の型を指定できるだけではなく; 定義済みか否かも指定することができます。</p>
</div>
<div class="paragraph">
<p>以前の例では、返り値は <code>Int</code> であると指定しました。
次のようなシグネチャを使って返り値の <code>Int</code> が厳密に定義されているべきか否かを指定することもできます。:</p>
</div>
<div class="paragraph">
<p><code>-&#8594; Int:D</code> and <code>-&#8594; Int:U</code></p>
</div>
<div class="paragraph">
<p>それはそれとして、これらの型の制限をつかうことはとても実用的です。<br>
下記は以前の例の修正版です。返り値の <code>Int</code> が定義されているように強制するために <code>:D</code> を使っています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">sub</span> <span class="tok-n">squared</span> (<span class="tok-nv">$x</span> --&gt; <span class="tok-nb">Int:D</span>) {
  <span class="tok-k">return</span> <span class="tok-nv">$x</span> ** <span class="tok-mi">2</span>;
}
<span class="tok-nb">say</span> <span class="tok-s">&quot;1.2 squared is equal to &quot;</span> ~ <span class="tok-n">squared</span>(<span class="tok-mf">1.2</span>);</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
もしサブルーチンと関数に関する情報をもっと知りたいのであれば、次のURLを参照することをすすめます <a href="https://docs.raku.org/language/functions" class="bare">https://docs.raku.org/language/functions</a>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_関数型プログラミング">8. 関数型プログラミング</h2>
<div class="sectionbody">
<div class="paragraph">
<p>この章では関数型プログラミングを容易にしてくれるいくつかの機能を見ていこうと思います。</p>
</div>
<div class="sect2">
<h3 id="_関数は第一級オブジェクト">8.1. 関数は第一級オブジェクト</h3>
<div class="paragraph">
<p>関数/サブルーチンは第一級オブジェクトです:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>引数として用いることができます</p>
</li>
<li>
<p>別の関数から返すことができます</p>
</li>
<li>
<p>変数に代入することができます</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>この概念を説明するためのよい例は <code>map</code> 関数です。<br>
<code>map</code> は <em>高階関数</em> です。ほかの関数を引数として受け取ることができます。</p>
</div>
<div class="listingblock">
<div class="title">スクリプト</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@array</span> = <span class="tok-s">&lt;1 2 3 4 5&gt;</span>;
<span class="tok-k">sub</span> <span class="tok-n">squared</span>(<span class="tok-nv">$x</span>) {
  <span class="tok-nv">$x</span> ** <span class="tok-mi">2</span>
}
<span class="tok-nb">say</span> <span class="tok-n">map</span>(<span class="tok-nv">&amp;squared</span>,<span class="tok-nv">@array</span>);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">出力</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span>(<span class="tok-mi">1</span> <span class="tok-mi">4</span> <span class="tok-mi">9</span> <span class="tok-mi">16</span> <span class="tok-mi">25</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">説明</div>
<p>まず <code>squared</code> と呼ばれるサブルーチンを定義しました。このサブルーチンは引数として与えられた値を二乗します。
次に、高階関数である <code>map</code> に対して、このサブルーチンと配列の二つの引数を与えます。
結果は、配列の各要素の平方のリストとなります。</p>
</div>
<div class="paragraph">
<p>引数としてサブルーチンを用いるときはその名前の前に <code>&amp;</code> をつけなければならないことに注意してください。</p>
</div>
</div>
<div class="sect2">
<h3 id="_無名関数">8.2. 無名関数</h3>
<div class="paragraph">
<p><strong>無名関数</strong> は <strong>ラムダ</strong> とも呼ばれています。<br></p>
</div>
<div class="paragraph">
<p>無名関数は識別子に束縛されません。(名前をもっていないため）</p>
</div>
<div class="paragraph">
<p><code>map</code> の例を書き換えて無名関数を使うようにしましょう</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@array</span> = <span class="tok-s">&lt;1 2 3 4 5&gt;</span>;
<span class="tok-nb">say</span> <span class="tok-n">map</span>(-&gt; <span class="tok-nv">$x</span> {<span class="tok-nv">$x</span> ** <span class="tok-mi">2</span>},<span class="tok-nv">@array</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>サブルーチンを宣言して <code>map</code> の引数として渡す代わりに、 <code>map</code> の中で直接定義していることに注意してください。<br>
無名関数の中で <code>-&gt; $x {$x ** 2}</code> のように定義しています。</p>
</div>
<div class="paragraph">
<p>Rakuではこのような使われ方の無名関数を <strong>ポインティブロック</strong> と呼びます。</p>
</div>
<div class="listingblock">
<div class="title">ポインティブロックは関数を変数に代入するときにも使われます:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$squared</span> = -&gt; <span class="tok-nv">$x</span> {
  <span class="tok-nv">$x</span> ** <span class="tok-mi">2</span>
}
<span class="tok-nb">say</span> <span class="tok-nv">$squared</span>(<span class="tok-mi">9</span>);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_チェイン">8.3. チェイン</h3>
<div class="paragraph">
<p>Rakuでは、メソッドはチェインすることができます。メソッドの結果を引数としてほかのメソッドに渡す必要はありません。</p>
</div>
<div class="paragraph">
<p>例題: 配列が与えられているとして、値の重複が無いように降順にソートしてください。<br>
これはチェインを使わなかった場合の解答です:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@array</span> = <span class="tok-s">&lt;7 8 9 0 1 2 4 3 5 6 7 8 9&gt;</span>;
<span class="tok-k">my</span> <span class="tok-nv">@final-array</span> = <span class="tok-nb">reverse</span>(<span class="tok-nb">sort</span>(<span class="tok-nb">unique</span>(<span class="tok-nv">@array</span>)));
<span class="tok-nb">say</span> <span class="tok-nv">@final-array</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>この例では <code>@array</code> に対して <code>unique</code> 関数を呼び、その結果を <code>sort</code> の引数として渡します。さらにそのソートした結果を <code>reverse</code> に渡します。</p>
</div>
<div class="paragraph">
<p>対照的に、上記の例は <strong>メソッドチェイン</strong> を利用して、次のように書くことができます。:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@array</span> = <span class="tok-s">&lt;7 8 9 0 1 2 4 3 5 6 7 8 9&gt;</span>;
<span class="tok-k">my</span> <span class="tok-nv">@final-array</span> = <span class="tok-nv">@array</span>.<span class="tok-nb">unique</span>.<span class="tok-nb">sort</span>.<span class="tok-nb">reverse</span>;
<span class="tok-nb">say</span> <span class="tok-nv">@final-array</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>メソッドチェインは <em>見た目が良い</em> ということが一目瞭然ですね。</p>
</div>
</div>
<div class="sect2">
<h3 id="_フィード演算子">8.4. フィード演算子</h3>
<div class="paragraph">
<p><strong>フィード演算子</strong> は、関数型言語では <em>パイプ</em> と呼ばれ、メソッドチェインをさらに分かりやすくしてくれます。</p>
</div>
<div class="listingblock">
<div class="title">前方フィード</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@array</span> = <span class="tok-s">&lt;7 8 9 0 1 2 4 3 5 6 7 8 9&gt;</span>;
<span class="tok-nv">@array</span> ==&gt; <span class="tok-nb">unique</span>()
       ==&gt; <span class="tok-nb">sort</span>()
       ==&gt; <span class="tok-nb">reverse</span>()
       ==&gt; <span class="tok-k">my</span> <span class="tok-nv">@final-array</span>;
<span class="tok-nb">say</span> <span class="tok-nv">@final-array</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">説明</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-n">まず</span> `<span class="tok-nv">@array</span>`<span class="tok-n">で始まり</span> <span class="tok-n">次に重複のないリストを返します</span>
                      <span class="tok-n">次にソートします</span>
                      <span class="tok-n">次にリバースします</span>
                      <span class="tok-n">次に結果を</span> `<span class="tok-nv">@final-array</span>` <span class="tok-n">に格納します</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>メソッドの呼び出し順は、最初から最後のステップへのトップダウンであることに注目してください。</p>
</div>
<div class="listingblock">
<div class="title">後方フィード</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@array</span> = <span class="tok-s">&lt;7 8 9 0 1 2 4 3 5 6 7 8 9&gt;</span>;
<span class="tok-k">my</span> <span class="tok-nv">@final-array-v2</span> &lt;== <span class="tok-nb">reverse</span>()
                   &lt;== <span class="tok-nb">sort</span>()
                   &lt;== <span class="tok-nb">unique</span>()
                   &lt;== <span class="tok-nv">@array</span>;
<span class="tok-nb">say</span> <span class="tok-nv">@final-array-v2</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">説明</div>
<p>後方フィードは前方フィードに似ていますが、順序が逆です。<br>
メソッドの呼び出し順は、最後から最初のステップへのボトムアップであることに注目してください。</p>
</div>
</div>
<div class="sect2">
<h3 id="_ハイパー演算子">8.5. ハイパー演算子</h3>
<div class="paragraph">
<p><strong>ハイパー演算子</strong> <code>&gt;&gt;.</code> はリストの要素のすべてに対してメソッドの呼び出しを行い、その結果のリストを返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@array</span> = <span class="tok-s">&lt;0 1 2 3 4 5 6 7 8 9 10&gt;</span>;
<span class="tok-k">sub</span> <span class="tok-n">is-even</span>(<span class="tok-nv">$var</span>) { <span class="tok-nv">$var</span> %% <span class="tok-mi">2</span> };

<span class="tok-nb">say</span> <span class="tok-nv">@array</span>&gt;&gt;.<span class="tok-nb">is-prime</span>;
<span class="tok-nb">say</span> <span class="tok-nv">@array</span>&gt;&gt;.<span class="tok-nv">&amp;is-even</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>ハイパー演算子を用いることでRakuに組み込まれているメソッドを呼び出すこともできます。例えば、<code>is-prime</code> は数値が素数かそうでないかを判別する組み込みのメソッドです。
加えて、新しいサブルーチンを定義してハイパーオペレーターを使って呼び出すこともできます。この場合、 <code>&amp;</code> をメソッドの先頭に追加しなければなりません。 例えば、<code>&amp;is-even</code> といった具合です。</p>
</div>
<div class="paragraph">
<p>配列に対して反復処理を行うための <code>for</code> によるループを書くことから脱却することができ、とても実用的です。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Rakuは元の値の並びと結果の値の並びが同じになることを保証します。<br>
ただし、 Rakuがもとの並びと同じ順番や同じスレッドで実際にメソッドを呼び出しているという <strong>保証はない</strong> です。
そのため、副作用を持つメソッド、例えば <code>say</code> や <code>print</code> には注意してください。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_ジャンクション">8.6. ジャンクション</h3>
<div class="paragraph">
<p><strong>ジャンクション</strong> は値の論理的な重ね合わせです。</p>
</div>
<div class="paragraph">
<p>下記の例では <code>1|2|3</code> がジャンクションです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$var</span> = <span class="tok-mi">2</span>;
<span class="tok-k">if</span> <span class="tok-nv">$var</span> == <span class="tok-mi">1</span><span class="tok-o">|</span><span class="tok-mi">2</span><span class="tok-o">|</span><span class="tok-mi">3</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&quot;The variable is 1 or 2 or 3&quot;</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>ジャンクションの使用は通常は <strong>オートスレッディング</strong> のトリガーとなります。;
この演算はジャンクションの要素それぞれに対して実行され、すべての結果を結合した新たなジャンクションが生成され、それが返されます。</p>
</div>
</div>
<div class="sect2">
<h3 id="_遅延リスト">8.7. 遅延リスト</h3>
<div class="paragraph">
<p><strong>遅延リスト</strong> は遅延評価されるリストです。<br>
遅延評価とは、必要な時まで式の評価を遅らせ、ルックアップテーブルに結果を保存しておくことで不要な繰り返しの評価を避けるものです。</p>
</div>
<div class="paragraph">
<p>以下のような恩恵を含んでいます:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>不要な計算を避けることでパフォーマンスが向上する</p>
</li>
<li>
<p>潜在的には無限のデータ構造をつくることができる</p>
</li>
<li>
<p>制御フローを定義することができる</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>遅延リストをつくるためには接中辞演算子 <code>&#8230;&#8203;</code> を用います。<br>
遅延リストは、<strong>初期要素(複数可)</strong> 、<strong>ジェネレータ</strong> 、<strong>終点</strong> を持っています。</p>
</div>
<div class="listingblock">
<div class="title">シンプルな遅延リスト</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$lazylist</span> = (<span class="tok-mi">1</span> ... <span class="tok-mi">10</span>);
<span class="tok-nb">say</span> <span class="tok-nv">$lazylist</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>初期要素は1、終点は10です。ジェネレータは定義されていないので、デフォルトのジェネレータは次の値(+1)です<br>
つまり、この遅延リストは(もし要求されれば)、(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)という要素のリストを返すでしょう。</p>
</div>
<div class="listingblock">
<div class="title">無限遅延リスト</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$lazylist</span> = (<span class="tok-mi">1</span> ... <span class="tok-n">Inf</span>);
<span class="tok-nb">say</span> <span class="tok-nv">$lazylist</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>この遅延リストは(もし要求されれば)1から無限までの間のすべての整数、つまり任意の整数を返します。</p>
</div>
<div class="listingblock">
<div class="title">演繹的に作られたジェネレータによる遅延リスト</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$lazylist</span> = (<span class="tok-mi">0</span>,<span class="tok-mi">2</span> ... <span class="tok-mi">10</span>);
<span class="tok-nb">say</span> <span class="tok-nv">$lazylist</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>初期要素は0と2で終点は10です。
ジェネレータは定義されていませんが、初期要素を使ってRakuはジェネレータは(+2)であると演繹します。<br>
この遅延リストは(もし要求されれば)次のような要素を返します。(0, 2, 4, 6, 8, 10)</p>
</div>
<div class="listingblock">
<div class="title">定義されたジェネレータによる遅延リスト</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$lazylist</span> = (<span class="tok-mi">0</span>, { <span class="tok-nv">$_</span> + <span class="tok-mi">3</span> } ... <span class="tok-mi">12</span>);
<span class="tok-nb">say</span> <span class="tok-nv">$lazylist</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>この例では、明示的に <code>{ }</code> で囲まれたジェネレータを定義しています。<br>
この遅延リストは(もし要求されれば)次のような要素を返します。(0, 3, 6, 9, 12)</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>明示的なジェネレータを使うときは、終点はジェネレータが返すことのできるような値のひとつでなければなりません。<br>
もし、終点が10になっている上の例で、かわりに終点を12にしたら処理が止まらなくなります。
ジェネレータは終点を <em>ジャンプして超える</em> のです。</p>
</div>
<div class="paragraph">
<p>別の選択肢として、<code>0 &#8230;&#8203; 10</code> を <code>0 &#8230;&#8203;^ * &gt; 10</code> に置き換えることもできます<br>
このように読みます: 0から10を超えるような最初の値まで(10は除く)</p>
</div>
<div class="listingblock">
<div class="title">これではジェネレータは止まりません</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$lazylist</span> = (<span class="tok-mi">0</span>, { <span class="tok-nv">$_</span> + <span class="tok-mi">3</span> } ... <span class="tok-mi">10</span>);
<span class="tok-nb">say</span> <span class="tok-nv">$lazylist</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">これならジェネレータは止まります</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$lazylist</span> = (<span class="tok-mi">0</span>, { <span class="tok-nv">$_</span> + <span class="tok-mi">3</span> } ...^ * &gt; <span class="tok-mi">10</span>);
<span class="tok-nb">say</span> <span class="tok-nv">$lazylist</span>;</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_クロージャ">8.8. クロージャ</h3>
<div class="paragraph">
<p>RakuのすべてのCode型のオブジェクトはクロージャです。これは外のスコープのレキシカル変数を参照できるということを意味しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">sub</span> <span class="tok-n">generate-greeting</span> {
    <span class="tok-k">my</span> <span class="tok-nv">$name</span> = <span class="tok-s">&quot;John Doe&quot;</span>;
    <span class="tok-k">sub</span> <span class="tok-n">greeting</span> {
      <span class="tok-nb">say</span> <span class="tok-s">&quot;Good Morning $name&quot;</span>;
    };
    <span class="tok-k">return</span> <span class="tok-nv">&amp;greeting</span>;
}
<span class="tok-k">my</span> <span class="tok-nv">$generated</span> = <span class="tok-n">generate-greeting</span>;
<span class="tok-nv">$generated</span>();</code></pre>
</div>
</div>
<div class="paragraph">
<p>もし上記のコードを動かしたのなら、 <code>Good Morning John Doe</code> とターミナルに表示されたはずです。
非常に単純な結果でしたが、この例で面白いところは、中の <code>greeting</code> というサブルーチンが、それが実行される前に外のサブルーチンから返されているということです。</p>
</div>
<div class="paragraph">
<p><code>$generated</code> は <strong>クロージャ</strong> になったのです。</p>
</div>
<div class="paragraph">
<p><strong>クロージャ</strong> は二つのものを結びつけた特別な種類のオブジェクトです:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>サブルーチン</p>
</li>
<li>
<p>サブルーチンの生成された環境</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>環境は、そのクロージャが生成されたときにスコープ内にあったすべてのローカル変数で構成されています。
この場合、 <code>$generated</code> はサブルーチン <code>greeting</code> と文字列 <code>John Doe</code> の両方を結びつけたクロージャといえます。</p>
</div>
<div class="paragraph">
<p>では、もっと面白い例を見てみましょう。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">sub</span> <span class="tok-n">greeting-generator</span>(<span class="tok-nv">$period</span>) {
  <span class="tok-k">return</span> <span class="tok-k">sub</span> (<span class="tok-nv">$name</span>) {
    <span class="tok-k">return</span> <span class="tok-s">&quot;Good $period $name&quot;</span>
  }
}
<span class="tok-k">my</span> <span class="tok-nv">$morning</span> = <span class="tok-n">greeting-generator</span>(<span class="tok-s">&quot;Morning&quot;</span>);
<span class="tok-k">my</span> <span class="tok-nv">$evening</span> = <span class="tok-n">greeting-generator</span>(<span class="tok-s">&quot;Evening&quot;</span>);

<span class="tok-nb">say</span> <span class="tok-nv">$morning</span>(<span class="tok-s">&quot;John&quot;</span>);
<span class="tok-nb">say</span> <span class="tok-nv">$evening</span>(<span class="tok-s">&quot;Jane&quot;</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>この例では、<code>$period</code> というひとつの引数を受け取って新しいサブルーチンを返すような、サブルーチン <code>greeting-generator($period)</code> を定義しました。このサブルーチンが返す新しいサブルーチンは <code>$name</code> という引数を受け取り、そして作成されたあいさつを返します。</p>
</div>
<div class="paragraph">
<p>基本的に、<code>greeting-generator</code> はサブルーチンのファクトリです。この例では、我々は <code>greeting-generator</code> を二つの新しいサブルーチンを生成するために用いました。
ひとつは <code>Good Morning</code> とあいさつし、もうひとつは <code>Good Evening</code> とあいさつします。</p>
</div>
<div class="paragraph">
<p><code>$morning</code> と <code>$evening</code> は両方ともクロージャです。同じサブルーチン本体の定義を共有していますが、違う環境を保存しています。<br>
<code>$morning</code> の環境では <code>$period</code> は <code>Morning</code> です。
<code>$evening</code> の環境では <code>$period</code> は <code>Evening</code> です。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_クラスとオブジェクト">9. クラスとオブジェクト</h2>
<div class="sectionbody">
<div class="paragraph">
<p>前章では、どうやってRakuが関数型プログラミングを楽にしてくれるかについて学びました。<br>
この章ではRakuにおけるオブジェクト指向プログラミングについてみていきましょう。</p>
</div>
<div class="sect2">
<h3 id="_イントロダクション_2">9.1. イントロダクション</h3>
<div class="paragraph">
<p><em>オブジェクト指向</em> プログラミングは昨今広く使われているパラダイムの一つです。<br>
<strong>オブジェクト</strong> は一緒にバンドルされた変数やサブルーチンの集合です。<br>
変数は <strong>属性</strong> と呼ばれ、サブルーチンは <strong>メソッド</strong> とよばれます。<br>
属性はオブジェクトの <strong>状態</strong> を定義し、メソッドはオブジェクトの <strong>ふるまい</strong> を定義します。</p>
</div>
<div class="paragraph">
<p><strong>クラス</strong> は <strong>オブジェクト</strong> を作るための鋳型です。<br></p>
</div>
<div class="paragraph">
<p>これらの関係を理解するために、下記の例を考えてみてください:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">現在四人が部屋にいる</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>オブジェクト</strong> &#8658; 4 人</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">四人は人間である</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>クラス</strong> &#8658; 人間</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">四人はそれぞれ異なった名前、年齢、性別、国籍を持っている</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>属性</strong> &#8658; 名前、年齢、性別、国籍</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><em>オブジェクト指向</em> の用語では、これらのオブジェクトはクラスの <strong>インスタンス</strong> と呼ばれています。</p>
</div>
<div class="paragraph">
<p>下記のスクリプトについて考えてみてください:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">class</span> <span class="tok-n">Human</span> {
  <span class="tok-k">has</span> <span class="tok-nv">$.name</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.age</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.sex</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.nationality</span>;
}

<span class="tok-k">my</span> <span class="tok-nv">$john</span> = <span class="tok-n">Human</span>.<span class="tok-nb">new</span>(<span class="tok-nb">name</span> =&gt; <span class="tok-s">&#39;John&#39;</span>, <span class="tok-n">age</span> =&gt; <span class="tok-mi">23</span>, <span class="tok-n">sex</span> =&gt; <span class="tok-s">&#39;M&#39;</span>, <span class="tok-n">nationality</span> =&gt; <span class="tok-s">&#39;American&#39;</span>);
<span class="tok-nb">say</span> <span class="tok-nv">$john</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>class</code> キーワードはクラスを定義するのに使われます。<br>
<code>has</code> キーワードはクラスの属性を定義するのに使われます。<br>
<code>.new()</code> メソッドは <strong>コンストラクタ</strong> と呼ばれるものです。そのメソッドの呼ばれたクラスのインスタンスとしてオブジェクトを生成します。</p>
</div>
<div class="paragraph">
<p>上記のスクリプトでは、新しい変数 <code>$john</code> は、 <code>Human.new()</code> によって定義された"Human"の新しいインスタンスを持っています。
クラスは <code>my</code> を使うことで <em>レキシカルスコープ</em> とすることもできます:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-k">class</span> <span class="tok-n">Human</span> {

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_カプセル化">9.2. カプセル化</h3>
<div class="paragraph">
<p>カプセル化は、データとメソッドの集合を一緒にバンドルするというオブジェクト指向の概念です。<br>
オブジェクト内のデータ(属性)は <strong>プライベート</strong> であるべきです。つまり、オブジェクトの中からしかアクセスできないようにするべきです。<br>
オブジェクトの外から属性にアクセスするためには <strong>アクセッサ</strong> と呼ばれるメソッドを用います。</p>
</div>
<div class="paragraph">
<p>下記の二つのスクリプトは同じ結果を返します。</p>
</div>
<div class="listingblock">
<div class="title">変数への直接のアクセス:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$var</span> = <span class="tok-mi">7</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">カプセル化:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$var</span> = <span class="tok-mi">7</span>;
<span class="tok-k">sub</span> <span class="tok-n">sayvar</span> {
  <span class="tok-nv">$var</span>;
}
<span class="tok-nb">say</span> <span class="tok-n">sayvar</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>sayvar</code> メソッドはアクセッサです。変数に直接アクセスしなくても、変数の値にアクセスできるようにしてくれます。</p>
</div>
<div class="paragraph">
<p>Rakuでは <strong>トゥイジル</strong> の使用によって楽にカプセル化を行うことができます。<br>
トゥイジルは補助的な <em>シジル</em> です。シジルと属性の名前の間に書きます。<br>
二つのトゥイジルがクラスでは使われます:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>!</code> は明示的に属性がプライベートであることを宣言するときに使います</p>
</li>
<li>
<p><code>.</code> は属性のアクセッサを自動的に生成するときに使います</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>デフォルトでは、すべての属性はプライベートですが、いつも <code>!</code> トゥイジルを使うことはよい習慣です。</p>
</div>
<div class="paragraph">
<p>したがって、上のクラスは次のように書き換えるべきです:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">class</span> <span class="tok-n">Human</span> {
  <span class="tok-k">has</span> <span class="tok-nv">$!name</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$!age</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$!sex</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$!nationality</span>;
}

<span class="tok-k">my</span> <span class="tok-nv">$john</span> = <span class="tok-n">Human</span>.<span class="tok-nb">new</span>(<span class="tok-nb">name</span> =&gt; <span class="tok-s">&#39;John&#39;</span>, <span class="tok-n">age</span> =&gt; <span class="tok-mi">23</span>, <span class="tok-n">sex</span> =&gt; <span class="tok-s">&#39;M&#39;</span>, <span class="tok-n">nationality</span> =&gt; <span class="tok-s">&#39;American&#39;</span>);
<span class="tok-nb">say</span> <span class="tok-nv">$john</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>次の命令をスクリプトに追加してみましょう: <code>say $john.age;</code><br>
このようなエラーが返ってくるはずです: <code>Method 'age' not found for invocant of class 'Human'</code><br>
<code>$!age</code> はプライベートでありオブジェクト内でしか使えないというのが原因です。
オブジェクトの外からアクセスしようとするとエラーが返ります。</p>
</div>
<div class="paragraph">
<p>では、<code>has $!age</code> を <code>has $.age</code> に置き換えて、<code>say $john.age;</code> の結果を見てみましょう。</p>
</div>
</div>
<div class="sect2">
<h3 id="_名前付き引数と固定パラメータ">9.3. 名前付き引数と固定パラメータ</h3>
<div class="paragraph">
<p>Rakuでは、すべてのクラスはデフォルトの <code>.new()</code> コンストラクタを継承しています。<br>
このコンストラクタは引数を与えてオブジェクトを生成することもできます。<br>
デフォルトのコンストラクタは <strong>名前付き引数</strong> のみ使用することができます。<br>
上記の例において、 <code>.new()</code> に与えられている引数がすべて名前付きであることに注目してください。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>name =&gt; 'John'</p>
</li>
<li>
<p>age =&gt; 23</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>では、もしオブジェクトを生成するときにいちいち属性の名前を指定したくなかったらどうしたらいいでしょう？<br>
そういう場合は、 <strong>固定引数</strong> を受け取るような別のコンストラクタを作る必要があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">class</span> <span class="tok-n">Human</span> {
  <span class="tok-k">has</span> <span class="tok-nv">$.name</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.age</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.sex</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.nationality</span>;
  <span class="tok-c1"># デフォルトのコンストラクタをオーバーライドする</span>
  <span class="tok-k">method</span> <span class="tok-nb">new</span> (<span class="tok-nv">$name</span>,<span class="tok-nv">$age</span>,<span class="tok-nv">$sex</span>,<span class="tok-nv">$nationality</span>) {
    <span class="tok-nb">self</span>.<span class="tok-nb">bless</span>(:<span class="tok-nv">$name</span>,:<span class="tok-nv">$age</span>,:<span class="tok-nv">$sex</span>,:<span class="tok-nv">$nationality</span>);
  }
}

<span class="tok-k">my</span> <span class="tok-nv">$john</span> = <span class="tok-n">Human</span>.<span class="tok-nb">new</span>(<span class="tok-s">&#39;John&#39;</span>,<span class="tok-mi">23</span>,<span class="tok-s">&#39;M&#39;</span>,<span class="tok-s">&#39;American&#39;</span>);
<span class="tok-nb">say</span> <span class="tok-nv">$john</span>;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_メソッド">9.4. メソッド</h3>
<div class="sect3">
<h4 id="_イントロダクション_3">9.4.1. イントロダクション</h4>
<div class="paragraph">
<p>メソッドはオブジェクトの <em>サブルーチン</em> です。<br>
サブルーチンのように、機能の集合をパッケージングするための手段であり、 <strong>引数</strong> を受け取り、 <strong>シグネチャ</strong> を持ち、<strong>複数</strong> あるとして定義することができます。</p>
</div>
<div class="paragraph">
<p>メソッドは <code>method</code> キーワードを用いることで定義されます。
一般的な状況では、メソッドはオブジェクトの属性に対して何かしらの処理を行うことを要求されます。
これはカプセル化の考え方を強化します。オブジェクトの属性はメソッドを通じてオブジェクトの中からしか操作できません。
外の世界からはオブジェクトのメソッドとしかやりとりすることができず、そのオブジェクトの属性に直接アクセスすることはできません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">class</span> <span class="tok-n">Human</span> {
  <span class="tok-k">has</span> <span class="tok-nv">$.name</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.age</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.sex</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.nationality</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.eligible</span>;
  <span class="tok-k">method</span> <span class="tok-n">assess-eligibility</span> {
      <span class="tok-k">if</span> <span class="tok-nb">self</span>.<span class="tok-n">age</span> &lt; <span class="tok-mi">21</span> {
        <span class="tok-nv">$!eligible</span> = <span class="tok-s">&#39;No&#39;</span>
      } <span class="tok-k">else</span> {
        <span class="tok-nv">$!eligible</span> = <span class="tok-s">&#39;Yes&#39;</span>
      }
  }

}

<span class="tok-k">my</span> <span class="tok-nv">$john</span> = <span class="tok-n">Human</span>.<span class="tok-nb">new</span>(<span class="tok-nb">name</span> =&gt; <span class="tok-s">&#39;John&#39;</span>, <span class="tok-n">age</span> =&gt; <span class="tok-mi">23</span>, <span class="tok-n">sex</span> =&gt; <span class="tok-s">&#39;M&#39;</span>, <span class="tok-n">nationality</span> =&gt; <span class="tok-s">&#39;American&#39;</span>);
<span class="tok-nv">$john</span>.<span class="tok-n">assess-eligibility</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$john</span>.<span class="tok-n">eligible</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>一度クラスの中でメソッドが定義されたら、 <em>ドット表記法</em> によってオブジェクトから呼び出すことができます。:<br>
<em>オブジェクト</em> <strong>.</strong> <em>メソッド</em> として、上記の例のように: <code>$john.assess-eligibility</code></p>
</div>
<div class="paragraph">
<p>メソッドの定義の中では、他のメソッドを呼び出すためにオブジェクトそれ自身への参照が必要な場合は <code>self</code> キーワードを使います。<br></p>
</div>
<div class="paragraph">
<p>メソッドの定義の中では、属性を参照する必要がある場合は、その属性が <code>.</code> をともなって定義されていても <code>!</code> を使います。<br>
そういったことを行う論理的根拠は、 <code>.</code> トゥイジルが行っていることは <code>!</code> をともなった属性を宣言し、アクセッサを自動で生成することであるということです。</p>
</div>
<div class="paragraph">
<p>上の例では <code>if self.age &lt; 21</code> と <code>if $!age &lt; 21</code> は同じ効果を持っているかもしれませんが、理屈の上では違うということになっています:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>self.age</code> は <code>.age</code> メソッド (アクセッサ) を呼びます<br>
<code>$.age</code> とも書けます</p>
</li>
<li>
<p><code>$!age</code> は変数への直接の呼び出しです</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_プライベートメソッド">9.4.2. プライベートメソッド</h4>
<div class="paragraph">
<p>通常のメソッドはクラスの外でもオブジェクトから呼び出すことができます。</p>
</div>
<div class="paragraph">
<p><strong>プライベートメソッド</strong> はクラスの中からしか呼び出せないメソッドです。<br>
ユースケースとしては、あるメソッドが、特定の機能を使うために、ほかのメソッドを呼び出すようなときでしょう。<br>
外の世界とインタフェースで接続されているメソッドはパブリックですが、そこから参照されているメソッドはプライベートなままであるべきです。<br>
直接ユーザーに呼び出してほしくないのです。そのため、プライベートとして宣言することになります。</p>
</div>
<div class="paragraph">
<p>プライベートメソッドの宣言では名前の前で <code>!</code> トゥイジルを使う必要があります。<br>
プライベートメソッドは <code>.</code> の代わりに <code>!</code> によって呼び出します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">method</span> !<span class="tok-n">iamprivate</span> {
  <span class="tok-c1"># コードはここに</span>
}

<span class="tok-k">method</span> <span class="tok-n">iampublic</span> {
  <span class="tok-nb">self</span><span class="tok-o">!</span><span class="tok-n">iamprivate</span>;
  <span class="tok-c1"># さらに処理を行う</span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_クラス属性">9.5. クラス属性</h3>
<div class="paragraph">
<p><strong>クラス属性</strong> はクラス自身に属しているがオブジェクトには属していないような属性です。<br>
定義のときに初期化することができます。<br>
クラス属性は <code>has</code> の代わりに <code>my</code> をつかうことで宣言します。
クラス属性はそのオブジェクトではなくクラスそれ自身を呼び出します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">class</span> <span class="tok-n">Human</span> {
  <span class="tok-k">has</span> <span class="tok-nv">$.name</span>;
  <span class="tok-k">my</span> <span class="tok-nv">$.counter</span> = <span class="tok-mi">0</span>;
  <span class="tok-k">method</span> <span class="tok-nb">new</span>(<span class="tok-nv">$name</span>) {
    <span class="tok-n">Human</span>.<span class="tok-n">counter</span>++;
    <span class="tok-nb">self</span>.<span class="tok-nb">bless</span>(:<span class="tok-nv">$name</span>);
  }
}
<span class="tok-k">my</span> <span class="tok-nv">$a</span> = <span class="tok-n">Human</span>.<span class="tok-nb">new</span>(<span class="tok-s">&#39;a&#39;</span>);
<span class="tok-k">my</span> <span class="tok-nv">$b</span> = <span class="tok-n">Human</span>.<span class="tok-nb">new</span>(<span class="tok-s">&#39;b&#39;</span>);

<span class="tok-nb">say</span> <span class="tok-n">Human</span>.<span class="tok-n">counter</span>;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_アクセスタイプ">9.6. アクセスタイプ</h3>
<div class="paragraph">
<p>今までの見てきた例では、アクセッサはオブジェクトの属性から情報を <strong>得る</strong> ために使われてきました。</p>
</div>
<div class="paragraph">
<p>属性の値を変更する必要があるとしたらどうでしょう？<br>
<code>is rw</code> キーワードを使って、<em>読み/書き</em> ラベルを付与する必要があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">class</span> <span class="tok-n">Human</span> {
  <span class="tok-k">has</span> <span class="tok-nv">$.name</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.age</span> <span class="tok-k">is</span> <span class="tok-k">rw</span>;
}
<span class="tok-k">my</span> <span class="tok-nv">$john</span> = <span class="tok-n">Human</span>.<span class="tok-nb">new</span>(<span class="tok-nb">name</span> =&gt; <span class="tok-s">&#39;John&#39;</span>, <span class="tok-n">age</span> =&gt; <span class="tok-mi">21</span>);
<span class="tok-nb">say</span> <span class="tok-nv">$john</span>.<span class="tok-n">age</span>;

<span class="tok-nv">$john</span>.<span class="tok-n">age</span> = <span class="tok-mi">23</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$john</span>.<span class="tok-n">age</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>デフォルトでは、すべての属性は <em>読み込み専用</em> として宣言されます。しかし明示的に <code>is readonly</code> を使うこともできます。</p>
</div>
</div>
<div class="sect2">
<h3 id="_継承">9.7. 継承</h3>
<div class="sect3">
<h4 id="_イントロダクション_4">9.7.1. イントロダクション</h4>
<div class="paragraph">
<p><strong>継承は</strong> オブジェクト指向プログラミングのもう一つの考え方です。</p>
</div>
<div class="paragraph">
<p>クラスを定義すると、たくさんのクラスで同じ属性/メソッドを使っているということにすぐ気づくでしょう。<br>
コードは重複しているべきでしょうか？
ダメです！ <strong>継承</strong> を使うべきです。</p>
</div>
<div class="paragraph">
<p>人間クラスと従業員クラスの二つのクラスを定義したいという状況を考えてみましょう。<br>
人間は二つの属性を持っています: 名前と年齢<br>
従業員は四つの属性を持っています: 名前、年齢、会社、給料</p>
</div>
<div class="paragraph">
<p>次のようにクラスを定義しようとするかもしれません:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">class</span> <span class="tok-n">Human</span> {
  <span class="tok-k">has</span> <span class="tok-nv">$.name</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.age</span>;
}

<span class="tok-k">class</span> <span class="tok-n">Employee</span> {
  <span class="tok-k">has</span> <span class="tok-nv">$.name</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.age</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.company</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.salary</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>理屈の上では正しいですが、上記のコードの考え方はお粗末です。</p>
</div>
<div class="paragraph">
<p>次のような書き方のほうが良いでしょう:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">class</span> <span class="tok-n">Human</span> {
  <span class="tok-k">has</span> <span class="tok-nv">$.name</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.age</span>;
}

<span class="tok-k">class</span> <span class="tok-n">Employee</span> <span class="tok-k">is</span> <span class="tok-n">Human</span> {
  <span class="tok-k">has</span> <span class="tok-nv">$.company</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.salary</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>is</code> キーワードは継承を宣言しています。<br>
オブジェクト指向の用語では従業員は人間の <strong>子</strong> であり、人間は従業員の <strong>親</strong> であるといいます。</p>
</div>
<div class="paragraph">
<p>すべての子クラスは親クラスの属性とメソッドを継承します。そのため再定義する必要はありません。</p>
</div>
</div>
<div class="sect3">
<h4 id="_オーバーライド">9.7.2. オーバーライド</h4>
<div class="paragraph">
<p>クラスは親クラスからすべての属性とメソッドを継承します。<br>
継承したメソッドとは違うふるまいを子クラスのそれが行う必要がある場合があります。<br>
こういった場合は子クラスにおいてメソッドを再定義します。<br>
この考え方は <strong>オーバーライド</strong> と呼ばれます。</p>
</div>
<div class="paragraph">
<p>下記の例では、<code>introduce-yourself</code> メソッドが従業員クラスによって継承されています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">class</span> <span class="tok-n">Human</span> {
  <span class="tok-k">has</span> <span class="tok-nv">$.name</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.age</span>;
  <span class="tok-k">method</span> <span class="tok-n">introduce-yourself</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&#39;Hi i am a human being, my name is &#39;</span> ~ <span class="tok-nb">self</span>.<span class="tok-nb">name</span>;
  }
}

<span class="tok-k">class</span> <span class="tok-n">Employee</span> <span class="tok-k">is</span> <span class="tok-n">Human</span> {
  <span class="tok-k">has</span> <span class="tok-nv">$.company</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.salary</span>;
}

<span class="tok-k">my</span> <span class="tok-nv">$john</span> = <span class="tok-n">Human</span>.<span class="tok-nb">new</span>(<span class="tok-nb">name</span> =&gt;<span class="tok-s">&#39;John&#39;</span>, <span class="tok-n">age</span> =&gt; <span class="tok-mi">23</span>,);
<span class="tok-k">my</span> <span class="tok-nv">$jane</span> = <span class="tok-n">Employee</span>.<span class="tok-nb">new</span>(<span class="tok-nb">name</span> =&gt;<span class="tok-s">&#39;Jane&#39;</span>, <span class="tok-n">age</span> =&gt; <span class="tok-mi">25</span>, <span class="tok-n">company</span> =&gt; <span class="tok-s">&#39;Acme&#39;</span>, <span class="tok-n">salary</span> =&gt; <span class="tok-mi">4000</span>);

<span class="tok-nv">$john</span>.<span class="tok-n">introduce-yourself</span>;
<span class="tok-nv">$jane</span>.<span class="tok-n">introduce-yourself</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>オーバーライドは次のように実行されます:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">class</span> <span class="tok-n">Human</span> {
  <span class="tok-k">has</span> <span class="tok-nv">$.name</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.age</span>;
  <span class="tok-k">method</span> <span class="tok-n">introduce-yourself</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&#39;Hi i am a human being, my name is &#39;</span> ~ <span class="tok-nb">self</span>.<span class="tok-nb">name</span>;
  }
}

<span class="tok-k">class</span> <span class="tok-n">Employee</span> <span class="tok-k">is</span> <span class="tok-n">Human</span> {
  <span class="tok-k">has</span> <span class="tok-nv">$.company</span>;
  <span class="tok-k">has</span> <span class="tok-nv">$.salary</span>;
  <span class="tok-k">method</span> <span class="tok-n">introduce-yourself</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&#39;Hi i am a employee, my name is &#39;</span> ~ <span class="tok-nb">self</span>.<span class="tok-nb">name</span> ~ <span class="tok-s">&#39; and I work at: &#39;</span> ~ <span class="tok-nb">self</span>.<span class="tok-n">company</span>;
  }

}

<span class="tok-k">my</span> <span class="tok-nv">$john</span> = <span class="tok-n">Human</span>.<span class="tok-nb">new</span>(<span class="tok-nb">name</span> =&gt;<span class="tok-s">&#39;John&#39;</span>,<span class="tok-n">age</span> =&gt; <span class="tok-mi">23</span>,);
<span class="tok-k">my</span> <span class="tok-nv">$jane</span> = <span class="tok-n">Employee</span>.<span class="tok-nb">new</span>(<span class="tok-nb">name</span> =&gt;<span class="tok-s">&#39;Jane&#39;</span>,<span class="tok-n">age</span> =&gt; <span class="tok-mi">25</span>,<span class="tok-n">company</span> =&gt; <span class="tok-s">&#39;Acme&#39;</span>,<span class="tok-n">salary</span> =&gt; <span class="tok-mi">4000</span>);

<span class="tok-nv">$john</span>.<span class="tok-n">introduce-yourself</span>;
<span class="tok-nv">$jane</span>.<span class="tok-n">introduce-yourself</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>オブジェクトがどのクラスのものであるかに依存して、正しいメソッドが呼ばれます。</p>
</div>
</div>
<div class="sect3">
<h4 id="_サブメソッド">9.7.3. サブメソッド</h4>
<div class="paragraph">
<p><strong>サブメソッド</strong> は子クラスによって継承されないメソッドです。<br>
宣言されたクラスからのみアクセスすることができます。<br>
 <code>submethod</code> キーワードを使って定義されます。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_多重継承">9.8. 多重継承</h3>
<div class="paragraph">
<p>Rakuでは多重継承を行うことができます。あるクラスは複数の他のクラスから継承を行うことができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">class</span> <span class="tok-n">bar-chart</span> {
  <span class="tok-k">has</span> <span class="tok-nb">Int</span> <span class="tok-nv">@.bar-values</span>;
  <span class="tok-k">method</span> <span class="tok-n">plot</span> {
    <span class="tok-nb">say</span> <span class="tok-nv">@.bar-values</span>;
  }
}

<span class="tok-k">class</span> <span class="tok-n">line-chart</span> {
  <span class="tok-k">has</span> <span class="tok-nb">Int</span> <span class="tok-nv">@.line-values</span>;
  <span class="tok-k">method</span> <span class="tok-n">plot</span> {
    <span class="tok-nb">say</span> <span class="tok-nv">@.line-values</span>;
  }
}

<span class="tok-k">class</span> <span class="tok-n">combo-chart</span> <span class="tok-k">is</span> <span class="tok-n">bar-chart</span> <span class="tok-k">is</span> <span class="tok-n">line-chart</span> {
}

<span class="tok-k">my</span> <span class="tok-nv">$actual-sales</span> = <span class="tok-n">bar-chart</span>.<span class="tok-nb">new</span>(<span class="tok-n">bar-values</span> =&gt; [<span class="tok-mi">10</span>,<span class="tok-mi">9</span>,<span class="tok-mi">11</span>,<span class="tok-mi">8</span>,<span class="tok-mi">7</span>,<span class="tok-mi">10</span>]);
<span class="tok-k">my</span> <span class="tok-nv">$forecast-sales</span> = <span class="tok-n">line-chart</span>.<span class="tok-nb">new</span>(<span class="tok-n">line-values</span> =&gt; [<span class="tok-mi">9</span>,<span class="tok-mi">8</span>,<span class="tok-mi">10</span>,<span class="tok-mi">7</span>,<span class="tok-mi">6</span>,<span class="tok-mi">9</span>]);

<span class="tok-k">my</span> <span class="tok-nv">$actual-vs-forecast</span> = <span class="tok-n">combo-chart</span>.<span class="tok-nb">new</span>(<span class="tok-n">bar-values</span> =&gt; [<span class="tok-mi">10</span>,<span class="tok-mi">9</span>,<span class="tok-mi">11</span>,<span class="tok-mi">8</span>,<span class="tok-mi">7</span>,<span class="tok-mi">10</span>],
                                         <span class="tok-n">line-values</span> =&gt; [<span class="tok-mi">9</span>,<span class="tok-mi">8</span>,<span class="tok-mi">10</span>,<span class="tok-mi">7</span>,<span class="tok-mi">6</span>,<span class="tok-mi">9</span>]);
<span class="tok-nb">say</span> <span class="tok-s">&quot;Actual sales:&quot;</span>;
<span class="tok-nv">$actual-sales</span>.<span class="tok-n">plot</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;Forecast sales:&quot;</span>;
<span class="tok-nv">$forecast-sales</span>.<span class="tok-n">plot</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;Actual vs Forecast:&quot;</span>;
<span class="tok-nv">$actual-vs-forecast</span>.<span class="tok-n">plot</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><code>出力</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-n">Actual</span> <span class="tok-n">sales:</span>
[<span class="tok-mi">10</span> <span class="tok-mi">9</span> <span class="tok-mi">11</span> <span class="tok-mi">8</span> <span class="tok-mi">7</span> <span class="tok-mi">10</span>]
<span class="tok-n">Forecast</span> <span class="tok-n">sales:</span>
[<span class="tok-mi">9</span> <span class="tok-mi">8</span> <span class="tok-mi">10</span> <span class="tok-mi">7</span> <span class="tok-mi">6</span> <span class="tok-mi">9</span>]
<span class="tok-n">Actual</span> <span class="tok-n">vs</span> <span class="tok-n">Forecast:</span>
[<span class="tok-mi">10</span> <span class="tok-mi">9</span> <span class="tok-mi">11</span> <span class="tok-mi">8</span> <span class="tok-mi">7</span> <span class="tok-mi">10</span>]</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">説明</div>
<p><code>combo-chart</code> クラスは二つの系列を保持できるようになっているべきです。一つは実際の値でバーにプロットされます。
もう一つは予測値で線にプロットされます。<br>
これが <code>combo-chart</code> クラスを <code>line-chart</code> クラスと <code>bar-chart</code> クラスの子として定義した理由です。<br>
<code>combo-chart</code> の <code>plot</code> メソッドが要求された結果を生成しなかったことに気づいたと思います。
系列一つだけがプロットされました。<br>
なぜこんなことが起こったのでしょうか？<br>
<code>combo-chart</code> は <code>line-chart</code> と <code>bar-chart</code> を継承しており、両方とも <code>plot</code> と呼ばれるメソッドを持っています。
<code>combo-chart</code> からこのメソッドが呼ばれるとき、Rakuの内部では継承されたメソッドのうちの一つだけを呼ぶことでコンフリクトを解消しているのです。</p>
</div>
<div class="paragraph">
<div class="title">修正</div>
<p>正しくふるまうようにするには、 <code>combo-chart</code> の中の <code>plot</code> メソッドをオーバーライドするべきでした。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">class</span> <span class="tok-n">bar-chart</span> {
  <span class="tok-k">has</span> <span class="tok-nb">Int</span> <span class="tok-nv">@.bar-values</span>;
  <span class="tok-k">method</span> <span class="tok-n">plot</span> {
    <span class="tok-nb">say</span> <span class="tok-nv">@.bar-values</span>;
  }
}

<span class="tok-k">class</span> <span class="tok-n">line-chart</span> {
  <span class="tok-k">has</span> <span class="tok-nb">Int</span> <span class="tok-nv">@.line-values</span>;
  <span class="tok-k">method</span> <span class="tok-n">plot</span> {
    <span class="tok-nb">say</span> <span class="tok-nv">@.line-values</span>;
  }
}

<span class="tok-k">class</span> <span class="tok-n">combo-chart</span> <span class="tok-k">is</span> <span class="tok-n">bar-chart</span> <span class="tok-k">is</span> <span class="tok-n">line-chart</span> {
  <span class="tok-k">method</span> <span class="tok-n">plot</span> {
    <span class="tok-nb">say</span> <span class="tok-nv">@.bar-values</span>;
    <span class="tok-nb">say</span> <span class="tok-nv">@.line-values</span>;
  }
}

<span class="tok-k">my</span> <span class="tok-nv">$actual-sales</span> = <span class="tok-n">bar-chart</span>.<span class="tok-nb">new</span>(<span class="tok-n">bar-values</span> =&gt; [<span class="tok-mi">10</span>,<span class="tok-mi">9</span>,<span class="tok-mi">11</span>,<span class="tok-mi">8</span>,<span class="tok-mi">7</span>,<span class="tok-mi">10</span>]);
<span class="tok-k">my</span> <span class="tok-nv">$forecast-sales</span> = <span class="tok-n">line-chart</span>.<span class="tok-nb">new</span>(<span class="tok-n">line-values</span> =&gt; [<span class="tok-mi">9</span>,<span class="tok-mi">8</span>,<span class="tok-mi">10</span>,<span class="tok-mi">7</span>,<span class="tok-mi">6</span>,<span class="tok-mi">9</span>]);

<span class="tok-k">my</span> <span class="tok-nv">$actual-vs-forecast</span> = <span class="tok-n">combo-chart</span>.<span class="tok-nb">new</span>(<span class="tok-n">bar-values</span> =&gt; [<span class="tok-mi">10</span>,<span class="tok-mi">9</span>,<span class="tok-mi">11</span>,<span class="tok-mi">8</span>,<span class="tok-mi">7</span>,<span class="tok-mi">10</span>],
                                         <span class="tok-n">line-values</span> =&gt; [<span class="tok-mi">9</span>,<span class="tok-mi">8</span>,<span class="tok-mi">10</span>,<span class="tok-mi">7</span>,<span class="tok-mi">6</span>,<span class="tok-mi">9</span>]);
<span class="tok-nb">say</span> <span class="tok-s">&quot;Actual sales:&quot;</span>;
<span class="tok-nv">$actual-sales</span>.<span class="tok-n">plot</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;Forecast sales:&quot;</span>;
<span class="tok-nv">$forecast-sales</span>.<span class="tok-n">plot</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;Actual vs Forecast:&quot;</span>;
<span class="tok-nv">$actual-vs-forecast</span>.<span class="tok-n">plot</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><code>出力</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-n">Actual</span> <span class="tok-n">sales:</span>
[<span class="tok-mi">10</span> <span class="tok-mi">9</span> <span class="tok-mi">11</span> <span class="tok-mi">8</span> <span class="tok-mi">7</span> <span class="tok-mi">10</span>]
<span class="tok-n">Forecast</span> <span class="tok-n">sales:</span>
[<span class="tok-mi">9</span> <span class="tok-mi">8</span> <span class="tok-mi">10</span> <span class="tok-mi">7</span> <span class="tok-mi">6</span> <span class="tok-mi">9</span>]
<span class="tok-n">Actual</span> <span class="tok-n">vs</span> <span class="tok-n">Forecast:</span>
[<span class="tok-mi">10</span> <span class="tok-mi">9</span> <span class="tok-mi">11</span> <span class="tok-mi">8</span> <span class="tok-mi">7</span> <span class="tok-mi">10</span>]
[<span class="tok-mi">9</span> <span class="tok-mi">8</span> <span class="tok-mi">10</span> <span class="tok-mi">7</span> <span class="tok-mi">6</span> <span class="tok-mi">9</span>]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ロール">9.9. ロール</h3>
<div class="paragraph">
<p><strong>ロール</strong> はクラスが属性とメソッドのコレクションであるという点においてクラスと似ています。</p>
</div>
<div class="paragraph">
<p>ロールは <code>role</code> キーワードによって宣言されます。ロールを実装したいクラスは <code>does</code> キーワードを使って宣言します。</p>
</div>
<div class="listingblock">
<div class="title">ロールを使って多重継承を書き換えてみましょう:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">role</span> <span class="tok-n">bar-chart</span> {
  <span class="tok-k">has</span> <span class="tok-nb">Int</span> <span class="tok-nv">@.bar-values</span>;
  <span class="tok-k">method</span> <span class="tok-n">plot</span> {
    <span class="tok-nb">say</span> <span class="tok-nv">@.bar-values</span>;
  }
}

<span class="tok-k">role</span> <span class="tok-n">line-chart</span> {
  <span class="tok-k">has</span> <span class="tok-nb">Int</span> <span class="tok-nv">@.line-values</span>;
  <span class="tok-k">method</span> <span class="tok-n">plot</span> {
    <span class="tok-nb">say</span> <span class="tok-nv">@.line-values</span>;
  }
}

<span class="tok-k">class</span> <span class="tok-n">combo-chart</span> <span class="tok-k">does</span> <span class="tok-n">bar-chart</span> <span class="tok-k">does</span> <span class="tok-n">line-chart</span> {
  <span class="tok-k">method</span> <span class="tok-n">plot</span> {
    <span class="tok-nb">say</span> <span class="tok-nv">@.bar-values</span>;
    <span class="tok-nb">say</span> <span class="tok-nv">@.line-values</span>;
  }
}

<span class="tok-k">my</span> <span class="tok-nv">$actual-sales</span> = <span class="tok-n">bar-chart</span>.<span class="tok-nb">new</span>(<span class="tok-n">bar-values</span> =&gt; [<span class="tok-mi">10</span>,<span class="tok-mi">9</span>,<span class="tok-mi">11</span>,<span class="tok-mi">8</span>,<span class="tok-mi">7</span>,<span class="tok-mi">10</span>]);
<span class="tok-k">my</span> <span class="tok-nv">$forecast-sales</span> = <span class="tok-n">line-chart</span>.<span class="tok-nb">new</span>(<span class="tok-n">line-values</span> =&gt; [<span class="tok-mi">9</span>,<span class="tok-mi">8</span>,<span class="tok-mi">10</span>,<span class="tok-mi">7</span>,<span class="tok-mi">6</span>,<span class="tok-mi">9</span>]);

<span class="tok-k">my</span> <span class="tok-nv">$actual-vs-forecast</span> = <span class="tok-n">combo-chart</span>.<span class="tok-nb">new</span>(<span class="tok-n">bar-values</span> =&gt; [<span class="tok-mi">10</span>,<span class="tok-mi">9</span>,<span class="tok-mi">11</span>,<span class="tok-mi">8</span>,<span class="tok-mi">7</span>,<span class="tok-mi">10</span>],
                                         <span class="tok-n">line-values</span> =&gt; [<span class="tok-mi">9</span>,<span class="tok-mi">8</span>,<span class="tok-mi">10</span>,<span class="tok-mi">7</span>,<span class="tok-mi">6</span>,<span class="tok-mi">9</span>]);
<span class="tok-nb">say</span> <span class="tok-s">&quot;Actual sales:&quot;</span>;
<span class="tok-nv">$actual-sales</span>.<span class="tok-n">plot</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;Forecast sales:&quot;</span>;
<span class="tok-nv">$forecast-sales</span>.<span class="tok-n">plot</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;Actual vs Forecast:&quot;</span>;
<span class="tok-nv">$actual-vs-forecast</span>.<span class="tok-n">plot</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>上記のスクリプトを実行すると全く同じ結果が出力されることを確認できるはずです。</p>
</div>
<div class="paragraph">
<p>そろそろこんなひとり言が聞こえてきそうです: もしロールがクラスのようにふるまうなら、ロールの使い道って何だろう？<br>
この質問に答えるために、多重継承の例を見せるために使われた最初のスクリプトを修正してください。
<code>plot</code> メソッドをオーバーライドするのを <em>忘れた</em> 例のスクリプトです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">role</span> <span class="tok-n">bar-chart</span> {
  <span class="tok-k">has</span> <span class="tok-nb">Int</span> <span class="tok-nv">@.bar-values</span>;
  <span class="tok-k">method</span> <span class="tok-n">plot</span> {
    <span class="tok-nb">say</span> <span class="tok-nv">@.bar-values</span>;
  }
}

<span class="tok-k">role</span> <span class="tok-n">line-chart</span> {
  <span class="tok-k">has</span> <span class="tok-nb">Int</span> <span class="tok-nv">@.line-values</span>;
  <span class="tok-k">method</span> <span class="tok-n">plot</span> {
    <span class="tok-nb">say</span> <span class="tok-nv">@.line-values</span>;
  }
}

<span class="tok-k">class</span> <span class="tok-n">combo-chart</span> <span class="tok-k">does</span> <span class="tok-n">bar-chart</span> <span class="tok-k">does</span> <span class="tok-n">line-chart</span> {
}

<span class="tok-k">my</span> <span class="tok-nv">$actual-sales</span> = <span class="tok-n">bar-chart</span>.<span class="tok-nb">new</span>(<span class="tok-n">bar-values</span> =&gt; [<span class="tok-mi">10</span>,<span class="tok-mi">9</span>,<span class="tok-mi">11</span>,<span class="tok-mi">8</span>,<span class="tok-mi">7</span>,<span class="tok-mi">10</span>]);
<span class="tok-k">my</span> <span class="tok-nv">$forecast-sales</span> = <span class="tok-n">line-chart</span>.<span class="tok-nb">new</span>(<span class="tok-n">line-values</span> =&gt; [<span class="tok-mi">9</span>,<span class="tok-mi">8</span>,<span class="tok-mi">10</span>,<span class="tok-mi">7</span>,<span class="tok-mi">6</span>,<span class="tok-mi">9</span>]);

<span class="tok-k">my</span> <span class="tok-nv">$actual-vs-forecast</span> = <span class="tok-n">combo-chart</span>.<span class="tok-nb">new</span>(<span class="tok-n">bar-values</span> =&gt; [<span class="tok-mi">10</span>,<span class="tok-mi">9</span>,<span class="tok-mi">11</span>,<span class="tok-mi">8</span>,<span class="tok-mi">7</span>,<span class="tok-mi">10</span>],
                                         <span class="tok-n">line-values</span> =&gt; [<span class="tok-mi">9</span>,<span class="tok-mi">8</span>,<span class="tok-mi">10</span>,<span class="tok-mi">7</span>,<span class="tok-mi">6</span>,<span class="tok-mi">9</span>]);
<span class="tok-nb">say</span> <span class="tok-s">&quot;Actual sales:&quot;</span>;
<span class="tok-nv">$actual-sales</span>.<span class="tok-n">plot</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;Forecast sales:&quot;</span>;
<span class="tok-nv">$forecast-sales</span>.<span class="tok-n">plot</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;Actual vs Forecast:&quot;</span>;
<span class="tok-nv">$actual-vs-forecast</span>.<span class="tok-n">plot</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><code>出力</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span>===<span class="tok-n">SORRY</span>!===
<span class="tok-nb">Method</span> <span class="tok-s">&#39;plot&#39;</span> <span class="tok-n">must</span> <span class="tok-n">be</span> <span class="tok-n">resolved</span> <span class="tok-n">by</span> <span class="tok-k">class</span> <span class="tok-n">combo-chart</span> <span class="tok-n">because</span> <span class="tok-n">it</span> <span class="tok-n">exists</span> <span class="tok-nb">in</span> <span class="tok-n">multiple</span> <span class="tok-n">roles</span> (<span class="tok-n">line-chart</span>, <span class="tok-n">bar-chart</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">説明</div>
<p>もし複数のロールが同じクラスに対して適用され、コンフリクトがあるなら、コンパイルタイムのエラーが投げられます。<br>
これは、多重継承よりもずっと安全なアプローチです。なぜなら、多重継承ではコンフリクトはエラーとして考えられておらずランタイムで単純に解決されてしまうからです。</p>
</div>
<div class="paragraph">
<p>ロールはコンフリクトがあるときに警告してくれるのです。</p>
</div>
</div>
<div class="sect2">
<h3 id="_イントロスペクション_2">9.10. イントロスペクション</h3>
<div class="paragraph">
<p><strong>イントロスペクション</strong> は、オブジェクトの型、オブジェクトの属性、オブジェクトのメソッドといったオブジェクトの情報を得るための処理です。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">class</span> <span class="tok-n">Human</span> {
  <span class="tok-k">has</span> <span class="tok-nb">Str</span> <span class="tok-nv">$.name</span>;
  <span class="tok-k">has</span> <span class="tok-nb">Int</span> <span class="tok-nv">$.age</span>;
  <span class="tok-k">method</span> <span class="tok-n">introduce-yourself</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&#39;Hi i am a human being, my name is &#39;</span> ~ <span class="tok-nb">self</span>.<span class="tok-nb">name</span>;
  }
}

<span class="tok-k">class</span> <span class="tok-n">Employee</span> <span class="tok-k">is</span> <span class="tok-n">Human</span> {
  <span class="tok-k">has</span> <span class="tok-nb">Str</span> <span class="tok-nv">$.company</span>;
  <span class="tok-k">has</span> <span class="tok-nb">Int</span> <span class="tok-nv">$.salary</span>;
  <span class="tok-k">method</span> <span class="tok-n">introduce-yourself</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&#39;Hi i am a employee, my name is &#39;</span> ~ <span class="tok-nb">self</span>.<span class="tok-nb">name</span> ~ <span class="tok-s">&#39; and I work at: &#39;</span> ~ <span class="tok-nb">self</span>.<span class="tok-n">company</span>;
  }
}

<span class="tok-k">my</span> <span class="tok-nv">$john</span> = <span class="tok-n">Human</span>.<span class="tok-nb">new</span>(<span class="tok-nb">name</span> =&gt;<span class="tok-s">&#39;John&#39;</span>,<span class="tok-n">age</span> =&gt; <span class="tok-mi">23</span>,);
<span class="tok-k">my</span> <span class="tok-nv">$jane</span> = <span class="tok-n">Employee</span>.<span class="tok-nb">new</span>(<span class="tok-nb">name</span> =&gt;<span class="tok-s">&#39;Jane&#39;</span>,<span class="tok-n">age</span> =&gt; <span class="tok-mi">25</span>,<span class="tok-n">company</span> =&gt; <span class="tok-s">&#39;Acme&#39;</span>,<span class="tok-n">salary</span> =&gt; <span class="tok-mi">4000</span>);

<span class="tok-nb">say</span> <span class="tok-nv">$john</span>.<span class="tok-nb">WHAT</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$jane</span>.<span class="tok-nb">WHAT</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$john</span>.^<span class="tok-nb">attributes</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$jane</span>.^<span class="tok-nb">attributes</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$john</span>.^<span class="tok-nb">methods</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$jane</span>.^<span class="tok-nb">methods</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$jane</span>.^<span class="tok-nb">parents</span>;
<span class="tok-k">if</span> <span class="tok-nv">$jane</span> ~~ <span class="tok-n">Human</span> {<span class="tok-nb">say</span> <span class="tok-s">&#39;Jane is a Human&#39;</span>};</code></pre>
</div>
</div>
<div class="paragraph">
<p>イントロスペクションは次のように容易に行えます:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>.WHAT</code>&#8201;&#8212;&#8201;オブジェクトがどのクラスから作られたかを返します。</p>
</li>
<li>
<p><code>.^attributes</code>&#8201;&#8212;&#8201;オブジェクトのすべての属性を返します。</p>
</li>
<li>
<p><code>.^methods</code>&#8201;&#8212;&#8201;オブジェクトから呼ぶことのできるすべてのメソッドを返します。</p>
</li>
<li>
<p><code>.^parents</code>&#8201;&#8212;&#8201;オブジェクトの属しているクラスの親クラスを返します。</p>
</li>
<li>
<p><code>~~</code> はスマートマッチ演算子を呼びます。
もしオブジェクトが比較している相手のクラスか、その相手のクラスの継承先のいずれかのクラスから生成されているなら <em>True</em> と評価されます。</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>もしRakuにおけるオブジェクト指向についてより深く知りたいのであれば、次のURLを参照することをすすめます</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.raku.org/language/classtut" class="bare">https://docs.raku.org/language/classtut</a></p>
</li>
<li>
<p><a href="https://docs.raku.org/language/objects" class="bare">https://docs.raku.org/language/objects</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_例外処理">10. 例外処理</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_例外のキャッチ">10.1. 例外のキャッチ</h3>
<div class="paragraph">
<p><strong>例外</strong> はランライムで何かが失敗したときに発生する特別なふるまいです。<br>
例外が <em>投げられる</em> と表現します。</p>
</div>
<div class="paragraph">
<p>正しく実行される下記のスクリプトについて考えてみてください:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nb">Str</span> <span class="tok-nv">$name</span>;
<span class="tok-nv">$name</span> = <span class="tok-s">&quot;Joanna&quot;</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;Hello &quot;</span> ~ <span class="tok-nv">$name</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;How are you doing today?&quot;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><code>出力</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-n">Hello</span> <span class="tok-n">Joanna</span>
<span class="tok-n">How</span> <span class="tok-n">are</span> <span class="tok-n">you</span> <span class="tok-n">doing</span> <span class="tok-nb">today</span>?</code></pre>
</div>
</div>
<div class="paragraph">
<p>では、例外を投げる次のスクリプトについて考えてみてください:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nb">Str</span> <span class="tok-nv">$name</span>;
<span class="tok-nv">$name</span> = <span class="tok-mi">123</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;Hello &quot;</span> ~ <span class="tok-nv">$name</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;How are you doing today?&quot;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><code>出力</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-n">Type</span> <span class="tok-n">check</span> <span class="tok-n">failed</span> <span class="tok-nb">in</span> <span class="tok-n">assignment</span> <span class="tok-nb">to</span> <span class="tok-nv">$name</span>; <span class="tok-nb">expected</span> <span class="tok-nb">Str</span> <span class="tok-k">but</span> <span class="tok-nb">got</span> <span class="tok-nb">Int</span>
   <span class="tok-nb">in</span> <span class="tok-nb">block</span> <span class="tok-s">&lt;unit&gt;</span> <span class="tok-nb">at</span> <span class="tok-n">exceptions</span>.<span class="tok-n">raku:2</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>エラーが発生したとき(この場合は文字列変数に数値を代入している)は必ずプログラムが停止し、ほかの行のコードは評価されないということに注目してください。</p>
</div>
<div class="paragraph">
<p><strong>エラー処理</strong> は <em>投げられた</em> 例外の <em>キャッチ</em> 処理を行うことでスクリプトが実行を続けられるようにすることです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nb">Str</span> <span class="tok-nv">$name</span>;
<span class="tok-k">try</span> {
  <span class="tok-nv">$name</span> = <span class="tok-mi">123</span>;
  <span class="tok-nb">say</span> <span class="tok-s">&quot;Hello &quot;</span> ~ <span class="tok-nv">$name</span>;
  <span class="tok-k">CATCH</span> {
    <span class="tok-k">default</span> {
      <span class="tok-nb">say</span> <span class="tok-s">&quot;Can you tell us your name again, we couldn&#39;t find it in the register.&quot;</span>;
    }
  }
}
<span class="tok-nb">say</span> <span class="tok-s">&quot;How are you doing today?&quot;</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><code>出力</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-n">Can</span> <span class="tok-n">you</span> <span class="tok-nb">tell</span> <span class="tok-n">us</span> <span class="tok-n">your</span> <span class="tok-nb">name</span> <span class="tok-n">again</span>, <span class="tok-n">we</span> <span class="tok-n">couldn&#39;t</span> <span class="tok-n">find</span> <span class="tok-n">it</span> <span class="tok-nb">in</span> <span class="tok-n">the</span> <span class="tok-n">register</span>.
<span class="tok-n">How</span> <span class="tok-n">are</span> <span class="tok-n">you</span> <span class="tok-n">doing</span> <span class="tok-nb">today</span>?</code></pre>
</div>
</div>
<div class="paragraph">
<p>例外処理は <code>try-catch</code> ブロックを用いることで行われます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">try</span> {
  <span class="tok-c1"># コードはここに</span>
  <span class="tok-c1"># もし何かが失敗したなら下記のCATCHブロックに入ります</span>
  <span class="tok-c1"># もし問題がなかったのなら下記のCATCHブロックは無視されます</span>
  <span class="tok-k">CATCH</span> {
    <span class="tok-k">default</span> {
      <span class="tok-c1"># ここのコードは例外が投げられたときだけ評価されます</span>
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>CATCH</code> ブロックは <code>given</code> ブロックが定義されるときと同じように定義できます。
これは様々なタイプの例外を <em>キャッチ</em> して扱うことができることを意味しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">try</span> {
  <span class="tok-c1"># コードはここに</span>
  <span class="tok-c1"># もし何かが失敗したなら下記のCATCHブロックに入ります</span>
  <span class="tok-c1"># もし問題がなかったのなら下記のCATCHブロックは無視されます</span>
  <span class="tok-k">CATCH</span> {
    <span class="tok-k">when</span> <span class="tok-o">X</span>::<span class="tok-n">AdHoc</span>   { <span class="tok-c1"># X::AdHoc型の例外が投げられたのなら何かを実行します }</span>
    <span class="tok-k">when</span> <span class="tok-o">X</span>::<span class="tok-n">IO</span>      { <span class="tok-c1"># X::IO型の例外が投げられたのなら何かを実行します }</span>
    <span class="tok-k">when</span> <span class="tok-o">X</span>::<span class="tok-n">OS</span>      { <span class="tok-c1"># X::OS型の例外が投げられたのなら何かを実行します }</span>
    <span class="tok-k">default</span>         { <span class="tok-c1"># 上記の型に該当しない例外が投げられたのなら何かを実行します }</span>
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_例外を投げる">10.2. 例外を投げる</h3>
<div class="paragraph">
<p>Rakuは明示的に例外を投げることができます。<br>
二つのタイプの例外を投げることができます:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>アドホック例外</p>
</li>
<li>
<p>型付き例外</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">アドホック</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nb">Int</span> <span class="tok-nv">$age</span> = <span class="tok-mi">21</span>;
<span class="tok-nb">die</span> <span class="tok-s">&quot;Error !&quot;</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">型付き</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nb">Int</span> <span class="tok-nv">$age</span> = <span class="tok-mi">21</span>;
<span class="tok-o">X</span>::<span class="tok-n">AdHoc</span>.<span class="tok-nb">new</span>(<span class="tok-nb">payload</span> =&gt; <span class="tok-s">&#39;Error !&#39;</span>).<span class="tok-nb">throw</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>アドホック例外は、例外メッセージのともなった <code>die</code> サブルーチンを使って投げられます。</p>
</div>
<div class="paragraph">
<p>型付き例外はオブジェクトです。したがって上記の例では <code>.new()</code> コンストラクタを使用しています。<br>
すべての型付き例外はクラス <code>X</code> の子孫です。下記は少数の例です:
<code>X::AdHoc</code> は最もシンプルな例外のタイプです　<br>
<code>X::IO</code> はIOエラーに関する例外です<br>
<code>X::OS</code> はOSエラーに関する例外です<br>
<code>X::Str::Numeric</code> は文字列を数値にしようとすることに関する例外です</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
もし例外の型と、関連するメソッドのすべてのリストを知りたいのであれば、次のURLを参照することをすすめます <a href="https://docs.raku.org/type.html" class="bare">https://docs.raku.org/type.html</a>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_正規表現">11. 正規表現</h2>
<div class="sectionbody">
<div class="paragraph">
<p>正規表現、または <em>regex</em> はパターンマッチングのための文字のシーケンスです。
パターンだと思ってください。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">if</span> <span class="tok-s">&#39;enlightenment&#39;</span> ~~ <span class="tok-sr">m/ light /</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;enlightenment contains the word light&quot;</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>この例では、スマートマッチ演算子 <code>~~</code> は文字列(enlightenment)が単語(light)を含んでいるかどうか調べるのに使われています。<br>
"Enlightenment" は 正規表現 <code>m/ light /</code> にマッチします。</p>
</div>
<div class="sect2">
<h3 id="_正規表現の定義">11.1. 正規表現の定義</h3>
<div class="paragraph">
<p>正規表現は次のように定義できます:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/light/</code></p>
</li>
<li>
<p><code>m/light/</code></p>
</li>
<li>
<p><code>rx/light/</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>明示的に指定されない限り、空白は無視されます。つまり、<code>m/light/</code> と <code>m/ light /</code> は等価です。</p>
</div>
</div>
<div class="sect2">
<h3 id="_文字のマッチング">11.2. 文字のマッチング</h3>
<div class="paragraph">
<p>アルファベット文字とアンダースコア <code>_</code> はそのまま書かれます。<br>
他の文字はバックスラッシュを使うかクォートで囲むことでエスケープされている必要があります。</p>
</div>
<div class="listingblock">
<div class="title">バックスラッシュ</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">if</span> <span class="tok-s">&#39;Temperature: 13&#39;</span> ~~ <span class="tok-sr">m/ \: /</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;The string provided contains a colon :&quot;</span>;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">シングルクォート</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">if</span> <span class="tok-s">&#39;Age = 13&#39;</span> ~~ <span class="tok-sr">m/ &#39;=&#39; /</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;The string provided contains an equal character = &quot;</span>;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">ダブルクォート</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">if</span> <span class="tok-s">&#39;name@company.com&#39;</span> ~~ <span class="tok-sr">m/ &quot;@&quot; /</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;This is a valid email address because it contains an @ character&quot;</span>;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_文字種へのマッチング">11.3. 文字種へのマッチング</h3>
<div class="paragraph">
<p>文字は文字種に分類することができ、これらに対してマッチングを行うことができます。<br>
またその分類と逆の分類(その分類を除いたものすべて)に対してマッチングを行うこともできます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>種類</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>正規表現</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>逆</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>正規表現</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">単語構成文字 (文字、数字、アンダースコア)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\w</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">非単語構成文字</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\W</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">数字</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">非数字</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\D</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">空白文字</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">非空白文字</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\S</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">水平空白文字</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\h</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">非水平空白文字</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\H</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">垂直空白文字</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\v</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">非垂直空白文字</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\V</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">タブ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\t</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">非タブ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\T</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">改行</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\n</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">非改行</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\N</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">if</span> <span class="tok-s">&quot;John123&quot;</span> ~~<span class="tok-sr"> / \d /</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&quot;This is not a valid name, numbers are not allowed&quot;</span>;
} <span class="tok-k">else</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&quot;This is a valid name&quot;</span>
}
<span class="tok-k">if</span> <span class="tok-s">&quot;John-Doe&quot;</span> ~~<span class="tok-sr"> / \s /</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&quot;This string contains whitespace&quot;</span>;
} <span class="tok-k">else</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&quot;This string doesn&#39;t contain whitespace&quot;</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ユニコードのプロパティ">11.4. ユニコードのプロパティ</h3>
<div class="paragraph">
<p>前節での文字種に対するマッチングは便利です。<br>
そうはいっても、もっと系統的なアプローチはユニコードのプロパティを使うことです。<br>
標準ASCII文字コードの範囲内の文字種に対しても、そうでない文字種に対してもマッチングができるようになります。<br>
ユニコードのプロパティは <code>&lt;: &gt;</code> で囲まれます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">if</span> <span class="tok-s">&quot;Devangari Numbers १२३&quot;</span> ~~<span class="tok-sr"> / &lt;:N&gt; /</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&quot;Contains a number&quot;</span>;
} <span class="tok-k">else</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&quot;Doesn&#39;t contain a number&quot;</span>
}
<span class="tok-k">if</span> <span class="tok-s">&quot;Привет, Иван.&quot;</span> ~~<span class="tok-sr"> / &lt;:Lu&gt; /</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&quot;Contains an uppercase letter&quot;</span>;
} <span class="tok-k">else</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&quot;Doesn&#39;t contain an upper case letter&quot;</span>
}
<span class="tok-k">if</span> <span class="tok-s">&quot;John-Doe&quot;</span> ~~<span class="tok-sr"> / &lt;:Pd&gt; /</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&quot;Contains a dash&quot;</span>;
} <span class="tok-k">else</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&quot;Doesn&#39;t contain a dash&quot;</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ワイルドカード">11.5. ワイルドカード</h3>
<div class="paragraph">
<p>正規表現ではワイルドカードも用いることができます。</p>
</div>
<div class="paragraph">
<p>ドット <code>.</code> は任意の一文字を意味します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">if</span> <span class="tok-s">&#39;abc&#39;</span> ~~ <span class="tok-sr">m/ a.c /</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;Match&quot;</span>;
}
<span class="tok-k">if</span> <span class="tok-s">&#39;a2c&#39;</span> ~~ <span class="tok-sr">m/ a.c /</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;Match&quot;</span>;
}
<span class="tok-k">if</span> <span class="tok-s">&#39;ac&#39;</span> ~~ <span class="tok-sr">m/ a.c /</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;Match&quot;</span>;
  } <span class="tok-k">else</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;No Match&quot;</span>;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_量指定子">11.6. 量指定子</h3>
<div class="paragraph">
<p>量指定子は文字の後に付けられ、その文字が何回出現するのか指定するために使われます。</p>
</div>
<div class="paragraph">
<p>クエスチョンマーク <code>?</code> は0か1回を意味します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">if</span> <span class="tok-s">&#39;ac&#39;</span> ~~ <span class="tok-sr">m/ a?c /</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;Match&quot;</span>;
} <span class="tok-k">else</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;No Match&quot;</span>;
}
<span class="tok-k">if</span> <span class="tok-s">&#39;c&#39;</span> ~~ <span class="tok-sr">m/ a?c /</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;Match&quot;</span>;
} <span class="tok-k">else</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;No Match&quot;</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>スター <code>*</code> は0か複数回を意味します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">if</span> <span class="tok-s">&#39;az&#39;</span> ~~ <span class="tok-sr">m/ a*z /</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;Match&quot;</span>;
} <span class="tok-k">else</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;No Match&quot;</span>;
}
<span class="tok-k">if</span> <span class="tok-s">&#39;aaz&#39;</span> ~~ <span class="tok-sr">m/ a*z /</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;Match&quot;</span>;
} <span class="tok-k">else</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;No Match&quot;</span>;
}
<span class="tok-k">if</span> <span class="tok-s">&#39;aaaaaaaaaaz&#39;</span> ~~ <span class="tok-sr">m/ a*z /</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;Match&quot;</span>;
} <span class="tok-k">else</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;No Match&quot;</span>;
}
<span class="tok-k">if</span> <span class="tok-s">&#39;z&#39;</span> ~~ <span class="tok-sr">m/ a*z /</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;Match&quot;</span>;
} <span class="tok-k">else</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;No Match&quot;</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>+</code> は少なくとも一回を意味します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">if</span> <span class="tok-s">&#39;az&#39;</span> ~~ <span class="tok-sr">m/ a+z /</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;Match&quot;</span>;
} <span class="tok-k">else</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;No Match&quot;</span>;
}
<span class="tok-k">if</span> <span class="tok-s">&#39;aaz&#39;</span> ~~ <span class="tok-sr">m/ a+z /</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;Match&quot;</span>;
} <span class="tok-k">else</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;No Match&quot;</span>;
}
<span class="tok-k">if</span> <span class="tok-s">&#39;aaaaaaaaaaz&#39;</span> ~~ <span class="tok-sr">m/ a+z /</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;Match&quot;</span>;
} <span class="tok-k">else</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;No Match&quot;</span>;
}
<span class="tok-k">if</span> <span class="tok-s">&#39;z&#39;</span> ~~ <span class="tok-sr">m/ a+z /</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;Match&quot;</span>;
} <span class="tok-k">else</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;No Match&quot;</span>;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_マッチ結果">11.7. マッチ結果</h3>
<div class="paragraph">
<p>正規表現に対する文字列のマッチング処理が成功したときはいつでも、
そのマッチ結果は特別な変数 <code>$/</code> に格納されます。</p>
</div>
<div class="listingblock">
<div class="title">スクリプト</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">if</span> <span class="tok-s">&#39;Rakudo is a Perl 6 compiler&#39;</span> ~~ <span class="tok-sr">m/:s Perl 6/</span> {
    <span class="tok-nb">say</span> <span class="tok-s">&quot;The match is: &quot;</span> ~ <span class="tok-vg">$/</span>;
    <span class="tok-nb">say</span> <span class="tok-s">&quot;The string before the match is: &quot;</span> ~ <span class="tok-vg">$/</span>.<span class="tok-nb">prematch</span>;
    <span class="tok-nb">say</span> <span class="tok-s">&quot;The string after the match is: &quot;</span> ~ <span class="tok-vg">$/</span>.<span class="tok-nb">postmatch</span>;
    <span class="tok-nb">say</span> <span class="tok-s">&quot;The matching string starts at position: &quot;</span> ~ <span class="tok-vg">$/</span>.<span class="tok-nb">from</span>;
    <span class="tok-nb">say</span> <span class="tok-s">&quot;The matching string ends at position: &quot;</span> ~ <span class="tok-vg">$/</span>.<span class="tok-nb">to</span>;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">出力</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-n">The</span> <span class="tok-nb">match</span> <span class="tok-n">is:</span> <span class="tok-nb">Perl</span> <span class="tok-mi">6</span>
<span class="tok-n">The</span> <span class="tok-n">string</span> <span class="tok-o">before</span> <span class="tok-n">the</span> <span class="tok-nb">match</span> <span class="tok-n">is:</span> <span class="tok-n">Rakudo</span> <span class="tok-k">is</span> <span class="tok-n">a</span>
<span class="tok-n">The</span> <span class="tok-n">string</span> <span class="tok-nb">after</span> <span class="tok-n">the</span> <span class="tok-nb">match</span> <span class="tok-n">is:</span>  <span class="tok-nb">compiler</span>
<span class="tok-n">The</span> <span class="tok-n">matching</span> <span class="tok-n">string</span> <span class="tok-n">starts</span> <span class="tok-nb">at</span> <span class="tok-n">position:</span> <span class="tok-mi">12</span>
<span class="tok-n">The</span> <span class="tok-n">matching</span> <span class="tok-n">string</span> <span class="tok-n">ends</span> <span class="tok-nb">at</span> <span class="tok-n">position:</span> <span class="tok-mi">18</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">説明</div>
<p><code>$/</code> は <em>マッチオブジェクト</em> (正規表現がマッチした文字列) を返します<br>
<em>マッチオブジェクト</em> から次のようなメソッドを呼ぶことができます:<br>
<code>.prematch</code> はマッチの前の文字列を返します。<br>
<code>.postmatch</code> はマッチの後ろの文字列を返します。<br>
<code>.from</code> はマッチの開始位置を返します。<br>
<code>.to</code> はマッチの終了位置を返します。<br></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
デフォルトでは正規表現の定義における空白文字は無視されます。<br>
もし、空白文字を含んだ正規表現に対してマッチさせたいのであれば明示的にそうする必要があります。<br>
正規表現 <code>m/:s Perl 6/</code> の中の <code>:s</code> は空白文字も考慮するように強制します。<br>
別の選択肢としては <code>m/ Perl\s6 /</code> と書くこともできます。<code>\s</code> は空白文字を表します。<br>
もし正規表現が空白文字を一つより多く含んでいるなら、<code>:s</code> を使うと <code>\s</code> を空白文字が出現する箇所でいちいち書くのと比べると良い選択肢です。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_例">11.8. 例</h3>
<div class="paragraph">
<p>emailが正しいかどうか調べましょう。<br>
この例のために正しいemailのアドレスは次のような形式であるとしましょう:
ファーストネーム [dot] ラストネーム [at] 会社名 [dot] (com/org/net)</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
この例で使われている正規表現はあまり正確ではありません。<br>
Rakuにおける正規表現の機能を説明することが唯一の目的です。
プロダクションでそのまま使わないでください。
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">スクリプト</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$email</span> = <span class="tok-s">&#39;john.doe@perl6.org&#39;</span>;
<span class="tok-k">my</span> <span class="tok-nv">$regex</span> =<span class="tok-sr"> / &lt;:L&gt;+\.&lt;:L&gt;+\@&lt;:L+:N&gt;+\.&lt;:L&gt;+ /</span>;

<span class="tok-k">if</span> <span class="tok-nv">$email</span> ~~ <span class="tok-nv">$regex</span> {
  <span class="tok-nb">say</span> <span class="tok-vg">$/</span> ~ <span class="tok-s">&quot; is a valid email&quot;</span>;
} <span class="tok-k">else</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&quot;This is not a valid email&quot;</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">出力</div>
<p><code>john.doe@perl6.org is a valid email</code></p>
</div>
<div class="paragraph">
<div class="title">説明</div>
<p><code>&lt;:L&gt;</code> は一つの文字にマッチします<br>
<code>&lt;:L&gt;` は一つ以上の文字にマッチします +
`\.` は一つの[dot] 文字にマッチします +
`\@` は一つの[at] 文字にマッチします +
`&lt;:L:N&gt;</code> は一つの文字か数字にマッチします<br>
<code>&lt;:L+:N&gt;+</code> は一つの文字か数字の繰り返しにマッチします<br></p>
</div>
<div class="paragraph">
<p>この正規表現は次のように分解することができます。:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>ファーストネーム</strong> <code>&lt;:L&gt;+</code></p>
</li>
<li>
<p><strong>[dot]</strong> <code>\.</code></p>
</li>
<li>
<p><strong>ラストネーム</strong> <code>&lt;:L&gt;+</code></p>
</li>
<li>
<p><strong>[at]</strong> <code>\@</code></p>
</li>
<li>
<p><strong>会社名</strong> <code>&lt;:L+:N&gt;+</code></p>
</li>
<li>
<p><strong>[dot]</strong> <code>\.</code></p>
</li>
<li>
<p><strong>com/org/net</strong> <code>&lt;:L&gt;+</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">また、ある正規表現は複数の名前付き正規表現に分解することができます</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$email</span> = <span class="tok-s">&#39;john.doe@perl6.org&#39;</span>;
<span class="tok-k">my</span> <span class="tok-k">regex</span><span class="tok-n"> many-letters</span> {<span class="tok-sr"> &lt;:L&gt;+ </span>};
<span class="tok-k">my</span> <span class="tok-k">regex</span><span class="tok-n"> dot</span> {<span class="tok-sr"> \. </span>};
<span class="tok-k">my</span> <span class="tok-k">regex</span><span class="tok-n"> at</span> {<span class="tok-sr"> \@ </span>};
<span class="tok-k">my</span> <span class="tok-k">regex</span><span class="tok-n"> many-letters-numbers</span> {<span class="tok-sr"> &lt;:L+:N&gt;+ </span>};

<span class="tok-k">if</span> <span class="tok-nv">$email</span> ~~<span class="tok-sr"> / &lt;many-letters&gt; &lt;dot&gt; &lt;many-letters&gt; &lt;at&gt; &lt;many-letters-numbers&gt; &lt;dot&gt; &lt;many-letters&gt; /</span> {
  <span class="tok-nb">say</span> <span class="tok-vg">$/</span> ~ <span class="tok-s">&quot; is a valid email&quot;</span>;
} <span class="tok-k">else</span> {
  <span class="tok-nb">say</span> <span class="tok-s">&quot;This is not a valid email&quot;</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>名前付き正規表現は次のような文法で定義されます: <code>my regex regex-name { regex definition }</code><br>
名前付き正規表現は次のような文法で呼び出されます: <code>&lt;regex-name&gt;</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
もしもっと正規表現について知りたいのであれば、次のURLを参照するのをすすめます <a href="https://docs.raku.org/language/regexes" class="bare">https://docs.raku.org/language/regexes</a>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rakuのモジュール">12. Rakuのモジュール</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Rakuは汎用プログラミング言語です。下記を含む多数のタスクに取り組むのに使うことができます。
テキスト操作、グラフィックス、ウェブ、データベース、ネットワークプロトコルなど。</p>
</div>
<div class="paragraph">
<p>再利用性はとても重要な概念です、それによってプログラマは新しいタスクに取り組もうとするたびに車輪の再発明を行う必要がなくなります。</p>
</div>
<div class="paragraph">
<p>Rakuはでは <strong>モジュール</strong> の作成と再配布ができます。それぞれのモジュールはインストールされれば再利用できる機能のパッケージです。</p>
</div>
<div class="paragraph">
<p><em>Zef</em> はRakudo Starに付属しているモジュール管理ツールです。</p>
</div>
<div class="paragraph">
<p>特定のモジュールをインストールするには、次のコマンドをターミナルで打ってください:</p>
</div>
<div class="paragraph">
<p><code>zef install "モジュールの名前"</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Rakuのモジュールの一覧を見るには次のURLを参照してください: <a href="https://modules.perl6.org/" class="bare">https://modules.perl6.org/</a>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_モジュールの使用">12.1. モジュールの使用</h3>
<div class="paragraph">
<p>MD5は128ビットのハッシュ値を生成する暗号学的ハッシュ関数です。<br>
MD5は、データベースに格納されているパスワードの暗号化など様々なアプリケーションで使われています。
新たなユーザーが登録されるとき、資格情報は平文として保存されずに <em>ハッシュ</em> 化されます。
この背景にある根拠は、もしDBがハッキングの被害にあっていたとしても、攻撃者はパスワードが何であるかを知ることができないということです。</p>
</div>
<div class="paragraph">
<p>幸運なことに、MD5アルゴリズムを実装する必要はありません。MD5アルゴリズムを実装したRakuモジュールがすでにあります。<br>
インストールしましょう:<br>
<code>zef install Digest::MD5</code></p>
</div>
<div class="paragraph">
<p>では、次のスクリプトを実行してください:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">use</span> <span class="tok-n">Digest::MD5</span>;
<span class="tok-k">my</span> <span class="tok-nv">$password</span> = <span class="tok-s">&quot;password123&quot;</span>;
<span class="tok-k">my</span> <span class="tok-nv">$hashed-password</span> = <span class="tok-n">Digest::MD5</span>.<span class="tok-nb">new</span>.<span class="tok-n">md5_hex</span>(<span class="tok-nv">$password</span>);

<span class="tok-nb">say</span> <span class="tok-nv">$hashed-password</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>ハッシュを生成する <code>md5_hex()</code> 関数を実行するために、この関数の実行に必要なモジュールをロードしなくてはなりません。<br>
 <code>use</code> キーワードはスクリプトの中で使いたいモジュールをロードします。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
実用的にはMD5ハッシュ単独では不十分です、なぜなら辞書攻撃を受けやすいからです。<br>
サルトと組み合わせるべきです。 <a href="https://en.wikipedia.org/wiki/Salt_(cryptography)">https://en.wikipedia.org/wiki/Salt_(cryptography)</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ユニコード">13. ユニコード</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ユニコードは標準的なエンコーディングで、世界のほとんどの書込システムにおいてテキストを表現します。<br>
UTF-8は、ユニコードにおける、すべての文字や符号位置をエンコーディングすることができる文字エンコードです。</p>
</div>
<div class="paragraph">
<p>文字は次によって定義されます:<br>
<strong>書記素</strong>: 視覚的表現。<br>
<strong>符号位置</strong>: 文字に割り当てられた数。<br>
<strong>符号位置の名前</strong>: 文字に割り当てられた名前。</p>
</div>
<div class="sect2">
<h3 id="_ユニコードの使用">13.1. ユニコードの使用</h3>
<div class="listingblock">
<div class="title">ユニコードを使ってどうやって文字を出力することができるのか見てみましょう</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-nb">say</span> <span class="tok-s">&quot;a&quot;</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;\x0061&quot;</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;\c[LATIN SMALL LETTER A]&quot;</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>上記の三つの行は文字を作るためにそれぞれ異なった方法をとっています:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>直接文字を書く (書記素)</p>
</li>
<li>
<p><code>\x</code> と符号位置を使う</p>
</li>
<li>
<p><code>\c</code> と符号位置の名前を使う</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">では、スマイリーを出力してみましょう</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-nb">say</span> <span class="tok-s">&quot;☺&quot;</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;\x263a&quot;</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;\c[WHITE SMILING FACE]&quot;</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">二つの符号位置を組み合わせている例です</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-nb">say</span> <span class="tok-s">&quot;á&quot;</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;\x00e1&quot;</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;\x0061\x0301&quot;</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;\c[LATIN SMALL LETTER A WITH ACUTE]&quot;</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>a</code> は次のように書けます:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ユニークな符号位置 <code>\x00e1</code> を使う</p>
</li>
<li>
<p>もしくは <code>a</code> とアキュート・アクセントの符号位置を組み合わせる <code>\x0061\x0301</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">いくつかのメソッドを使うことができます:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-nb">say</span> <span class="tok-s">&quot;á&quot;</span>.<span class="tok-nb">NFC</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;á&quot;</span>.<span class="tok-nb">NFD</span>;
<span class="tok-nb">say</span> <span class="tok-s">&quot;á&quot;</span>.<span class="tok-nb">uniname</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><code>出力</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-n">NFC:0x</span><span class="tok-s">&lt;00e1&gt;</span>
<span class="tok-n">NFD:0x</span><span class="tok-s">&lt;0061 0301&gt;</span>
<span class="tok-n">LATIN</span> <span class="tok-n">SMALL</span> <span class="tok-n">LETTER</span> <span class="tok-n">A</span> <span class="tok-n">WITH</span> <span class="tok-n">ACUTE</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>NFC</code> はユニークな符号位置を返します。<br>
<code>NFD</code> は文字を分解し、それぞれの符号位置を返します。<br>
<code>uniname</code> は符号位置の名前を返します。</p>
</div>
<div class="listingblock">
<div class="title">ユニコード文字は識別子として用いることができます:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$Δ</span> = <span class="tok-mi">1</span>;
<span class="tok-nv">$Δ</span>++;
<span class="tok-nb">say</span> <span class="tok-nv">$Δ</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">ユニコード文字で算数をすることができます:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">$var</span> = <span class="tok-mi">2</span> + <span class="tok-n">⅒</span>;
<span class="tok-nb">say</span> <span class="tok-nv">$var</span>;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ユニコードを考慮した操作">13.2. ユニコードを考慮した操作</h3>
<div class="sect3">
<h4 id="_数値">13.2.1. 数値</h4>
<div class="paragraph">
<p>アラビア数字は十個あります: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9
この数字は世界でもっとも使われているものです。</p>
</div>
<div class="paragraph">
<p>とはいえ、世界には異なる数字を使うような少数派の地域があります。</p>
</div>
<div class="paragraph">
<p>アラビア数字以外の数字を使うときに特別な注意は必要ありません。
すべてのメソッド/演算子は期待通りに動きます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-nb">say</span> (<span class="tok-mi">٤</span>,<span class="tok-mi">٥</span>,<span class="tok-mi">٦</span>,<span class="tok-mi">1</span>,<span class="tok-mi">2</span>,<span class="tok-mi">3</span>).<span class="tok-nb">sort</span>; <span class="tok-c1"># (1 2 3 4 5 6)</span>
<span class="tok-nb">say</span> <span class="tok-mi">1</span> + <span class="tok-mi">٩</span>;              <span class="tok-c1"># 10</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_文字列">13.2.2. 文字列</h4>
<div class="paragraph">
<p>一般的な文字列操作をしようとしたとき、特に比較やソートのときに、常に求めていた結果を得ることができるわけではないかもしれません。</p>
</div>
<div class="sect4">
<h5 id="_比較">比較</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-nb">say</span> <span class="tok-s">&#39;a&#39;</span> <span class="tok-o">cmp</span> <span class="tok-s">&#39;B&#39;</span>; <span class="tok-c1"># More</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>上記の例では <code>a</code> は <code>B</code> よりも大きいということを示しています。
小文字の <code>a</code> の符号位置は大文字の <code>B</code> の符号位置よりも大きいというのがその理由です。</p>
</div>
<div class="paragraph">
<p>技術的には正しい一方、ひょっとしたら求めていたものとは違うかもしれません。</p>
</div>
<div class="paragraph">
<p>幸運なことにRakuは <a href="http://unicode.org/reports/tr10/">ユニコード照合アルゴリズム</a> を実装したメソッド/演算子を持っています。<br>
その一つが <code>unicmp</code> です。これは上記で示した <code>cmp</code> のようにふるまいますがこのアルゴリズムを使用する点が異なります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-nb">say</span> <span class="tok-s">&#39;a&#39;</span> <span class="tok-o">unicmp</span> <span class="tok-s">&#39;B&#39;</span>; <span class="tok-c1"># Less</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>見てわかる通り、 <code>unicmp</code> 演算子を使うことで <code>a</code> は <code>B</code> より小さいという期待通りの結果が得られました。</p>
</div>
</div>
<div class="sect4">
<h5 id="_ソート">ソート</h5>
<div class="paragraph">
<p>符号位置を利用したソートにおいて <code>sort</code> メソッドの他の選択肢として、Rakuは <a href="http://unicode.org/reports/tr10/">ユニコード照合アルゴリズム</a> を実装した <code>collate</code> メソッドを提供しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-nb">say</span> (<span class="tok-s">&#39;a&#39;</span>,<span class="tok-s">&#39;b&#39;</span>,<span class="tok-s">&#39;c&#39;</span>,<span class="tok-s">&#39;D&#39;</span>,<span class="tok-s">&#39;E&#39;</span>,<span class="tok-s">&#39;F&#39;</span>).<span class="tok-nb">sort</span>;    <span class="tok-c1"># (D E F a b c)</span>
<span class="tok-nb">say</span> (<span class="tok-s">&#39;a&#39;</span>,<span class="tok-s">&#39;b&#39;</span>,<span class="tok-s">&#39;c&#39;</span>,<span class="tok-s">&#39;D&#39;</span>,<span class="tok-s">&#39;E&#39;</span>,<span class="tok-s">&#39;F&#39;</span>).<span class="tok-nb">collate</span>; <span class="tok-c1"># (a b c D E F)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_並列処理並行性非同期性">14. 並列処理、並行性、非同期性</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_並列処理">14.1. 並列処理</h3>
<div class="paragraph">
<p>一般的な状況では、プログラムのすべてのタスクは上から順に実行されます。<br>
もし、たくさんの時間がかかるようなことを行おうとしているのでないかぎりは問題にはなりません。</p>
</div>
<div class="paragraph">
<p>ありがたいことに、Rakuには並列実行のための機能があります。<br>
現在のところ、次の二つの事柄のうちの一つを意味するということを頭にとどめておくことが重要です:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>タスクの並列処理</strong>: 二つ(もしくはそれ以上)の独立した式が並列実行されます。</p>
</li>
<li>
<p><strong>データの並列処理</strong>: 一つの式が要素のリストに対して並列的に反復処理を行います。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>まずは後者の方から始めましょう.</p>
</div>
<div class="sect3">
<h4 id="_データの並列処理">14.1.1. データの並列処理</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@array</span> = <span class="tok-mi">0</span><span class="tok-o">..</span><span class="tok-mi">50000</span>;                     <span class="tok-c1"># 配列の作成</span>
<span class="tok-k">my</span> <span class="tok-nv">@result</span> = <span class="tok-nv">@array</span>.<span class="tok-n">map</span>({ <span class="tok-nb">is-prime</span> <span class="tok-nv">$_</span> });   <span class="tok-c1"># それぞれの配列の要素に対して is-prime を呼ぶ</span>
<span class="tok-nb">say</span> <span class="tok-nb">now</span> - <span class="tok-k">INIT</span> <span class="tok-nb">now</span>;                         <span class="tok-c1"># スクリプトの処理が完了するまでにかかる時間を出力</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">上記の例について考えてみましょう:</div>
<p><code>@array.map({ is-prime $_ })</code> という操作を行っているだけです<br>
配列のそれぞれの要素に対して <code>is-prime</code> サブルーチンが経時的に呼び出されています:
<code>is-prime @array[0]</code>、<code>is-prime @array[1]</code> 、<code>is-prime @array[2]</code> ・・・の順です</p>
</div>
<div class="listingblock">
<div class="title">幸運なことに <code>is-prime</code> を複数の配列の要素に対して同時に呼び出すことができます:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@array</span> = <span class="tok-mi">0</span><span class="tok-o">..</span><span class="tok-mi">50000</span>;                         <span class="tok-c1"># 配列の作成</span>
<span class="tok-k">my</span> <span class="tok-nv">@result</span> = <span class="tok-nv">@array</span>.<span class="tok-nb">race</span>.<span class="tok-n">map</span>({ <span class="tok-nb">is-prime</span> <span class="tok-nv">$_</span> });  <span class="tok-c1"># それぞれの配列の要素に対して is-prime を呼ぶ</span>
<span class="tok-nb">say</span> <span class="tok-nb">now</span> - <span class="tok-k">INIT</span> <span class="tok-nb">now</span>;                             <span class="tok-c1"># スクリプトの処理が完了するまでにかかる時間を出力</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>式の中で <code>race</code> を使用していることに注目してください。
このメソッドは配列に対する並列的な反復処理を可能にします。</p>
</div>
<div class="paragraph">
<p>両方の例( <code>race</code> の有る方と無い方)を実行したのち、両方のスクリプトにおいて処理が完了するのにかかる時間を比べてください。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>race</code> は要素の順番を保ちません。もし要素の順番を保ちたいのであれば、代わりに <code>hyper</code> を用いてください。</p>
</div>
<div class="listingblock">
<div class="title">race</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@array</span> = <span class="tok-mi">1</span><span class="tok-o">..</span><span class="tok-mi">1000</span>;
<span class="tok-k">my</span> <span class="tok-nv">@result</span> = <span class="tok-nv">@array</span>.<span class="tok-nb">race</span>.<span class="tok-n">map</span>( {<span class="tok-nv">$_</span> + <span class="tok-mi">1</span>} );
.<span class="tok-nb">say</span> <span class="tok-k">for</span> <span class="tok-nv">@result</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">hyper</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@array</span> = <span class="tok-mi">1</span><span class="tok-o">..</span><span class="tok-mi">1000</span>;
<span class="tok-k">my</span> <span class="tok-nv">@result</span> = <span class="tok-nv">@array</span>.<span class="tok-nb">hyper</span>.<span class="tok-n">map</span>( {<span class="tok-nv">$_</span> + <span class="tok-mi">1</span>} );
.<span class="tok-nb">say</span> <span class="tok-k">for</span> <span class="tok-nv">@result</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>もし両方の例を実行したなら、片方はソートされていてもう片方はソートされていないことに気づいたはずです。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_タスクの並列処理">14.1.2. タスクの並列処理</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@array1</span> = <span class="tok-mi">0</span><span class="tok-o">..</span><span class="tok-mi">49999</span>;
<span class="tok-k">my</span> <span class="tok-nv">@array2</span> = <span class="tok-mi">2</span><span class="tok-o">..</span><span class="tok-mi">50001</span>;

<span class="tok-k">my</span> <span class="tok-nv">@result1</span> = <span class="tok-nv">@array1</span>.<span class="tok-n">map</span>( {<span class="tok-nb">is-prime</span>(<span class="tok-nv">$_</span> + <span class="tok-mi">1</span>)} );
<span class="tok-k">my</span> <span class="tok-nv">@result2</span> = <span class="tok-nv">@array2</span>.<span class="tok-n">map</span>( {<span class="tok-nb">is-prime</span>(<span class="tok-nv">$_</span> - <span class="tok-mi">1</span>)} );

<span class="tok-nb">say</span> <span class="tok-nv">@result1</span> <span class="tok-o">eqv</span> <span class="tok-nv">@result2</span>;

<span class="tok-nb">say</span> <span class="tok-nb">now</span> - <span class="tok-k">INIT</span> <span class="tok-nb">now</span>;</code></pre>
</div>
</div>
<div class="olist arabic">
<div class="title">上記の例について考えてみてください:</div>
<ol class="arabic">
<li>
<p>二つの配列を定義しました</p>
</li>
<li>
<p>それぞれの配列に対して異なる操作を適用し、結果を保存しました</p>
</li>
<li>
<p>そして、両方の結果が同じであるかを調べました</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>このスクリプトは <code>@array1.map( {is-prime($_ + 1)} )</code> が終了するのを待っています<br>
それから、<code>@array2.map( {is-prime($_ - 1)} )</code> を評価します。</p>
</div>
<div class="paragraph">
<p>それぞれの配列に対して適用された操作の両方が互いに依存していません。</p>
</div>
<div class="listingblock">
<div class="title">同時に実行してみたらどうでしょう？</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">my</span> <span class="tok-nv">@array1</span> = <span class="tok-mi">0</span><span class="tok-o">..</span><span class="tok-mi">49999</span>;
<span class="tok-k">my</span> <span class="tok-nv">@array2</span> = <span class="tok-mi">2</span><span class="tok-o">..</span><span class="tok-mi">50001</span>;

<span class="tok-k">my</span> <span class="tok-nv">$promise1</span> = <span class="tok-nb">start</span> <span class="tok-nv">@array1</span>.<span class="tok-n">map</span>( {<span class="tok-nb">is-prime</span>(<span class="tok-nv">$_</span> + <span class="tok-mi">1</span>)} ).<span class="tok-nb">eager</span>;
<span class="tok-k">my</span> <span class="tok-nv">$promise2</span> = <span class="tok-nb">start</span> <span class="tok-nv">@array2</span>.<span class="tok-n">map</span>( {<span class="tok-nb">is-prime</span>(<span class="tok-nv">$_</span> - <span class="tok-mi">1</span>)} ).<span class="tok-nb">eager</span>;

<span class="tok-k">my</span> <span class="tok-nv">@result1</span> = <span class="tok-nb">await</span> <span class="tok-nv">$promise1</span>;
<span class="tok-k">my</span> <span class="tok-nv">@result2</span> = <span class="tok-nb">await</span> <span class="tok-nv">$promise2</span>;

<span class="tok-nb">say</span> <span class="tok-nv">@result1</span> <span class="tok-o">eqv</span> <span class="tok-nv">@result2</span>;

<span class="tok-nb">say</span> <span class="tok-nb">now</span> - <span class="tok-k">INIT</span> <span class="tok-nb">now</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">説明</div>
<p><code>start</code> サブルーチンはコードを評価し、<code>Promise型のオブジェクト</code> (端的には <code>約束</code> )を返します。<br>
もしコードが正しく評価されたのなら <em>約束</em> は <strong>守られ</strong> ているでしょう。<br>
もしコードが例外を投げたのなら <em>約束</em> は <strong>破られ</strong> ているでしょう。</p>
</div>
<div class="paragraph">
<p><code>await</code> サブルーチンは <strong>約束</strong> を待ちます。<br>
もし約束が <strong>守られた</strong> なら返された値を取得するでしょう。<br>
もし約束が <strong>破られた</strong> なら投げられた例外を取得するでしょう。</p>
</div>
<div class="paragraph">
<p>それぞれのスクリプトにおいて処理が終了するのにかかった時間を調べてください。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
並列処理にはスレッディングのオーバーヘッドがあります。もしオーバーヘッドが計算速度で相殺されないのなら、スクリプトが遅くなってしまったように見えるでしょう。<br>
これが <code>race</code> 、 <code>hyper</code> 、 <code>start</code> 、 <code>await</code> をいたってシンプルなスクリプトに対して用いると実際には遅くなってしまう理由です。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_並行性と非同期性">14.2. 並行性と非同期性</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
並行/非同期プログラミングについてもっと情報を知りたいのなら、次のURLを参照してください: <a href="https://docs.raku.org/language/concurrency" class="bare">https://docs.raku.org/language/concurrency</a>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ネイティブコールインタフェース">15. ネイティブコールインタフェース</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Rakuではネイティブコール (Native Call) インタフェースを用いて、Cのライブラリを使うことができます。</p>
</div>
<div class="paragraph">
<p><code>NativeCall</code> はRakuと一緒に提供されている標準モジュールです</p>
</div>
<div class="sect2">
<h3 id="_関数の呼び出し">15.1. 関数の呼び出し</h3>
<div class="paragraph">
<p><code>hellofromc</code> という関数が定義されている下記コードについて考えてみましょう。
この関数はターミナルに <code>Hello from C</code> と表示します。
この関数は引数を受け付けませんし返り値もありません。</p>
</div>
<div class="listingblock">
<div class="title">ncitest.c</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-cp">#include</span><span class="tok-w"> </span><span class="tok-cpf">&lt;stdio.h&gt;</span>

<span class="tok-kt">void</span><span class="tok-w"> </span><span class="tok-nf">hellofromc</span><span class="tok-w"> </span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">  </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;Hello from C</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">);</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>OSに応じて、次のコマンドを実行し、上記のCのコードをライブラリへとコンパイルしてください。</p>
</div>
<div class="listingblock">
<div class="title">Linux:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-n">gcc</span> -<span class="tok-n">c</span> -<span class="tok-n">fpic</span> <span class="tok-n">ncitest</span>.<span class="tok-n">c</span>
<span class="tok-n">gcc</span> -<span class="tok-n">shared</span> -<span class="tok-n">o</span> <span class="tok-n">libncitest</span>.<span class="tok-nb">so</span> <span class="tok-n">ncitest</span>.<span class="tok-n">o</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Windows:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-n">gcc</span> -<span class="tok-n">c</span> <span class="tok-n">ncitest</span>.<span class="tok-n">c</span>
<span class="tok-n">gcc</span> -<span class="tok-n">shared</span> -<span class="tok-n">o</span> <span class="tok-n">ncitest</span>.<span class="tok-n">dll</span> <span class="tok-n">ncitest</span>.<span class="tok-n">o</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On macOS:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-n">gcc</span> -<span class="tok-n">dynamiclib</span> -<span class="tok-n">o</span> <span class="tok-n">libncitest</span>.<span class="tok-n">dylib</span> <span class="tok-n">ncitest</span>.<span class="tok-n">c</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Cのライブラリをコンパイルしたのと同じディレクトリで、次のコードを含むRakuのファイルを作り、実行してください。</p>
</div>
<div class="listingblock">
<div class="title">ncitest.raku</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">use</span> <span class="tok-n">NativeCall</span>;

<span class="tok-k">constant</span> <span class="tok-n">LIBPATH</span> = <span class="tok-s">&quot;$*CWD/ncitest&quot;</span>;
<span class="tok-k">sub</span> <span class="tok-n">hellofromc</span>() <span class="tok-k">is</span> <span class="tok-k">native</span>(<span class="tok-n">LIBPATH</span>) { * }

<span class="tok-n">hellofromc</span>();</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">説明:</div>
<p>まずはじめに、 <code>NativeCall</code> モジュールを使うということを宣言しました。<br>
次に、Cのライブラリへのパスを保持している定数 <code>LIBPATH</code> を作りました。<br>
<code>$*CWD</code> はカレントディレクトリを返すということに注意してください。<br>
それから、 <code>hellofromc()</code> という新しいRakuのサブルーチンを作りました。
このサブルーチンは、<code>LIBPATH</code> 下のCのライブラリの同じ名前を持った対応する関数のラッパーとしてふるまうでしょう。<br>
<code>is native</code> トレイトを用いることでこれを実現できます。<br>
さいごにRakuのサブルーチンを呼び出しました。<br></p>
</div>
<div class="paragraph">
<p>突き詰めると、すべては <code>is native</code> を使用して、Cのライブラリと同じ名前を持つサブルーチンを宣言することに帰着します。</p>
</div>
</div>
<div class="sect2">
<h3 id="_関数の名前の変更">15.2. 関数の名前の変更</h3>
<div class="paragraph">
<p>前節では、<code>is native</code> トレイトを使って同じ名前を持ったRakuのサブルーチンでラップすることで、どのようにしてCの関数を呼び出せるかを見てきました。</p>
</div>
<div class="paragraph">
<p>場合によっては、Rakuのサブルーチンの名前を変えたくなるかもしれません。<br>
そうしたいときは、 <code>is symbol</code> トレイトを使います。</p>
</div>
<div class="paragraph">
<p>上記のRakuのスクリプトを変更し、 Rakuのサブルーチンの名前を <code>hellofromc</code> の代わりに <code>hello</code> と付けてみましょう。</p>
</div>
<div class="listingblock">
<div class="title">ncitest.raku</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">use</span> <span class="tok-n">NativeCall</span>;

<span class="tok-k">constant</span> <span class="tok-n">LIBPATH</span> = <span class="tok-s">&quot;$*CWD/ncitest&quot;</span>;
<span class="tok-k">sub</span> <span class="tok-n">hello</span>() <span class="tok-k">is</span> <span class="tok-k">native</span>(<span class="tok-n">LIBPATH</span>) <span class="tok-k">is</span> <span class="tok-k">symbol</span>(<span class="tok-s">&#39;hellofromc&#39;</span>) { * }

<span class="tok-n">hello</span>();</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">説明:</div>
<p>この場合RakuのサブルーチンはCの対応する関数と異なる名前を持っています。
元のCの関数の名前を用いて <code>is symbol</code> トレイトを使うべきです。</p>
</div>
</div>
<div class="sect2">
<h3 id="_引数渡し">15.3. 引数渡し</h3>
<div class="paragraph">
<p>次の改変されたCのライブラリをコンパイルし、その下のRakuのスクリプトを実行しましょう。<br>
どのようにしてCとRakuのコードの両方を、文字列を受け取るために改変したかについて注目してください。 (Cでは <code>char*</code> で、Rakuでは <code>Str</code> です)</p>
</div>
<div class="listingblock">
<div class="title">ncitest.c</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-cp">#include</span><span class="tok-w"> </span><span class="tok-cpf">&lt;stdio.h&gt;</span>

<span class="tok-kt">void</span><span class="tok-w"> </span><span class="tok-nf">hellofromc</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-kt">char</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-n">name</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">  </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;Hello, %s! This is C!</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">name</span><span class="tok-p">);</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">ncitest.raku</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">use</span> <span class="tok-n">NativeCall</span>;

<span class="tok-k">constant</span> <span class="tok-n">LIBPATH</span> = <span class="tok-s">&quot;$*CWD/ncitest&quot;</span>;
<span class="tok-k">sub</span> <span class="tok-n">hello</span>(<span class="tok-nb">Str</span>) <span class="tok-k">is</span> <span class="tok-k">native</span>(<span class="tok-n">LIBPATH</span>) <span class="tok-k">is</span> <span class="tok-k">symbol</span>(<span class="tok-s">&#39;hellofromc&#39;</span>) { * }

<span class="tok-n">hello</span>(<span class="tok-s">&#39;Jane&#39;</span>);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_値の返却_2">15.4. 値の返却</h3>
<div class="paragraph">
<p>さっきと同じことをもう一度行い、ふたつの整数を受け取って足し合わせる単純な計算機を生成しましょう。<br>
CのライブラリをコンパイルしてRakuのスクリプトを実行してください。</p>
</div>
<div class="listingblock">
<div class="title">ncitest.c</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-nf">add</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-n">a</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-n">b</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">  </span><span class="tok-k">return</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-n">a</span><span class="tok-w"> </span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-n">b</span><span class="tok-p">);</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">ncitest.raku</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="perl6"><span></span><span class="tok-k">use</span> <span class="tok-n">NativeCall</span>;

<span class="tok-k">constant</span> <span class="tok-n">LIBPATH</span> = <span class="tok-s">&quot;$*CWD/ncitest&quot;</span>;
<span class="tok-k">sub</span> <span class="tok-nb">add</span>(<span class="tok-nb">int32</span>,<span class="tok-nb">int32</span> --&gt; <span class="tok-nb">int32</span>) <span class="tok-k">is</span> <span class="tok-k">native</span>(<span class="tok-n">LIBPATH</span>) { * }

<span class="tok-nb">say</span> <span class="tok-nb">add</span>(<span class="tok-mi">2</span>,<span class="tok-mi">3</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>どのようにしてCとRakuの関数の両方がふたつの整数を受け取りひとつの整数を返しているかについて注目してください。 ( Cでは <code>int</code> でRakuでは <code>int32</code> です)</p>
</div>
</div>
<div class="sect2">
<h3 id="_型_2">15.5. 型</h3>
<div class="paragraph">
<p>もしかしたら先ほどのRakuのスクリプトで <code>Int</code> ではなくて <code>int32</code> を使ったのはなぜなのか疑問に思ったかもしれません。<br>
<code>Int</code>, <code>Rat</code> などといったいくつかのRakuの型はCの関数からの値を通して受け取るときにそのままでは使うことができません。<br>
Rakuで使う型はCの型と同じでなければなりません。</p>
</div>
<div class="paragraph">
<p>幸運なことに、RakuはCでその型に相当する型と対応付けられた型を提供しています。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle">Cの型</th>
<th class="tableblock halign-center valign-middle">Rakuの型</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>char</code></p></td>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock"><code>int8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>int8_t</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>short</code></p></td>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock"><code>int16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>int16_t</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock"><code>int32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>int32_t</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>int64_t</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>int64</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>unsigned char</code></p></td>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock"><code>uint8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>uint8_t</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>unsigned short</code></p></td>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock"><code>uint16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>uint16_t</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>unsigned int</code></p></td>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock"><code>uint32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>uint32_t</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>uint64_t</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>uint64</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>long</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>long</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>long long</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>longlong</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>float</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>num32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>double</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>num64</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>size_t</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>size_t</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>bool</code></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>char*</code> (String)</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>Str</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">配列: 例えば <code>int*</code> (intの配列) や <code>double*</code> (doubleの配列)</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><code>CArray</code>: 例えば <code>CArray[int32]</code> や <code>CArray[num64]</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
ネイティブコール インタフェースについてより詳しく知りたい方は、次のURLを参照してください <a href="https://docs.raku.org/language/nativecall" class="bare">https://docs.raku.org/language/nativecall</a>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_コミュニティ">16. コミュニティ</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://web.libera.chat/#raku">#raku</a> IRCチャンネルです。活発な議論が行われています。何でも気軽に質問してください。簡単でよいからすぐに回答がほしい場合に適しています。: <a href="https://raku.org/community/irc" class="bare">https://raku.org/community/irc</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/tagged/raku">StackOverflow Raku questions</a> はIRCよりももっと詳しい回答がほしい場合に適しています。</p>
</li>
<li>
<p><a href="https://rakudoweekly.wordpress.com">rakudoweekly</a> Rakudoとその周辺の出来事について今週のダイジェストをお伝えします。</p>
</li>
<li>
<p><a href="http://pl6anet.org">pl6anet</a> Rakuのブログを集約しています。Rakuにフォーカスしたブログ記事にこうご期待ください。</p>
</li>
<li>
<p><a href="https://www.reddit.com/r/rakulang/">/r/rakulang</a> Rakuのsubredditを購読しましょう。</p>
</li>
<li>
<p><a href="https://twitter.com/raku_news">@raku_news</a> twitterでコミュニティをフォローしましょう。</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. 区間の記法: <a href="https://ja.wikipedia.org/wiki/区間_(数学)#記法" class="bare">https://ja.wikipedia.org/wiki/区間_(数学)#記法</a>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2024-05-15 01:16:02 +0300
</div>
</div>
</body>
</html>